	$(function() {
		Dropzone.autoDiscover = false;
	//	$('#offerDate').daterangepicker({locale: {format: 'DD/MM/YYYY'}});
		/*$('aside.main-sidebar a').click(function() {
			showTargetDiv($(this).data("target-id"));
			changeBreadcrumbText($(this).data("target-text"));
			dateRangepickerInit($(this).data("target-id"));
			//$('#addUserInfo').find('form').attr('id');
			resetForm($('#'+$(this).data("target-id")).find('form').attr('id'));
		});*/
	});
	
	
	var mouse_is_inside = false;
	$(document).ready(function(){
	    $('.userlogin-info').hover(function(){ 
	        mouse_is_inside=true; 
	    }, function(){ 
	        mouse_is_inside=false; 
	    });

	    $("body").mouseup(function(){ 
	        if(! mouse_is_inside) $('.userlogin-bottom').hide();
	    });
	});

	function showTargetDiv(tableId) {
		$('.showdiv').addClass('hidden');
		$('#' + tableId).removeClass('hidden');
		tabOnClickCallFunction(tableId);
	    $( "#csv-download-link" ).addClass( "hidden" );
	    $('#excel-download-link').addClass('hidden');
	    $('#editUserInfo').hide();
	    $('#fetchDetails').removeClass('hidden');
	    $('#pdd-status-excel-download-link').addClass('hidden');
	    
	}
	
	function tabOnClickCallFunction(tableId){
		var switchCase = tableId;
		switch (switchCase) { 
		case 'blDailyReport': 
			$('#blReportingList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#loadBlDailyReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');  
			break;
		case 'blTargetReport': 
			$('#blReportingList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#loadBlTargetReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');  
			break;
		case 'generateNotifications': 
			//getOemName();
			$('#submitgenerateNotifications .form-group').addClass('hidden');
			fetchDepartmentList();
			fetchCityList();
			fetchDesignationList();
			//$('#submitgenerateNotifications .form-group:first').removeClass('hidden');
			$('#submitgenerateNotifications .col-md-6:last').addClass('hidden');
			break;
		case 'scheduleNotifications': 
			//getOemName();
			$('#scheduleNotifications .form-group').addClass('hidden');
			$('#schedulerRadio').click();
			fetchDepartmentListDup();
			fetchCityListDup();
			fetchDesignationListDup();
			//$('#submitgenerateNotifications .form-group:first').removeClass('hidden');
			$('#scheduleNotifications .col-md-6:last').addClass('hidden');
			//$('#schNotificationDate').datetimepicker();
			initDateTimePicker();
			break;
		case 'editUserInfo': 
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');
			$('#UAMeditUser').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');  			
			fetchDepartmentList();
			getBranchList();
			if(undefined != $('#empCode').val() && '' != $('#empCode').val()){
				$('#fetchDetailsDBtn').click();
			}
			else{
				$('#editUserBasicDiv').show();
			}
			break;
		case 'addUserInfo': 
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMaddUser').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');  
			//}
			fetchDepartmentList();
			 getBranchList();
			break;
		case 'editOffer': 
			getOffersTitle();
			break;
		case 'showDatabaseDump': 
			fetchDatabaseList();
			break;
		case 'showPDDReportDiv':
			$('#showPDDReportDiv .form-group').addClass('hidden');
			$('#singleReportRadio').prop('checked','true');
			fetchSingleReportDates();
			break;
		case 'showPDDStatusImport':
			$('#pdd-status-excel-download-link').attr('href','');
			$('#pdd-status-excel-download-link').addClass('hidden');
			$('#pddStatusSubmit').removeClass('hidden');
			break;
		case 'showInsuranceStatusImport':
			$('#insurance-status-excel-download-link').attr('href','');
			$('#insurance-status-excel-download-link').addClass('hidden');
			$('#submitInsStatusBtn').removeClass('hidden');
			break;
		case 'setTargetReport':
			$.validator.addMethod("regex", function(value, element, regexpr) {          
			     return regexpr.test(value);
			   }, "Please enter a valid Report Name.");
			//fetchAssignTarget();
			fetchAssignTOReport();
			fetchAssignBYReport();
			break;
		case 'generateReport':
			//fetchGenerateReportRegionList();
			fetchGenerateReportCreatorList();
			break;
		case 'showeLearningDiv' :
			$('#eLearning-report-download-link').attr('href','');
			$('#eLearning-status-excel-download-link').addClass('hidden');
			
			$("#eLearningReportDateTag").AnyPicker("destroy");
			$("#eLearningReportDateTag").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "yyyy-MM-dd", 
				viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
				onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues); }});
			break;
		case 'eLearningCertificate':
			eLearningCertificateModule();
			break;
		case 'showPDDReassignment':
			$('#pdd-reassignment-download-link').attr('href','');
			$('#downloadButtonDiv').addClass('hidden');
			$('#buttonDiv').removeClass('hidden');
			$('input[name="reasgnType"]').on('click',function(){
				if($('#rc3').is(':checked')){
					$(".loscode").show('slow');
				}
				else{
					$(".loscode").hide('slow');
				}
			});
			break;
		case 'reportNotifications' :
			$('#notiText').off('keypress');
			$('#notiText').on('keypress', function (event) {
			    var regex = new RegExp("^[a-zA-Z0-9]+$");
			    var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
			    if (!regex.test(key)) {
			       event.preventDefault();
			       return false;
			    }
			});
			$('#singleReportDate').addClass('hidden');
			$('#textReport').addClass('hidden');
			$('#reportFooter').addClass('hidden');
			$('#notification-report-download-link').attr('href','');
			$('#notification-report-download-link').addClass('hidden');
			$('#singleReportRadio').click();
			break;
		case 'dailyReportsDiv':
			fetchReportCreatorData();
			break;
		case 'uamDashboard':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMdashboard').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'UAMApprovalReq':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMApprovalReq').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'UAMCredential':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMCredential').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'UAMActivity':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMActivity').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'PasswordPolicy':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMPasswordPolicy').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'UAMVGUserBase':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMVGUserBase').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'pddRICOperations':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#pddRICOperations').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'dealerPayrollFileUpload':
			$('#dealerPayrollList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#dealerFileUpload').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			break;
		case 'DSA_History':
			$('#dealerPayrollList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#dsaHistory').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			break;
		case 'fileUploadedForMe':
			$('#dealerPayrollList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#fileUploadedForMe').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			break;
		// pdd
		case 'pddFreshLead':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#PDDFreshLead').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'pddClosureReport':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#PDDClosureReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'PDDLeadReassign':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#PDDLeadReassign').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//} 
			break;
		case 'PDDReport':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#PDDReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'pddRICUpload':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#pddRICUpload').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'pddMatchProcess':
			//if($('.menu--subitens__opened').length > 0){
			$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#pddMatchProcess').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'pddApprovedRejected':
			//if($('.menu--subitens__opened').length > 0){
				$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
				if($('#status').val() == 1)
					$('#pddApprovedRecords').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
				else
					$('#pddRejectedRecords').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'pddRICMatchReport':
			//if($('.menu--subitens__opened').length > 0){
				$('#pddList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
				if($('#status').val() == 1)
					$('#pddRICMatchReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
				else
					$('#pddRICMatchReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
		//Insurance
		case 'insuranceFreshLead':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#insuranceFreshLead').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;	
		case 'insurancePolicyIssue':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#insurancePolicyIssue').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'insuranceReport':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#insuranceReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'insuranceLeadReassign':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#insuranceLeadReassign').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'unAssignInsuranceLead':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#unAssignInsuranceLead').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
			
		case 'assignInsuranceLead':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#assignInsuranceLead').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
			
			
		case 'selfAssignInsuranceLead':
			//if($('.menu--subitens__opened').length > 0){
			$('#insuranceList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#selfAssignInsuranceLead').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		//E-Learning
		case 'elearningCertificate':
			//if($('.menu--subitens__opened').length > 0){
			$('#eLearningList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#elearningCertificate').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'elearningReport':
			//if($('.menu--subitens__opened').length > 0){
			$('#eLearningList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#elearningReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;	
		case 'notificationSendNow':
			//if($('.menu--subitens__opened').length > 0){
			$('#notificationList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#notificationSendNow').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'customNotification':
			//if($('.menu--subitens__opened').length > 0){
			$('#notificationList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#customNotication').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');	
			//}
			break;
		case 'PasswordPolicyApproval':
			//if($('.menu--subitens__opened').length > 0){
			$('#uamList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#UAMPasswordPolicyApproval').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
			break;
		case 'notificationReport':
			//if($('.menu--subitens__opened').length > 0){
			$('#notificationList').addClass('navactive').addClass('menu--subitens__opened').siblings().removeClass('navactive').removeClass('menu--subitens__opened');  
			$('#notificationReport').addClass('sub_menu--link__active').siblings().removeClass('sub_menu--link__active');
			//}
		default:
		}
	}
	
	function fetchDatabaseList(){
		$('#tableNamesDiv').addClass('hidden');
		$('#dumpTypeDiv').addClass('hidden');
		$('#submitDumpDiv').addClass('hidden');
		$('#submitDumpBtn').removeClass('hidden');
		$('#dump-download-link').addClass('hidden');
		$.ajax({
			url: "/AdminModule/fetchDatabaseList",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				console.log(data);
				$.map(data,function(item){
					$('#dbName').append('<option value="'+item+'">'+item+'</option>');
				});
				fetchDBTables();
				$('#dBListDiv').removeClass('hidden');
			}
		});
	}
	function fetchDBTables(){
		$('#tableNamesDiv').addClass('hidden');
		$('#submitDumpDiv').addClass('hidden');
		$('#submitDumpBtn').removeClass('hidden');
		$('#dump-download-link').addClass('hidden');
		
		$.ajax({
			url: "/AdminModule/fetchDBTables",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			data:"database="+$('#dbName option:selected').val(),
			success:function(data){
				console.log(data);
				$('#tableName').empty();
				$.map(data,function(item){
					$('#tableName').append('<option value="'+item+'">'+item+'</option>');
				});
				$('#dumpTypeDiv').removeClass('hidden');
			}
		});
	}
	function showHideTableList(el){
		if(undefined != el && undefined != el.value){
			if(el.value == '0'){
				$('#tableNamesDiv').addClass('hidden');
				
			}
			else if(el.value == '1'){
				$('#tableNamesDiv').removeClass('hidden');
				
			}
			$('#dumpTypeValue').val(el.value);
			$('#submitDumpDiv').removeClass('hidden');
	
		}	
	}
	function fetchDepartmentList(){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		$.ajax({
			url: "/AdminModule/fetchDepartmentList",
			type: 'POST',
			async:false,
			//dataType: 'JSON',
			success:function(data){
				//console.log(data);
				if($('#departmentTag').length>0){
					$('#departmentTag').empty().append('<option selected value="">--Search or Type Department Name--</option>');
					$.map(data,function(item){
						$('#departmentTag').append('<option value="'+item.id+'">'+item.name+'</option>');
					});
					$('#departmentType').removeClass('hidden');
				}
				/*if($('#editdepartment').length>0){
					$('#editdepartment').empty().append('<option selected value="">--Search or Type Department Name--</option>');
					$.map(data,function(item){
						$('#editdepartment').append('<option value="'+item.id+'">'+item.name+'</option>');
					});
					
				}*/
			}
		});
	}
	
	function getBranchList(){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		$.ajax({
			url: "/AdminModule/getBranchMaster",
			type: 'POST',
			async:false,
			success:function(data){
				if($('#branchlist').length>0){
				$('#branchlist').empty().append('<option selected value="">--Search or Type Branch--</option>');
				$.map(data,function(item){
					$('#branchlist').append('<option value="'+item.id+'">'+item.name +'</option>');
				});
				$('#departmentType').removeClass('hidden');
				}
				
				if($('#branchNameEdit').length>0){
					$('#branchNameEdit').empty().append('<option selected value="">--Search or Type Branch--</option>');
					$.map(data,function(item){
						$('#branchNameEdit').append('<option value="'+item.id+'">'+item.name +'</option>');
					});
				}
			}
		});
	}
	
	function fetchDepartmentListDup(){
		$.ajax({
			url: "/AdminModule/fetchDepartmentList",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				console.log(data);
				$.map(data,function(item){
					$('#departmentTag1').append('<option value="'+item+'">'+item+'</option>');
				});
				$('#departmentType1').removeClass('hidden');
			}
		});
	}
	function fetchCityList(){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		$.ajax({
			url: "/AdminModule/fetchCityList",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				$('#cityTag').empty().append('<option selected value="all">Select City</option>');
				$.map(data,function(item){
					$('#cityTag').append('<option value="'+item+'">'+item+'</option>');
				});
				$('#cityType').removeClass('hidden');
			}
		});
	}
	function fetchCityListDup(){
		$.ajax({
			url: "/AdminModule/fetchCityList",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				$.map(data,function(item){
					$('#cityTag1').append('<option value="'+item+'">'+item+'</option>');
				});
				$('#cityType1').removeClass('hidden');
			}
		});
	}
	function fetchDesignationList(){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		$.ajax({
			url: "/AdminModule/fetchDesignationList",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				$('#designationTag').empty().append('<option selected value="all">Select Designation</option>');
				$.map(data,function(item){
					$('#designationTag').append('<option value="'+item+'">'+item+'</option>');
				});	
	
				$('#designationType').removeClass('hidden');
				//$('#version').removeClass('hidden');
				$('#dTypeDiv').removeClass('hidden');
			}
		});
	}
	function fetchDesignationListDup(){
		$.ajax({
			url: "/AdminModule/fetchDesignationList",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				$.map(data,function(item){
					$('#designationTag1').append('<option value="'+item+'">'+item+'</option>');
				});	
	
				$('#designationType1').removeClass('hidden');
				//$('#version').removeClass('hidden');
				$('#dTypeDivDup').removeClass('hidden');
			}
		});
	}
	function dateRangepickerInit(tableId){
		$('#'+tableId).find('.daterange').each(function( index ) {
			$(this).daterangepicker({locale: {format: 'DD/MM/YYYY'}})
		});
	}
	
	function changeBreadcrumbText(text) {
		$('ol.breadcrumb li.active').text(text);
	}
	
	function checkAllFormFieldIsEmpty(formParentDivID) {
		var isEmpty = false;
		var isEmptyId;
		var returnStatusAndId = [];
		$("#" + formParentDivID + " " + "form input").each(function() {
			removeInputWithError(this.id);
			if ($("#" + this.id).attr('type') != 'hidden') {
				if ($.trim(this.value).length === 0) {
					isEmpty = true;
					isEmptyId = this.id;
					returnStatusAndId.push(this.id);
					returnStatusAndId.push(isEmpty);
					return false;
				}
			}
		});
		return returnStatusAndId;
	}
	
	function checkAllFormSelectEmpty(formParentDivID) {
		var isEmpty = false;
		var isEmptyId;
		var returnStatusAndId = [];
		$("#" + formParentDivID + " " + "form select").each(function() {
			removeInputWithError(this.id);
			if ($("#" + this.id).val() == 'na') {
				isEmpty = true;
				isEmptyId = this.id;
				returnStatusAndId.push(this.id);
				returnStatusAndId.push(isEmpty);
				return false;
			}
		});
		return returnStatusAndId;
	}
	
	function addInputWithError(inputId) {
		//$('#' + inputId).parent().addClass('has-error');
		$('#' + inputId).closest('.form-group').find('label').parent().addClass('has-error');
	}
	
	function removeInputWithError(inputId) {
		//$('#' + inputId).parent().removeClass('has-error');
		$('#' + inputId).closest('.form-group').find('label').parent().removeClass('has-error');
	}
	
	function modalAlertForFormInput(inputId) {
		//$('#myModal p').text("Please Enter " + $('#' + inputId).parent().find('label').text().replace(/\*/g, ''));
	//	$('#myModal p').text("Please Enter " + $('#' + inputId).closest('.form-group').children('label').text().replace(/\*/g, ''));
	//	$('#myModal').appendTo("body").modal('show');
		swal('Warning', "Please Enter " + $('#' + inputId).closest('.form-group').find('label').text().replace(/\*/g, ''), 'warning');
	}
	
	function ajaxFormSubmit(formID) {
		$('#' + formID).ajaxSubmit();
		return false;
	}
	
	function checkCustomFormFieldIsEmpty(formParentDivID, validateFormIdInArray) {
		var isEmpty = false;
		var isEmptyId;
		var returnStatusAndId = [];
		$("#" + formParentDivID + " " + "form input").each(function() {
			if ($("#" + this.id).attr('type') != 'hidden') {
				removeInputWithError(this.id);
				var formdata = this;
				$.each(validateFormIdInArray, function(index, value) {
					if (value == formdata.id) {
						if ($.trim(formdata.value).length === 0) {
							isEmpty = true;
							isEmptyId = formdata.id;
							returnStatusAndId.push(formdata.id);
							returnStatusAndId.push(isEmpty);
							return false;
						}
					}
				});
			}
		});
		$("#" + formParentDivID + " " + "form select").each(function() {
			if ($("#" + this.id).attr('type') != 'hidden') {
				removeInputWithError(this.id);
				var formdata = this;
				$.each(validateFormIdInArray, function(index, value) {
					if (value == formdata.id) {
						if ($.trim(formdata.value).length === 0) {
							isEmpty = true;
							isEmptyId = formdata.id;
							returnStatusAndId.push(formdata.id);
							returnStatusAndId.push(isEmpty);
							return false;
						}
					}
				});
			}
		});
		return returnStatusAndId;
	}
	
	function findMandatoryFormInputs(formParentDivID) {
		var formId = [];
		$("#" + formParentDivID + " " + "form input").each(function() {
			removeInputWithError(this.id);
	
			//if ($("#" + this.id).attr('type') != 'hidden' && $('#' + this.id).parent().find('label').text().search(/\*/g) != -1 && $("#" + this.id).val().trim() == '') {
			if ($("#" + this.id).attr('type') != 'hidden' && $('#' + this.id).closest('.form-group').find('label').text().search(/\*/g) != -1 && $("#" + this.id).val().trim() == '') {
				formId.push(this.id);
				//if ($('#' + this.id).parent().find('label').text().search(/\*/g) != -1 && $.trim(this.id.value).length === 0) {
	
				//}
			}
		});
		$("#" + formParentDivID + " " + "form select").each(function() {
			removeInputWithError(this.id);
	
			//if ($("#" + this.id).attr('type') != 'hidden' && $('#' + this.id).parent().find('label').text().search(/\*/g) != -1 && $("#" + this.id).val().trim() == '') {
			if ($("#" + this.id).attr('type') != 'hidden' && $('#' + this.id).closest('.form-group').find('label').text().search(/\*/g) != -1 && $("#" + this.id).val().trim() == '') {
				formId.push(this.id);
				//if ($('#' + this.id).parent().find('label').text().search(/\*/g) != -1 && $.trim(this.id.value).length === 0) {
	
				//}
			}
		});
		return formId;
	}
	
	function checkCustomFormFieldTextAreaIsEmpty(formParentDivID, validateFormIdInArray) {
		var isEmpty = false;
		var isEmptyId;
		var returnStatusAndId = [];
		$("#" + formParentDivID + " " + "form textarea").each(function() {
			if ($("#" + this.id).attr('type') != 'hidden') {
				removeInputWithError(this.id);
				var formdata = this;
				$.each(validateFormIdInArray, function(index, value) {
					if (value == formdata.id) {
						if ($.trim(formdata.value).length === 0) {
							isEmpty = true;
							isEmptyId = formdata.id;
							returnStatusAndId.push(formdata.id);
							returnStatusAndId.push(isEmpty);
							return false;
						}
					}
				});
			}
		});
		return returnStatusAndId;
	}
	
	function findMandatoryFormInputsTextArea(formParentDivID) {
		var formId = [];
		$("#" + formParentDivID + " " + "form textarea").each(function() {
			removeInputWithError(this.id);
	
			//if ($("#" + this.id).attr('type') != 'hidden' && $('#' + this.id).parent().find('label').text().search(/\*/g) != -1 && $("#" + this.id).val().trim() == '') {
			if ($("#" + this.id).attr('type') != 'hidden' && $('#' + this.id).closest('.form-group').find('label').text().search(/\*/g) != -1 && $("#" + this.id).val().trim() == '') {
				formId.push(this.id);
				//if ($('#' + this.id).parent().find('label').text().search(/\*/g) != -1 && $.trim(this.id.value).length === 0) {
	
				//}
			}
		});
		return formId;
	}
	
	function checkCustomSelectFieldIsEmpty(formParentDivID, validateFormIdInArray) {
		var isEmpty = false;
		var isEmptyId;
		var returnStatusAndId = [];
		$("#" + formParentDivID + " " + "form select").each(function() {
			removeInputWithError(this.id);
			if (!$("#" + this.id).is('[disabled=disabled]') && $("#" + this.id).val() == 'na') {
				//if ($("#" + this.id).val() == 'na') {
				var formdata = this;
				$.each(validateFormIdInArray, function(index, value) {
					if (value == formdata.id) {
						if ($("#" + formdata.id).val() == 'na') {
							isEmpty = true;
							isEmptyId = formdata.id;
							returnStatusAndId.push(formdata.id);
							returnStatusAndId.push(isEmpty);
							return false;
						}
					}
				});
			}
		});
		return returnStatusAndId;
	}
	
	function findMandatorySelectInputs(formParentDivID) {
		var formId = [];
		$("#" + formParentDivID + " " + "form select").each(function() {
			if (!$("#" + this.id).is('[disabled=disabled]') && $("#" + this.id).val() == 'na') {
				//if ($("#" + this.id).val() == 'na') {
				if ($('#' + this.id).closest('.form-group').find('label').text().search(/\*/g) != -1) {  
					//if ($('#' + this.id).parent().find('label').text().search(/\*/g) != -1) {
					formId.push(this.id);
				}
			}
		})
		return formId;
	}
	/*1) To show alert as Warning type pass warning in messageType
	  2) To show alert as Sucess type pass success in messageType
	  3) To show alert as Danger type pass danger in messageType
	
	 */
	function modalAlertToShowCustomMessage(messageText, messageType) {
		/*$('#myModal :eq(1)').removeClass().addClass('modal modal-' + messageType).find('p').text(messageText);
		$('#myModal').modal('show');*/
		if(messageType == 'success')
			swal('Success', messageText, messageType);
		else if(messageType == 'warning')
			swal('Warning', messageText, messageType);
		else
			swal(messageType, messageText, messageType);
	}
	
	function resetForm(formId) {
		$('#' + formId).resetForm();
	}
	
	function resetFormPddReassign(formId) {
		$('#' + formId).resetForm();
		
		$("#rc1").prop("checked", true);
		$("#rc3").prop("checked", true);
		hideShow(null);
	}
	
	function onlyNumbers(event) {
		if (event.which != 8 && event.which !== 0 && (event.which < 48 || event.which > 57)) {
			return false;
		}
	}
	
	function validateEmailId(emailId) {
		var is = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;
		return is.test(emailId);
	}
	
	// Bulk Employee Ajax request here
	function submitBulkImport(formParentDivID) {
	
	    var status = checkCustomFormFieldIsEmpty(formParentDivID, findMandatoryFormInputs(formParentDivID));
	
	    addInputWithError(status[0]);
	
	    if (status[1]) {
	        modalAlertForFormInput(status[0]);
	        return false;
	    }
	
		if (confirm("Are You Sure You Want Add CVS Information!")) {
	//		$('#submitBulkImport').ajaxSubmit({
	//			contentType: 'application/x-www-form-urlencoded',
	//			enctype: 'multipart/form-data',
	//			processData: false,  // tell jQuery not to process the data
	//			contentType: false,  // tell jQuery not to process the data
	//			success: submitBulkImportResponse
	//		});
			
			var file = document.getElementById('file').files[0]
			var key = "vahangyan";
			// Uses different reader for all files
			var reader = new FileReader();
	
			reader.onload = function() {
				
				var salt = CryptoJS.lib.WordArray.random(128/8);
				var iv = CryptoJS.lib.WordArray.random(128/8);
	//			console.log('salt  '+ salt );
	//			console.log('iv  '+ iv );
				
				// To construct our multipart form data request,
				// We need a separator to define each part of the request
				var boundary = "blob";
				
				var data = AESFileEncryption(key, salt, iv, file, reader, boundary, "file");
	
				$.ajax({
					headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
					url: "/AdminModule/bulkImport",
					type: 'POST',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					data:data,
					success:function(response){
	
						resetForm('submitBulkImport');
	
						if(response=='SUCCESS')
						{
							$( "#csv-download-link" ).addClass( "hidden" );
							modalAlertToShowCustomMessage('CSV has been processed successfully', 'success');
						}
						else{
							var download = document.getElementById('csv-download-link');
							download.setAttribute('href', response);
							download.setAttribute('download', 'Error-Log.csv');
							$( "#csv-download-link" ).removeClass( "hidden" );
							modalAlertToShowCustomMessage('Error log generated. Please go through download link for more detail.', 'warning');
	
						}
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
	
					}
				});
			}
	
			reader.readAsDataURL(file);
		}
		else {
			modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');
		}
	}
	
	//Builk Employee Response here
	//function submitBulkImportResponse(content) {
	//
	//	resetForm('submitBulkImport');
	//
	//	if(content=='SUCCESS')
	//	{
	//		$( "#csv-download-link" ).addClass( "hidden" );
	//		modalAlertToShowCustomMessage('CSV has been processed successfully', 'success');
	//	}
	//	else{
	//		var download = document.getElementById('csv-download-link');
	//		download.setAttribute('href', content);
	//		download.setAttribute('download', 'Error-Log.csv');
	//		$( "#csv-download-link" ).removeClass( "hidden" );
	//		modalAlertToShowCustomMessage('Error log generated. Please go through download link for more detail.', 'warning');
	//
	//	}
	//
	//}
	
	
	function addUserInformation(formParentDivID) {
		var status = checkCustomFormFieldIsEmpty(formParentDivID, findMandatoryFormInputs(formParentDivID));
		addInputWithError(status[0]);
		if (status[1]) {
			modalAlertForFormInput(status[0]);
			return false;
		}
		
		/*if($('input[name="isLearningAvlbl"][value="1"]').is(':checked')){
			if($('#dept_broad_category').val() == undefined || $('#dept_broad_category').val() == ''){
				modalAlertToShowCustomMessage("Please select department broad category for Elearning", 'warning');
				return false;
			}
		}*/
		
		if ($('#emailId').val() == "" || validateEmailId($('#emailId').val())) {
			//if (confirm("Are You Sure You Want Add User Information!")) {				
				SubForm($('#submitaddUserInfo'),addUserInformationResponse)
			//}
		} else {
			modalAlertToShowCustomMessage("Enter Proper Email Id", 'warning');
			return false;
		}
		
		/*if($('#departmentTag').val() == undefined || $('#departmentTag').val() == 'all'){
			modalAlertToShowCustomMessage("Please select department name", 'warning');
			return false;
		}
		if($('#branchlist').val() == undefined || $('#branchlist').val() == 'all'){
			modalAlertToShowCustomMessage("Please select branch name", 'warning');
			return false;
	    }	*/		
	}
	
	function addUserInformationResponse(data) {
		//var data = $.parseJSON(response);
		if (data.status == "success") {
			modalAlertToShowCustomMessage(data.message, 'success');
			resetForm('submitaddUserInfo');
		} else if (data.status == "failure") {
			modalAlertToShowCustomMessage(data.message, 'error');
		}
	}
	
	function adminLoginValidate() {
		if ($('#emailId').val() !=='' && !validateEmailId($('#emailId').val())) {
			modalAlertToShowCustomMessage("Enter Proper Email ID", 'warning');
			return false;
		} else if ($('#emailId').val() === '') {
			modalAlertToShowCustomMessage('Please Enter Email ID', 'error');
			return false;
		} else if ($('#password').val() === '') {
			modalAlertToShowCustomMessage('Please Enter Password', 'error');
			return false;
		} else {
			$('#Setlogin').submit();
		}
	}
	
	
	function getDropdown(targetId){
		var target = $('#'+targetId.id).val();
		$('#'+targetId.id).parent().nextAll().find('input[type=text]').val('');
		$('#notificationEmailOrEmployeeCode,#notificationUrl').val('');
		$('#carFields select').each(function( index ) {
			$(this).attr("disabled", true).prop('selectedIndex',0);
		});
		$('#carFields').addClass('hidden');
		if (target == 'MODEL_MESSAGE') {
			$('#carFields select').each(function( index ) {
				$(this).attr("disabled", false);
			});
			$('#carFields').removeClass('hidden');
			$('#notificationUrl').removeClass('hidden').parent().removeClass('hidden').end().attr('type','text');
	
		} else if(target  == 'GENERIC_MESSAGE' ){
			$('#notificationUrl').addClass('hidden').parent().addClass('hidden').end().attr('type','hidden');
	
		} else if ( target == 'OFFER_MESSAGE') {
			$('#notificationUrl').removeClass('hidden').parent().removeClass('hidden').end().attr('type','text');
	
		}
	
	}
	
	/*function sendGenerateNotifications(formParentDivID) {
		function sendGenerateNotifications(formParentDivID, notificationType) {
	
		if (notificationType == 'NA') {
	        $('#generateNotificationType').val('');
	    } else {
	        $('#generateNotificationType').val('generateNotificationToAll');
	    }
		var status = checkCustomFormFieldIsEmpty(formParentDivID, findMandatoryFormInputs(formParentDivID));
		//var statusSelect = checkAllFormSelectEmpty(formParentDivID);
		var statusSelect = checkCustomSelectFieldIsEmpty(formParentDivID,findMandatorySelectInputs(formParentDivID));
		addInputWithError(status[0]);
		if (status[1]) {
			modalAlertForFormInput(status[0]);
			return false;
		}
		addInputWithError(statusSelect[0]);
		if (!$.isEmptyObject(statusSelect)) {
			modalAlertForFormInput(statusSelect[0]);
			return false;
		}
		if ($('#notificationEventTag').val() == 'MODEL_MESSAGE' && $('#notificationModel').val() == 'na') {
			modalAlertToShowCustomMessage('Please Select Model', 'error');
			return false;
		}
		if ($('#notificationEventTag').val() == 'VIDEO_MESSAGE'){
			$('#notificationUrl').val("https://hdfc.cardekho.com/hdfc/videoPlayBack.html?videoURL="+$('#videoName option:selected').val()+"&videoTitle="+$('#videoName option:selected').text());
		}
		$('#notificationurlheader').val($('#notificationMessageTitle').val());
		if (confirm("Are You Sure You Want Generate Notifications!")) {
			$('#submitgenerateNotifications').ajaxSubmit({
				//dataType: 'json',
				contentType: 'application/x-www-form-urlencoded',
				success: generateNotificationsResponse
			});
		}
	}*/
	
	function sendGenerateNotifications(formParentDivID) {
		var status= validateNotificationPanel();
		if(status !="")
		{
			modalAlertToShowCustomMessage(status, 'warning')
			return false;
		}
		$('#notificationurlheader').val($('#notificationMessageTitle').val());
		if (confirm("Are You Sure You Want Generate Notifications!")) {
			
			var target = $('input[name="optradio"]:checked').val();	
			var eCode= $('#notificationEmailOrEmployeeCode').val();
			var datetime='';
			if($("#schedule").hasClass("active")){
				datetime = $('#datetimepicker').val();
			}else{
				datetime='';
			}
			var deviceType = $('#dTypeDiv div ul').find('li.active').find('a').attr('href');
			deviceType = deviceType.substring(1);
			var vehiclType= $('#optradio1').val();
			var notificationEventTagValue=$('#notificationEventTag').val();
			var notificationEventTagText='';
			var notificationMessageTitle =$('#notificationMessageTitle').val();
			var notificationMessage =$('#notificationMessage').val();
			var notificationImgUrl =$('#notificationImgUrl').val();
			var department = $('#departmentTag').val();
			var city = $('#cityTag').val();
			var designation = $('#designationTag').val();
			var optType='';
			var oemType='';
			var modelType='';
			if(notificationEventTagValue == '1') {
				notificationEventTagText = "NEWS_MESSAGE";
				if(vehiclType == '1')
					optType = $('#carNewsType').val();
				else if(vehiclType == '2')
					optType = $('#bikeNewsType').val();
			}
			else if(notificationEventTagValue == '3'  || notificationEventTagValue == '8') {
				if(notificationEventTagValue == '3')
					notificationEventTagText = "OFFER_MESSAGE";
				else if (notificationEventTagValue == '8')
					notificationEventTagText = "DIRECT_BROWSER_MESSAGE";
				
				optType = $('#notificationUrl').val();	
			}
			else if(notificationEventTagValue == '4'){
				notificationEventTagText = "MODEL_MESSAGE";
				optType = $('#notificationUrl').val();	
				oemType = $('#notificationOem').val();
				modelType = $('#notificationModel').val();
			}
			else if(notificationEventTagValue == '6')
			{
				notificationEventTagText = "FEEDBACK_MESSAGE";
				if(vehiclType == '1')
					optType = $('#feedbackCar').val();
				else if(vehiclType == '2')
					optType = $('#feedbackBike').val();
			}
			else if(notificationEventTagValue == '7')
			{
				notificationEventTagText = "VIDEO_MESSAGE";
				optType = $('#videoName').val();
			}
			var sendNotificationTo = $('#filterPanel div ul').find('li.active').find('a').attr('href');
			sendNotificationTo = sendNotificationTo.substring(1);
			
			var data= {
					"audienceType":target,
					"eCode":eCode,
					"datetime":datetime,
					"deviceType":deviceType,
					"vehiclType":vehiclType,
					"notificationEventTagValue":notificationEventTagValue,
					"notificationEventTagText":notificationEventTagText,
					"notificationMessageTitle":notificationMessageTitle,
					"notificationMessage":notificationMessage,
					"notificationImgUrl":notificationImgUrl,
					"department":department,
					"city":city,
					"designation":designation,
					"optType":optType,
					"oemType":oemType,
					"modelType":modelType,
					"sendNotificationTo":sendNotificationTo
				};
			$.ajax({
				url: "/AdminModule/sendNotification",
				headers: { 
				      'Accept': 'application/json',
				     'Content-Type': 'application/json' 
				},
				type: 'POST',
				data:JSON.stringify(data),		
				async:false,
				dataType: 'JSON',
				success:function(data){
					console.log('data:: '+data);
				}
			});
		}
	}
	function validateNotificationPanel()
	{
		var target = $('input[name="optradio"]:checked').val();	
		var eCode= $('#notificationEmailOrEmployeeCode').val();
		var vehiclType= $('#optradio1').val();
		/*var appVersion=[] ;
		$('input.app:checkbox:checked').each(function () {
			appVersion.push($(this).val());
	    	});*/

		var notificationEventTag=$('#notificationEventTag').val();
		var notificationMessageTitle =$('#notificationMessageTitle').val();
		var notificationMessage =$('#notificationMessage').val();
		var notificationImgUrl =$('#notificationImgUrl').val();
		var department = $('#departmentTag').val();
		var city = $('#cityTag').val();
		var designation = $('#designationTag').val();
		
		
		
		
		if(target == null || target == undefined || target == "")
		{
			return "Please select Audience Type";
		}
		if(target!="All" && (eCode == null || eCode == undefined || eCode ==  ""))
		{
			return "Please Enter Ecode";
		}
		
		if($("#schedule").hasClass("active")){
			
			var date = $('#datetimepicker').val();
			if(date == '')
				return "Please select date and time";
				
		}
		
		/*if(appVersion.length==0)
		{
			return "Please select any app version";
				
		}*/
		
		if(notificationEventTag== null || notificationEventTag == undefined )
		{
			return "Please select notification type";
				
		}
		else
		{
			if(notificationMessageTitle == "")
				return "Please enter message title";
			if(notificationMessage == "")
				return "Please enter message";
			if(notificationImgUrl == "")	
				return "Please enter image url";
			
			if(notificationEventTag == "NEWS_MESSAGE")
			{
				if(vehiclType == '1' && $('#carNewsType').val()=='na')
					return "Please select car news";
				else if(vehiclType == '2' && $('#bikeNewsType').val()=='na')
					return "Please select bike news";
					
			}
			else if(notificationEventTag == "OFFER_MESSAGE"  || notificationEventTag == "DIRECT_BROWSER_MESSAGE")
			{
				if($('#notificationUrl').val()  == "")	
					return "Please enter html url";
			}
			else if(notificationEventTag == "MODEL_MESSAGE")
			{
				if($('#notificationUrl').val()  == "")	
					return "Please enter html url";
				
				if($('#notificationOem').val()  == "na")	
					return "Please select OEM Name";
				
				if($('#notificationModel').val()  == "na")	
					return "Please select Modal ";
			}
			else if(notificationEventTag == "FEEDBACK_MESSAGE")
			{
				if(vehiclType == '1' && $('#feedbackCar').val()=='na')
					return "Please select Feedback Type Model";
				else if(vehiclType == '2' && $('#feedbackBike').val()=='na')
					return "Please select Feedback Type Model";
			}
			else if(notificationEventTag == "VIDEO_MESSAGE")
			{
				if($('#videoName').val()  == "na")	
					return "Please select video";
			}
		}
		
		//alert("specific ---- >>> "+$("#specific").hasClass("active"));
		if($("#specific").hasClass("active")){
			if(department == "all" && city == "all" && designation == "all")	
				return "Please select One of these options Department/City/Designation otherWise choose All";
		}
		return "";
	}
	
	function scheduleNotifications(formParentDivID) {
		/*function sendGenerateNotifications(formParentDivID, notificationType) {*/
	
		/*if (notificationType == 'NA') {
	        $('#generateNotificationType').val('');
	    } else {
	        $('#generateNotificationType').val('generateNotificationToAll');
	    }*/
		var status = checkCustomFormFieldIsEmpty(formParentDivID, findMandatoryFormInputs(formParentDivID));
		//var statusSelect = checkAllFormSelectEmpty(formParentDivID);
		var statusSelect = checkCustomSelectFieldIsEmpty(formParentDivID,findMandatorySelectInputs(formParentDivID));
		addInputWithError(status[0]);
		if (status[1]) {
			modalAlertForFormInput(status[0]);
			return false;
		}
		addInputWithError(statusSelect[0]);
		if (!$.isEmptyObject(statusSelect)) {
			modalAlertForFormInput(statusSelect[0]);
			return false;
		}
		if ($('#notificationEventTag1').val() == 'MODEL_MESSAGE' && $('#notificationModel1').val() == 'na') {
			modalAlertToShowCustomMessage('Please Select Model', 'error');
			return false;
		}
		if ($('#notificationEventTag1').val() == 'VIDEO_MESSAGE'){
			$('#notificationUrl1').val("https://hdfc.cardekho.com/hdfc/videoPlayBack.html?videoURL="+$('#videoName option:selected').val()+"&videoTitle="+$('#videoName option:selected').text());
		}
		$('#notificationurlheader1').val($('#notificationMessageTitle1').val());
		if (confirm("Are You Sure You Want To Schedule Notifications!")) {
			$('#submitScheduleNotifications').ajaxSubmit({
				//dataType: 'json',
				contentType: 'application/x-www-form-urlencoded',
				success: scheduleNotificationsResponse
			});
		}
	}
	function hideShowSearch(){
		// #submitgenerateNotifications
		var target = $('input[name="optradio"]:checked').val();

		if (target == 'Single') {
			$('#eCodeDiv').show();
			$('#notificationEmailOrEmployeeCode').val('');
			
		} else if (target == 'Multiple') {
			//$('#notificationEmailOrEmployeeCode').removeClass('hidden').parent().find('button').removeClass('hidden').end().parent().removeClass('hidden');
			$('#eCodeDiv').show();
			$('#notificationEmailOrEmployeeCode').val('');
		} else if (target == 'All') {
			$('#eCodeDiv').hide();
			$('#notificationEmailOrEmployeeCode').val('');
		}
	}
	function hideShowSearchDup(target){
		// #submitgenerateNotifications
		var target = $('#scheduleNotifications input[name="optradio"]:checked').val()
		if (target == 'Single') {
			$('#notificationEmailOrEmployeeCode1').parent().find('button').attr('disabled', false);
			//$('#notificationEmailOrEmployeeCode').removeClass('hidden').parent().find('button').removeClass('hidden').end().parent().removeClass('hidden');
			$('#notificationEmailOrEmployeeCode1').attr('type','text').parent().find('button').removeClass('hidden').end().parent().removeClass('hidden');
			$('#generateNotificationType1').val('');
		} else if (target == 'Multiple') {
			//$('#notificationEmailOrEmployeeCode').removeClass('hidden').parent().find('button').removeClass('hidden').end().parent().removeClass('hidden');
			$('#notificationEmailOrEmployeeCode1').attr('type','text').parent().find('button').removeClass('hidden').end().parent().removeClass('hidden');
			$('#notificationEmailOrEmployeeCode1').parent().find('button').attr('disabled', true);
			$('#generateNotificationType1').val('');
		} else if (target == 'All') {
			//$('#notificationEmailOrEmployeeCode').attr('type','hidden').parent().find('button').addClass('hidden').end().parent().addClass('hidden');
			$('#notificationEmailOrEmployeeCode1').attr('type','hidden').parent().find('button').addClass('hidden').end().parent().addClass('hidden');
			$('#notificationEmailOrEmployeeCode1').parent().find('button').attr('disabled', true);
			$('#generateNotificationType1').val('generateNotificationToAll');
		}
	}
	function generateNotificationsResponse(data) {
	
	
		if (data == 'success') {
			modalAlertToShowCustomMessage('Generic Notification Generated Successfully', 'success');
		}
	    else if (data == 'success-all') {
	        modalAlertToShowCustomMessage('Generic Notifications Generated Successfully', 'success');
	    }
	    else{
	        modalAlertToShowCustomMessage('Failure occurred in sending notification.', 'warning');
	    }
	
	    resetForm('submitgenerateNotifications');
	}
	
	function scheduleNotificationsResponse(data) {
	
	
	    if (data == 'success' || data == 'success-all') {
			modalAlertToShowCustomMessage('Notifications Scheduled Successfully', 'success');
		}
	    else{
	        modalAlertToShowCustomMessage('Failure occurred in scheduling notification.', 'warning');
	    }
	
	    resetForm('submitScheduleNotifications');
	}
	
	function getUserDetails(targetId,tableId) {
		//var tableId = 'generateNotificationsList';
		//var tableId = targetId;
		if ($('#' + targetId).val() !== '') {
			var table = $("#"+tableId).DataTable({
				"language": {
					"zeroRecords": "No Data Available",
					"infoEmpty":"No Data Available"
				},
				"responsive": true,
				"bDestroy": true,
				"bPaginate": true,
				"bSort": true,
				"bInfo": true,
				"bAutoWidth": false,
				"bJQueryUI": true,
				ajax: {
					url: "/AdminModule/showUserDetails",
					type: "POST",
					dataType: 'json',
					dataSrc: "",
					contentType: 'application/x-www-form-urlencoded',
					data: function(d) {
						d.genericemailid = $('#' + targetId).val();
					}
				},
				columns: [{
					data: "contact_details"
				}, {
					data: "e_code"
				}, {
					data: "user_email_id"
				}, {
					data: "asm"
				}],
				error: function() {
					alert("error");
				}
			});
			$('#'+tableId).parent().parent().parent().parent().parent().parent().removeClass('hidden');
		} else {
			modalAlertToShowCustomMessage("Please Select Email Id Or Employee Code ", 'warning');
			return false;
		}
	}
	
	function getOemForBike(targetId){
		//var parameter ='device_id='+$('#storedeviceId').val()+'&token='+$('#storeToken').val();
		var response = makeAjaxCall('getOemType',"");
		$('#'+targetId).empty().append('<option selected value="na">Select Oem</option>');
		var oemResp = $.parseJSON(response).data;
		$.map(oemResp,function(item){
			$('#'+targetId).append('<option value="'+item.slug+'" >'+item.name+'</option>');
		});
	}
	
	
	function getModelForBike(targetId,finalTarget){
		//var parameter = "oemName="+$('#notificationOem').val().trim();
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var parameter = "oemName="+$('#'+targetId.id).val();
		var response = makeAjaxCall('getModelType',parameter);    
		$('#'+finalTarget.id).empty().append('<option selected value="na">Select Model</option>');
		var resp = $.parseJSON(response).data;
		$.map(resp,function(item){
			$('#'+finalTarget.id).append('<option value="/'+item.brandSlug+'/'+item.slug+'" >'+item.brandName+' - '+item.name+'</option>');
		});
	
	}
	
	function getVarientForBike(targetId,model,variant){
		//var parameter = "modelName="+$('#notificationModel').val().trim();
		var parameter = "modelName="+$('#'+model).val().split(",")[0].trim()+'&device_id='+$('#storedeviceId').val()+'&token='+$('#storeToken').val();
		var response = makeAjaxCall('getVarientType',parameter);    
		$('#'+variant).empty().append('<option selected value="na">Select Varient</option>');
		$.each($.parseJSON(response).data.variantsList, function(i, item) {
			$('#'+variant).append('<option value="'+item.variantLinkRewrite+'" >'+item.variantsname+'</option>');
	
		});
	
	}
	
	/*function getemailId(){
		if ($('#storedeviceId').val() == '' && $('#storeToken').val() == ''){
			var parameter ="e_code="+ $('#hiddenEcode').val().trim();
			$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
			var response = makeAjaxCall('getEmailIdOrToken',parameter); 
			var data=jQuery.parseJSON( response );
			//$('#storedeviceId').val(data.device_id);
			//$('#storeToken').val(data.token);
			
			$('#storedeviceId').val('8b78b6ee67f393da');
			$('#storeToken').val('tokentesting74');
		}
	}*/
	/*function getemailIdDup(){
		if ($('#storedeviceId1').val() == '' && $('#storeToken1').val() == ''){
			var parameter ="e_code="+ $('#hiddenEcode1').val().trim();
			var response = makeAjaxCall('getEmailIdOrToken',parameter); 
			$.each($.parseJSON(response), function(i, item) {
				$('#storedeviceId1').val(item.device_id);
				$('#storeToken1').val(item.token);
			});  
		}
	}*/
	var eventTagTypeResponse=undefined;
	function getEventTagForBike(targetId){
		var checkedVal = 0;
		$('#bikeNewsMessage').hide();
		$('#filterPanel').hide();
		$('#carNewsMessage').hide();
		$('#footer').hide();
		$('#carFields').hide();
		$('#optradio1').val('1');
		$('#carFeedback').hide();
		$('#bikeFeedback').hide();
		$('#videoListDiv').hide();
		$("#vehicleTypeRadio1").click(function() {
			checkedVal = 1;
			$('#optradio1').val('1');
		});
		$("#vehicleTypeRadio2").click(function() {
			checkedVal = 2;
			$('#optradio1').val('2');
		});
		if(checkedVal == undefined ||checkedVal == 1 || checkedVal == "1"){
			$('#vehicleType').val('1');
		}
		else{
			$('#vehicleType').val('2');
		}
		if (eventTagTypeResponse == undefined){
			eventTagTypeResponse = makeAjaxCall('getEventTagType',null); 
			
		}
			if(undefined != eventTagTypeResponse){
			$('#notificationEventTag').empty().append('<option selected value="na">Select Event Tag</option>');
			$.map($.parseJSON(eventTagTypeResponse),function(item){
				if(undefined != item && item != "READ_RECEIPT")
					$('#notificationEventTag').append('<option value="'+item.eventId+'">'+item.eventTagName+'</option>');
			});	
			}
		$('#eventTagType').show();
	}
	var eventTagTypeResponseDup=undefined;
	function getEventTagForBikeDup(targetId){
		var checkedVal = $('#scheduleNotifications input[name="optradio1"]:checked').val();
		var appVersion = $('#scheduleNotifications input[name="version1"]:checked').val();
		if(appVersion == "all")
			appVersion = "106";
		if(checkedVal == 1 || checkedVal == "1")
			$('#vehicleType1').val('1');
		else
			$('#vehicleType1').val('2');
		if (eventTagTypeResponse == undefined){
			var parameter ='device_id='+$('#storedeviceId1').val()+'&token='+$('#storeToken1').val();
			eventTagTypeResponseDup = makeAjaxCall('getEventTagType',parameter); 
		}
			if(undefined != eventTagTypeResponseDup){
			$('#notificationEventTag1').empty().append('<option selected value="na">Select Event Tag</option>');
			$.map($.parseJSON($.parseJSON(eventTagTypeResponseDup).data), function(item) {
				if(undefined != item.event_tag_name && item.event_tag_name != "READ_RECEIPT" && ((parseInt(appVersion)>= 107)||(parseInt(appVersion) == parseInt(item.app_version))))
				$('#notificationEventTag1').append('<option value="'+item.eventId+'" >'+item.eventTagName+'</option>');
	
			});
		
			}
		$('#scheduleNotifications #eventTagType1').removeClass('hidden');
	}
	function getAutoNewsForCar(targetId){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('getAutoNewsForCar',""); 
		$('#'+targetId).empty().append('<option selected value="na">Select Car News</option>');
		var auto_news = $.parseJSON(response).data;
		//$.each(auto_news["Auto News"], function(i, item) {
			$.map(auto_news.items,function(item){
				$('#'+targetId).append('<option value="'+item.url+'" >'+item.title+'</option>');
			});
		//});
	}
	
	function getAutoNewsForBike(targetId){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('getAutoNewsForBike',""); 
		$('#'+targetId).empty().append('<option selected value="na">Select Bike News</option>');
		var auto_news = $.parseJSON(response).data;
		//$.each(auto_news["Auto News"], function(i, item) {
			$.map(auto_news.items,function(item){
				$('#'+targetId).append('<option value="'+item.url+'" >'+item.title+'</option>');
			});
		//});
	}
	
	function displaymessage() {
		$("select").each(function() { this.selectedIndex = 0 });
	}
	
	function CarBikechecked(){
		var checkedFeedback = $('#submitgenerateNotifications input[name="optradio1"]:checked').val()
		if(checkedFeedback == '1')
			$('#feedbackCar').val('1');
		else
			$('#feedbackBike').val('2');
	}
	
	function getBikeDropdown(targetId){
		var target = $('#'+targetId.id).val();
		$('#'+targetId.id).parent().nextAll().find('input[type=text]').val('');
		$('#notificationUrl').val('');
		$('#carFields select').each(function( index ) {
			$(this).attr("disabled", true).prop('selectedIndex',0);
		});
		
		var MODEL_MESSAGE = $('#'+targetId.id).text().trim();
		var GENERIC_MESSAGE = $('#'+targetId.id).text().trim();
		var FEEDBACK_MESSAGE = $('#'+targetId.id).text().trim();
		var OFFER_MESSAGE = $('#'+targetId.id).text().trim();
		var VEDIO_MESSAGE = $('#'+targetId.id).text().trim();
		var NEWS_MESSAGE = $('#'+targetId.id).text().trim();
		$('#carFields').hide();
		$('#bikeFeedback').hide();
		$('#carFeedback').hide();
		$('#carNewsMessage').hide();
		$('#bikeNewsMessage').hide();
		$('#videoListDiv').hide();
		var checkedFeedback = $('#optradio1').val();
		if(target == '6'){//FEEDBACK_MESSAGE
			if(checkedFeedback == '1')
			{
				$('#bikeFeedback').hide();
				$('#carFeedback').show();
			}
			else
			{
				$('#carFeedback').hide();
				$('#bikeFeedback').show();
			}
			$('#notificationUrlDiv').hide();
			$('#notificationImgUrlDiv').show();
			$('#Notification select').each(function( index ) {
				$(this).attr("disabled", false);
			});
		}
		else if (target == '4') {//MODEL_MESSAGE
			if(checkedFeedback == '1')
			{
				//if($('#notificationOem option').length <= 1)
				getOemName('notificationOem');
			}
			else
			{
				//if($('#notificationOem option').length <= 1)
				getOemForBike('notificationOem');
			}
			$('#carFields select').each(function( index ) {
				$(this).attr("disabled", false);
			});
			$('#bikeFeedback').hide();
			$('#carFields .form-group').show();
			$('#carFields').show();
			$('#notificationUrlDiv').show();
			$('#notificationImgUrlDiv').show();
			$('#carFeedback').hide();
		} else if(target  == '2' ){//GENERIC_MESSAGE
			$('#bikeFeedback').hide();
			$('#notificationUrlDiv').hide();
			$('#notificationImgUrlDiv').show();
			$('#carFeedback').hide();
		} else if ( target == '3') {//OFFER_MESSAGE
			$('#bikeFeedback').hide();
			$('#notificationUrlDiv').show();
			$('#notificationImgUrlDiv').show();
			$('#carFeedback').hide();
		}else if ( target == '7') {//VIDEO_MESSAGE
			$('#bikeFeedback').hide();
			$('#notificationUrlDiv').hide();
			$('#notificationImgUrlDiv').show();
			$('#carFeedback').hide();
			if($('#videoName option').length <= 1){
				fetchVideoList('videoName');
			}
			$('#videoListDiv').show();
		}else if(target == '1'){//NEWS_MESSAGE
			//var checkedFeedback = $('#submitgenerateNotifications input[name="optradio1"]:checked').val()
			
			if(checkedFeedback == '1')
			{
				$('#bikeNewsMessage').hide();
				$('#carNewsMessage').show();
			}
			else
			{
				$('#carNewsMessage').hide();
				$('#bikeNewsMessage').show();
			}
	
			if(checkedFeedback == '1'){
				if($('#carNewsType option').length <=1)
				getAutoNewsForCar('carNewsType');
			}
			else{
				if($('#bikeNewsType option').length <=1)
				getAutoNewsForBike('bikeNewsType');
			}
			$('#notificationUrlDiv').hide();
			$('#notificationImgUrlDiv').show();
			$('#bikeFeedback').hide();
			$('#carFeedback').hide();
		}
		else if(target == '8'){//DIRECT_BROWSER_MESSAGE
			$('#bikeFeedback').hide();
			$('#notificationUrlDiv').show();
			$('#notificationUrl').show();
			$('#notificationImgUrl').show();
			$('#carFeedback').hide();
		}
		$('#messageDetailDiv').show();
		$('#messageTitleDiv').show();
		$('#filterPanel').show();
		$('#footer').show();

	}
	
	function getBikeDropdownDup(targetId){
		var target = $('#'+targetId.id).val();
		$('#'+targetId.id).parent().nextAll().find('input[type=text]').val('');
		$('#notificationEmailOrEmployeeCode1,#notificationUrl1').val('');
		$('#carFields1 select').each(function( index ) {
			$(this).attr("disabled", true).prop('selectedIndex',0);
		});
		var MODEL_MESSAGE = $('#'+targetId.id).val().trim();
		var GENERIC_MESSAGE = $('#'+targetId.id).val().trim();
		var FEEDBACK_MESSAGE = $('#'+targetId.id).val().trim();
		var OFFER_MESSAGE = $('#'+targetId.id).val().trim();
		var VEDIO_MESSAGE = $('#'+targetId.id).val().trim();
		var NEWS_MESSAGE = $('#'+targetId.id).val().trim();
		$('#carFields1').addClass('hidden');
		$('#bikeFeedback1').addClass('hidden');
		$('#carFeedback1').addClass('hidden');
		$('#carNewsMessage1').addClass('hidden');
		$('#bikeNewsMessage1').addClass('hidden');
		$('#videoListDiv1').addClass('hidden');
		var checkedFeedback = $('#scheduleNotifications input[name="optradio1"]:checked').val()
		if(target == 'FEEDBACK_MESSAGE'){
			if(checkedFeedback == '1')
			{
				$('#bikeFeedback1').addClass('hidden');
				$('#carFeedback1').removeClass('hidden');
			}
			else
			{
				$('#carFeedback1').addClass('hidden');
				$('#bikeFeedback1').removeClass('hidden');
			}
			$('#notificationUrl1').addClass('hidden').parent().addClass('hidden').end().attr('type','hidden');
			$('#Notification select').each(function( index ) {
				$(this).attr("disabled", false);
			});
		}
		else if (target == 'MODEL_MESSAGE') {
			if(checkedFeedback == '1')
			{
				//if($('#notificationOem option').length <= 1)
				getOemName('notificationOem1');
			}
			else
			{
				//if($('#notificationOem option').length <= 1)
				getOemForBike('notificationOem1');
			}
			$('#carFields1 select').each(function( index ) {
				$(this).attr("disabled", false);
			});
			$('#bikeFeedback1').addClass('hidden');
			$('#carFields1 .form-group').removeClass('hidden');
			$('#carFields1').removeClass('hidden');
			$('#notificationUrl1').removeClass('hidden').parent().removeClass('hidden').end().attr('type','text');
			$('#carFeedback1').addClass('hidden');
		} else if(target  == 'GENERIC_MESSAGE' ){
			$('#bikeFeedback1').addClass('hidden');
			$('#notificationUrl1').addClass('hidden').parent().addClass('hidden').end().attr('type','hidden');
			$('#carFeedback1').addClass('hidden');
		} else if ( target == 'OFFER_MESSAGE') {
			$('#bikeFeedback1').addClass('hidden');
			$('#notificationUrl1').removeClass('hidden').parent().removeClass('hidden').end().attr('type','text');
			$('#carFeedback1').addClass('hidden');
		}else if ( target == 'VIDEO_MESSAGE') {
			$('#bikeFeedback1').addClass('hidden');
			$('#notificationUrl1').addClass('hidden').parent().addClass('hidden').end().attr('type','hidden');
			$('#carFeedback1').addClass('hidden');
			if($('#videoName1 option').length <= 1){
				fetchVideoList('videoName1');
			}
			$('#videoListDiv').removeClass('hidden');
		}else if(target == 'NEWS_MESSAGE'){
			//var checkedFeedback = $('#submitgenerateNotifications input[name="optradio1"]:checked').val()
			if(checkedFeedback == '1')
			{
				$('#bikeNewsMessage1').addClass('hidden');
				$('#carNewsMessage1').removeClass('hidden');
			}
			else
			{
				$('#carNewsMessage1').addClass('hidden');
				$('#bikeNewsMessage1').removeClass('hidden');
			}
	
			if(checkedFeedback == '1'){
				if($('#carNewsType1 option').length <=1)
				getAutoNewsForCar('carNewsType1');
			}
			else{
				if($('#bikeNewsType1 option').length <=1)
				getAutoNewsForBike('bikeNewsType');
			}
			$('#notificationUrl1').addClass('hidden').parent().addClass('hidden').end().attr('type','hidden');
			$('#bikeFeedback1').addClass('hidden');
			$('#carFeedback1').addClass('hidden');
		}
		else if(target == 'DIRECT_BROWSER_MESSAGE'){
			$('#bikeFeedback1').addClass('hidden');
			$('#notificationUrl1').removeClass('hidden').parent().removeClass('hidden').end().attr('type','text');
			$('#carFeedback1').addClass('hidden');
		}
		$('#scheduleNotifications .col-md-6:last .form-group:first ').removeClass('hidden');
		$('#scheduleNotifications #messageDetailDiv1').removeClass('hidden');
	$('#scheduleNotifications #messageTitleDiv1').removeClass('hidden');
		$('#scheduleNotifications .col-md-6:last').removeClass('hidden');
	}
	function changeForModel(targetId,oem,model){
		var target = $('#'+targetId).val();
		if(target == '1')
		{
			getModelName(oem,model); 
		}
		else
		{
			getModelForBike(oem,model);
		}
	}
	
	function changeForVarient(targetId,model,variant){
		var target = $('#'+targetId).val();
		if(target == '1')
		{
			getVariantName(model,variant);
		}
		else
		{
			getVarientForBike(model,variant);
		}
	}
	
	function getOemName(id){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('getOemName',"");
		$('#'+id).empty().append('<option selected value="na">Select Oem</option>');
		var oemResp = $.parseJSON(response).data;
		$.map(oemResp,function(item){
			$('#'+id).append('<option value="'+item.slug+'" >'+item.name+'</option>');
		});
	}
	function fetchVideoList(el){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('getVideoList',"");
		$('#'+el).empty().append('<option selected value="na">Select Video</option>');
		var vidResp = $.parseJSON(response);
		$.map(vidResp,function(item){
			$('#'+el).append('<option value="'+item.videoUrl+'" >'+item.videoTitle+'</option>');
		});
	}
	function getModelName(oem,model){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var parameter = "oemName="+$('#'+oem.id).val();
		var response = makeAjaxCall('getModelName',parameter);
		$('#'+model.id).empty().append('<option selected value="na">Select Model</option>');
		var resp = $.parseJSON(response).data;
		$.map(resp,function(item){
			$('#'+model.id).append('<option value="'+item.modelUrl+'" >'+item.brandName+' - '+item.name+'</option>');
		});
	}
	
	function getVariantName(model,variant){
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		$.ajax({
			url: "/AdminModule/getVariantName",
			type: 'POST',
			dataType: 'JSON',
			async: false,
			data:"modelName="+$('#'+model.id).val(),
			contentType: 'application/x-www-form-urlencoded',
			complete: function(data) {
				$('#'+variant.id).empty().append('<option selected value="na">Select Variant</option>');
				$.each(data.responseJSON, function(i, item) {
					$('#'+variant.id).append('<option value="'+item.variantName+'" >'+item.variantName+'</option>');
				});
			}
		});
	}
	
	
	function fillCarDropDown(url,parentId,targetId,parameter,itemType){
		$.ajax({
			url: "/AdminModule/"+url,
			type: 'POST',
			dataType: 'JSON',
			async: false,
			data:parameter+"="+$('#'+parentId).val(),
			contentType: 'application/x-www-form-urlencoded',
			complete: function(data) {
				$('#'+targetId).empty();
				$.each(data.responseJSON, function(i, item) {
					$('#'+targetId).append('<option value="'+item[itemType]+'" >'+item[itemType]+'</option>');
				});
	
			}
		});
	
	}
	
	function makeAjaxCall(url,parameters){
		var responseData ;
		$('#wait').show();
		$.ajax({
			url: "/AdminModule/"+url,
			type: 'POST',
			dataType: 'JSON',
			async: false,
			data:parameters,
			contentType: 'application/x-www-form-urlencoded',
			complete: function(data) {
				if (!$.isEmptyObject(data)) {
					responseData =  data.responseText;
				}	
				$('#wait').hide();
			}
		});
		return responseData;
	
	}
	
	function addOffers(formParentDivID) {
		$('#offers').val(JSON.stringify(tableToJSON));
		if (confirm("Are You Sure You Want Add Offer!")) {
			$('#offerEngine').ajaxSubmit({
				dataType: 'json',
				contentType: 'application/x-www-form-urlencoded',
				success: addOffersResponse
			});
		}
	
	}
	
	function addOffersResponse(data){
		if (data.status == "success") {
			modalAlertToShowCustomMessage('Offer Added Successfully', 'success');
			resetForm('offerEngine');
			$( '#frameDemo' ).attr( 'src', function ( i, val ) { return val; });
			flag = 0;tableToJSON.length = 0;
		}
	
	}
	
	var glodalResponseData;
	function getOffersTitle() {
		var responseData = makeAjaxCall('getOfferTitle', '');
		glodalResponseData = $.parseJSON(responseData);
		$('#selectOffers').empty().append('<option selected value="na">Select Offer Title</option>');
		$.each($.parseJSON(responseData), function(i, item) {
			$('#selectOffers').append('<option value="' + item.id + '" >' + item.first_offer_title + '</option>');
		});
	}
	
	function getOffers(tableId) {
		if ($('#selectOffers').val() != 'na') {
			$.each(glodalResponseData, function(i, item) {
				if (item.first_offer_title == $.trim($('#selectOffers option:selected').text())) {
					$('#offerDateRange').daterangepicker({locale: {format: 'DD/MM/YYYY'},startDate: new Date(item.start_date),endDate: new Date(item.end_date)});
				}
			});
			var table = $("#" + tableId).DataTable({
				oLanguage: {
					sEmptyTable: "No data available",
				},
				"bDestroy": true,
				"bPaginate": true,
				"bLengthChange": false,
				"bFilter": true,
				"bSort": true,
				"bInfo": true,
				"bAutoWidth": false,
				"bJQueryUI": true,
				ajax: {
					url: "/AdminModule/getOfferList",
					type: "POST",
					dataType: 'json',
					dataSrc: "",
					contentType: 'application/x-www-form-urlencoded',
					data: function(d) {
						d.id = $('#selectOffers').val();
					}
				},
				columns: [{
					data: "offer_key"
				}, {
					data: "offer_value"
				}, {
					defaultContent: "<div class='text-center'><div class='btn-group'><button class='btn btn-info information' data-trigger='hover' id='edit' data-placement='left' href='#offerModal' data-toggle='modal' title='Edit Offer'><i class='fa fa-edit'></i></button></div></div>"
				}],
				error: function() {
					alert("error");
				}
			});
			$('#' + tableId).unbind("click");
			$('#' + tableId).on("click", "button", function() {
				var response = table.row($(this).parents("tr")).data();
				$('#offerKeyModal').val(response.offer_key);
				$('#offerValueModal').val(response.offer_value);
				$('#currentOfferId').val(response.id);
			});
			$('#' + tableId).parent().parent().parent().parent().parent().parent().removeClass('hidden');
		} else {
			modalAlertToShowCustomMessage("Please Select Offer Title ", 'warning');
			return false;
		}
	}
	
	function updateOfferDate(targetId){
		if ($('#'+targetId).val() !== '') {
			var parameter = 'id='+$('#selectOffers').val()+'&date='+$('#'+targetId).val();
			var response = makeAjaxCall('updateOfferDate',parameter);
			if ($.parseJSON(response).status == 'success') {
				modalAlertToShowCustomMessage('Offer Date Updated', 'success');
			};
	
		}
	}
	
	function updateOffer(){
		if (confirm("Are You Sure You Want Update Offer!")) {
			$('#offerModal').modal('hide');
			$('#modalUpdateOffer').ajaxSubmit({
				dataType: 'json',
				contentType: 'application/x-www-form-urlencoded',
				success: updateOfferResponse
			});
		}
	
	}
	
	function updateOfferResponse(data){
		if (data.status == "success") {
			getOffers('offerList');
			modalAlertToShowCustomMessage('Offer Updated Successfully', 'success');
	
		}
	
	}
	
	function collapse() {
		$('.collapse').off();
		$('.collapse').on('shown.bs.collapse', function() {
			uploadImages();
		}).on('hidden.bs.collapse', function() {
		});
	}
	
	function uploadImages(){
		var paratosend = "";
		var dropzoneinitId = "";
		var uploadImageType = "";
		if ($('#collapse1').is(':visible')) {
			uploadImageType = "comparesponsoredkit";
			paratosend = $('#sponserModelName option:selected').val();
			dropzoneinitId = "my-dropzone";
		}
	
		$('div #addOfferUpload').dropzone({
			addRemoveLinks: true,
			maxFiles: 1,
			url: "/AdminModule/save",
			init: function() {
				var myAwesomeDropzone = this;
				this.on("success", function(file, response) {
					uploadImagesResponse(response);
				});
				this.on("error", function(files, response) {
					alert("Error");
				});
			}
		});
	}
	
	function uploadImagesResponse(data){
	
		if (data.status == "success") {
			modalAlertToShowCustomMessage('Image Uploaded Successfully', 'success');
	
		}
	
	}
	
	var flag = 0;
	var tableToJSON  = [];
	function offerPreview(formParentDivID){
		$('#offerSave').prop('disabled', true);
		var status = findMandatoryFormInputs(formParentDivID);
		var statusSelect = findMandatorySelectInputs(formParentDivID);
		addInputWithError(status[0]);
		if (!$.isEmptyObject(status[0])) {
			modalAlertForFormInput(status[0]);
			return false;
		}
		addInputWithError(statusSelect[0]);
		if (!$.isEmptyObject(statusSelect)) {
			modalAlertForFormInput(statusSelect[0]);
			return false;
		}
		if ($('#offerDescription').val() == '') {
			addInputWithError('offerDescription');
			modalAlertToShowCustomMessage('Please Enter Offers Description ', 'error');
			return false;
		};
		var tabledata ;
		item = {}
		$('#frameDemo').contents().find("div #firstOfferTitle").text($('#offerTitle').val());
		$('#frameDemo').contents().find("#secondOfferTitle").empty().append('<a href="#" class="ui-collapsible-heading-toggle ui-btn ui-icon-carat-u ui-btn-icon-right ui-btn-inherit">'+$('#secondOfferTitle').val()+'<span class="ui-collapsible-heading-status"> click to collapse contents</span></a>');
		$('#frameDemo').contents().find("#descriptionOfferTitle").text($('#offerDescription').val());
	
		if(flag === 0){
			tabledata = '<tr><td width="21%" align="left" valign="middle">'+$('#column0').val()+'</td><td width="79%" align="left" valign="middle">'+$('#column1').val()+'</td></tr>';
			$('#frameDemo').contents().find("#offerTable").empty().append(tabledata);
			flag = 1;
			item ["offerKey"] = $('#column0').val();
			item ["offerValue"] = $('#column1').val();
	
			tableToJSON.push(item);
		}else{
			$('#frameDemo').contents().find("#offerTable").append('<tr><td width="21%" align="left" valign="middle">'+$('#column0').val()+'</td><td width="79%" align="left" valign="middle">'+$('#column1').val()+'</td></tr>');
			item ["offerKey"] = $('#column0').val();
			item ["offerValue"] = $('#column1').val();
			tableToJSON.push(item);
		}
		item = {}
		item [$('#column0').val()] = $('#column0').val();
		$('#column0').val('');
		$('#column1').val('');
		$('#offerSave').prop('disabled', false);
	
	}
	
	function changeVehicleAndNotificationType(divId,el){
		if(undefined != el && undefined != el.value){
			 var arr = [];
			$('#'+divId+' input.app:checkbox:checked').each(function () {
				arr.push($(this).val());
		    });
			if(arr.length==0){
				$('#vehical').hide();
				$('#eventTagType').hide();
				$('#notification').hide();
				$('#filterPanel').hide(); 	
				$('#carFields').hide();
				$('#footer').hide();
				$('#optradio1').val('');
				
			}	
			else if($.inArray('106', arr) == -1)	{		
				$('#vehical').show();
				$('#vehicleTypeRadio2').show();
				$('#notification').show();
				getemailId();getEventTagForBike('1');
				
			}
			else{
				$('#vehical').show();
				$('#vehicleTypeRadio2').hide();
				$('#notification').show();
				getemailId();getEventTagForBike('1');
			}
		
			
			$('#appType').val(el.value);
			$('#vehicleType').val("1");
			//$('#submitgenerateNotifications #vehical').removeClass('hidden');
	
		}
	}
	
	/*function changeVehicleAndNotificationType(divId,el){
		if(undefined != el && undefined != el.value){
			
			$('#'+divId+' input.docType:checkbox:checked').each(function () {
				arr.push($(this).val());
		    });
			
			alert(arr);
			
			if(el.value == '106' || el.value=='all'){
				$('#vehical').show();
				$('#vehicleTypeRadio2').attr('disabled','disabled');
				
			}
			else if(el.value == '107' ||el.value == '200'){
				$('#vehical').show();
				$('#vehicleTypeRadio2').attr('disabled','false');
				
			}
			//$('#appType').val(el.value);
			$('#vehicleTypeRadio1').click();
			//$('#vehicleType').val("1");
			//$('#submitgenerateNotifications #vehical').removeClass('hidden');
	
		}
	}*/
	function changeVehicleAndNotificationTypeDup(el){
		if(undefined != el && undefined != el.value){
			if(el.value == '106' || el.value=='all'){
				$('#vehical1 #vehicleTypeRadio4').attr('disabled','disabled');
				
			}
			else if(el.value == '107'){
				$('#vehical1 #vehicleTypeRadio4').removeAttr('disabled');
				
			}
			$('#appType1').val(el.value);
			$('#vehical1 #vehicleTypeRadio3').click();
			$('#vehicleType1').val("1");
			$('#scheduleNotifications #vehical1').removeClass('hidden');
	
		}
	}
	
	function submitDumpDBRequest(formParentDivID) {
	
	    var status = checkCustomFormFieldIsEmpty(formParentDivID, findMandatoryFormInputs(formParentDivID));
	
	    addInputWithError(status[0]);
	
	    if (status[1]) {
	        modalAlertForFormInput(status[0]);
	        return false;
	    }
	
	            $('#submitDataBaseDump').ajaxSubmit({
	               // contentType: 'application/x-www-form-urlencoded',
	                //processData: false,  // tell jQuery not to process the data
	               // contentType: false,  // tell jQuery not to process the data
	                success: submitDumpDBResponse
	            });
	   
	}
	function submitDumpDBResponse(content) {
	
	   // resetForm('submitDataBaseDump');
	
	    if(content==null || content=="")
	    {
	        $( "#dump-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage("Something went wrong.Please try again.", 'warning');
	    }
	    else{
	        var download = document.getElementById('dump-download-link');
	        download.setAttribute('href', content);
	        download.setAttribute('download', 'dump.sql');
	        $('#submitDumpBtn').addClass('hidden');
	        $( "#dump-download-link" ).removeClass( "hidden" );
	        modalAlertToShowCustomMessage('Dump Generated Successfully.Please click on Download button', 'success');
	    }
	
	}
	function submitCredentialRequest(formParentDivID) {
	$('#loaderImg').show();
	$('#credentialMailerForm').ajaxSubmit({
	    // contentType: 'application/x-www-form-urlencoded',
	     //processData: false,  // tell jQuery not to process the data
	    // contentType: false,  // tell jQuery not to process the data
	     success: submitCredentialMailerResponse
	 });
	
	}
	
	
	function submitCredentialMailerResponse(content) {
	
		   // resetForm('submitDataBaseDump');
		$('#loaderImg').hide();
		    if(content==null || content=="")
		    {
		        modalAlertToShowCustomMessage("Something went wrong.Please try again.", 'warning');
		    }
		    else{
		        modalAlertToShowCustomMessage('Mail sent successfully', 'success');
		    }
	
	}
	
	function submitInsuranceImport(formParentDivID) {
	
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You are uploading insurance fresh leads datasheet.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
		}).then(function(isConfirm) {
		        
		    	if (isConfirm) {
		    		
//				$('#wait').show();
		    		var sock = new SockJS('/AdminModule');
		    		var stompClient = Stomp.over(sock);
		    		//Callback function to be called when stomp client is connected to server
		    		var connectCallback = function() {
		    		  stompClient.subscribe('/topic/insurance-lead-import-progress', renderProgress);
		    		}; 
		    		 
		    		
		    		
		    		// Callback function to be called when stomp client could not connect to server
		    		var errorCallback = function(error) {
		    		  alert(error.headers.message);
		    		};
		    		 
		    		
		    		// Connect to server via websocket
		    		stompClient.connect("",connectCallback, errorCallback);
			
				var file = document.getElementById('file-1').files[0]
			var key = "vahangyan";
			// Uses different reader for all files
			var reader = new FileReader();
	
			reader.onload = function() {
				
				var salt = CryptoJS.lib.WordArray.random(128/8);
				var iv = CryptoJS.lib.WordArray.random(128/8);
	//			console.log('salt  '+ salt );
	//			console.log('iv  '+ iv );
				
				// To construct our multipart form data request,
				// We need a separator to define each part of the request
				var boundary = "blob";
				
				var data = AESFileEncryption(key, salt, iv, file, reader, boundary, "file1");
				$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
				$.ajax({
					headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
					url: "/AdminModule/insuranceImport",
					type: 'POST',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					data:data,
					success:function(response){
						$('#wait').hide();
						stompClient.disconnect();
						resetForm('submitInsuranceImport');
						if(response == null || response == ""){
							$( "#insurance-excel-download-link").hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
						
						}
						else if(response.indexOf('SUCCESS') != -1)
						{
							$( "#insurance-excel-download-link").hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
						}
						else if(response.indexOf('FAILURE') != -1)
						{
							$( "#insurance-excel-download-link").hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Oops some error occurred. Please do not enter blank excel file', 'warning');
						}
						else{
							var download = document.getElementById('insurance-error-excel-download-link');
							var arrayData= response.split("~");
							download.setAttribute('href', arrayData[3]);
							console.log(arrayData[3]);
							download.setAttribute('download', 'LogFile.xlsx');
							$('#submitInsuranceImportBtn').hide();
							$( "#insurance-excel-download-link" ).show();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
									'. Please go through download link for more detail.', 'warning');
	
						}
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
	
					}
				});
			}
	
			reader.readAsDataURL(file);
		}
		}/*,
	    function() {
	    	modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');
	      }*/
	    );	    	
	}
	
	function submitCustomNotificationImport(formParentDivID) {
	
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You Want Send Custom Notifications.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
		}).then(function(isConfirm) {

			if (isConfirm) {

				$('#wait').show();

				var formData = new FormData();
				var file = document.getElementById('file-1').files[0]
				formData.append('file',file );
		    	$.ajax({
						headers : {
							'X-CSRF-TOKEN' : $('#csrfToken').val(),'Content-Type': undefined
						},
						url : "/AdminModule/sendCustomNotifications",
						type : 'POST',
						async : false,
						processData : false, // tell jQuery not to process the data
						contentType : false, // tell jQuery not to process the data
						data : formData,
						success : function(response) {
							$('#wait').hide();
							resetForm('submitCustomNotification');
							console.log(response);
							if(response == null || response == ""){
								$( "#customNot-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
							}
							else if(response.indexOf('SUCCESS') != -1)
							{
								$( "#customNot-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Notification Excel file has been processed successfully', 'success');
							}
							else if(response.indexOf('FAILURE') != -1)
							{
								$( "#customNot-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Oops Some error occurred. Please do not upload blank excel file', 'warning');
							}
							else{
								var download = document.getElementById('custNot-error-excel-download-link');
								var arrayData= response.split("~");
								download.setAttribute('href', arrayData[3]);	
								console.log(arrayData[3]);
								download.setAttribute('download', 'LogFile.xlsx');
								$('#submitCustNotBtn').hide();
								$( "#customNot-excel-download-link" ).show();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
										'. Please go through download link for more detail.', 'warning');
		
							}
						}
					});
				
			}

	    });
	}
	
	function submitCustomNotificationImportResponse(content) {
		$('#wait').hide();
	    resetForm('submitCustomNotification');
	    
	    
	    if(content == null || content == ""){
	    	 modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
	    }
	    else if(content.indexOf('SUCCESS') != -1)
	    {
	        $( "#notification-excel-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
	    }
	    else{
	        var download = document.getElementById('notification-excel-download-link');
	        var arrayData= content.split("~");
	        download.setAttribute('href', arrayData[3]);
	        download.setAttribute('download', 'LogFile.xlsx');
	        $( "#notification-excel-download-link" ).removeClass( "hidden" );
	        modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Notifications Sent successfully: '+arrayData[2]+
	        		'. Please go through download link for more detail.', 'warning');
	
	    }
	
	}
	function submitInsuranceImportResponse(content) {
		$('#showInsuranceImport #loaderImg').hide();
	    resetForm('submitInsuranceImport');
	    if(content == null || content == ""){
	    	 modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
	    }
	    else if(content.indexOf('SUCCESS') != -1)
	    {
	        $( "#excel-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
	    }
	    else{
	        var download = document.getElementById('excel-download-link');
	        var arrayData= content.split("~");
	        download.setAttribute('href', arrayData[3]);
	        download.setAttribute('download', 'LogFile.xlsx');
	        $( "#excel-download-link" ).removeClass( "hidden" );
	        modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
	        		'. Please go through download link for more detail.', 'warning');
	
	    }
	
	}
	
	function submitInsuranceStatusImport(formParentDivID) {
	
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You are uploading insurance policy issued datasheet.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
		}).then(function(isConfirm) {
		 if (isConfirm) {
				$('#wait').show();
	
			var file = document.getElementById('file-1').files[0]
			var key = "vahangyan";
			// Uses different reader for all files
			var reader = new FileReader();
	
			reader.onload = function() {
				
				var salt = CryptoJS.lib.WordArray.random(128/8);
				var iv = CryptoJS.lib.WordArray.random(128/8);
	//			console.log('salt  '+ salt );
	//			console.log('iv  '+ iv );
				
				// To construct our multipart form data request,
				// We need a separator to define each part of the request
				var boundary = "blob";
				
				var data = AESFileEncryption(key, salt, iv, file, reader, boundary, "insuranceStatusFile");
				$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
				$.ajax({
					headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
					url: "/AdminModule/insurancePolicyStatusUpload",
					type: 'POST',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					data:data,
					success:function(response){
						$('#wait').hide();
						resetForm('submitInsuranceStatusImport');
						if(response == null || response == ""){
							$( "#insurance-status-excel-download-link" ).hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
						}
						else if(response.indexOf('SUCCESS') != -1)
						{
							$( "#insurance-status-excel-download-link" ).hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
						}
						else if(response.indexOf('FAILURE') != -1)
						{
							$( "#insurance-status-excel-download-link" ).hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Some error occurred.Please do not enter blank excel file', 'warning');
						}
						else{
							var download = document.getElementById('insurance-error-excel-download-link');
							var arrayData= response.split("~");
							download.setAttribute('href', arrayData[3]);
							console.log(arrayData[3]);
							download.setAttribute('download', 'LogFile.xlsx');
							$('#submitInsStatusBtn').hide();
							$( "#insurance-status-excel-download-link" ).show();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
									'. Please go through download link for more detail.', 'warning');
	
						}
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
	
					}
				});
			}
	
			reader.readAsDataURL(file);
		 }
	    }/*,
	    function() {
	    	modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');
	      }*/
	    );
	}
	
	function submitInsuranceStatusImportResponse(content) {
		$('#showInsuranceStatusImport #loaderImg').hide();
	    resetForm('submitInsuranceStatusImport');
	    if(content == null || content == ""){
	    	 modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
	    }
	    else if(content.indexOf('SUCCESS') != -1)
	    {
	        $( "#insurance-status-excel-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
	    }
	    else{
	        var download = document.getElementById('insurance-status-excel-download-link');
	        var arrayData= content.split("~");
	        download.setAttribute('href', arrayData[3]);
	        download.setAttribute('download', 'LogFile.xlsx');
	        $('#submitInsStatusBtn').addClass('hidden');
	        $( "#insurance-status-excel-download-link" ).removeClass( "hidden" );
	        modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
	        		'. Please go through download link for more detail.', 'warning');
	
	    }
	
	}
	function AESFileEncryption(key, salt, iv, file, fileReaderObj, boundary, formDataName){
	
		var key128Bits100Iterations = CryptoJS.PBKDF2(key, salt, { keySize: 128/32, iterations: 100 });
		console.log( 'key128Bits100Iterations '+ key128Bits100Iterations);
		var encryptedData = CryptoJS.AES.encrypt(fileReaderObj.result.match(/,(.*)$/)[1], key128Bits100Iterations, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });
	
		// Store our body request in a string.
		var data = "";
	
		// Start a new part in our body's request
		data += "--" + boundary + "\r\n";
	
		// Describe it as form data
		data += 'content-disposition: form-data; '
			// Define the name of the form data
			+ 'name="' + formDataName + '"; '
			// Provide the real name of the file
			+ 'filename="'     + file.name + '"\r\n';
		// And the MIME type of the file
		data += 'Content-Type: ' + file.type + '\r\n';
	
		// There's a blank line between the metadata and the data
		data += '\r\n';
	
		// Append the binary data to our body's request
		data += encryptedData + '\r\n';
	
		// Once we are done, "close" the body's request
		data += "--" + boundary + "--";
	
		return data;
	}
	
	function editUserInformation(formParentDivID) {
		if($('#editreportingManagerEcode').val() == $('#editemployeeCode').val()){
			modalAlertToShowCustomMessage("Employee Code cannot be same as Reporting manager Ecode", 'warning');
			return false;
		}	
		
		var status = checkCustomFormFieldIsEmpty(formParentDivID, findMandatoryFormInputs(formParentDivID));
		addInputWithError(status[0]);
		if (status[1]) {
			modalAlertForFormInput(status[0]);
			return false;
		}
		
		/*if($('#departmentTag').val() == undefined || $('#departmentTag').val() == 'all'){
				modalAlertToShowCustomMessage("Please select department name", 'warning');
				return false;
		}
		if($('#branchlist').val() == undefined || $('#branchlist').val() == 'all'){
			modalAlertToShowCustomMessage("Please select branch name", 'warning');
			return false;
	    }*/
		
		/*if($('input[name="isLearningAvlbl"][value="1"]').is(':checked')){
			if($('#editdept_broad_category').val() == undefined || $('#editdept_broad_category').val() == ''){
				modalAlertToShowCustomMessage("Please select department broad category for Elearning", 'warning');
				return false;
			}
		}*/
		if ($('#editemailId').val() == '' || validateEmailId($('#editemailId').val())) {
			if (confirm("Are You Sure You Want Update User Information!")) {				
				SubForm($('#submiteditUserInfo'),editUserInformationResponse)
			}
		} else {
			modalAlertToShowCustomMessage("Enter Proper Email Id", 'warning');
		}
	}
	function approveRejectUserInformation(formParentDivID,approvalFlag,callbackMethod) {
		if($('#editreportingManagerEcode').val() == $('#editemployeeCode').val()){
			modalAlertToShowCustomMessage("Employee Code cannot be same as Reporting manager Ecode", 'warning');
			return false;
		}
		if ($('#editemailId').val() == '' || validateEmailId($('#editemailId').val())) {
			
			var text='';
			if(approvalFlag == 1){
				text='Approve ';
				if($('#approvalFlag').val() == 1){
					text+='Addition Of ';
				}
				else if($('#approvalFlag').val() == 4){
					text+='Updation Of ';
				}
				if (confirm("Are You Sure You Want to "+text+"User!")) {
					if($('#approvalFlag').val() == 1){
						if(approvalFlag == 1){
							$('#approvalFlag').val(2);
						}
						else{
							$('#approvalFlag').val(3);
						}
					}
					else if($('#approvalFlag').val() == 4){
						if(approvalFlag == 1){
							$('#approvalFlag').val(5);
						}
						else{
							$('#approvalFlag').val(6);
						}
					}
					if(callbackMethod != undefined && callbackMethod =='viewUAMApprovalRequests')
					SubForm($("#"+formParentDivID),viewUAMApprovalRequests);
					else
						SubForm($("#"+formParentDivID),editUserInformationResponse);
				}
			}
			else{
				text='Reject ';
				if($('#approvalFlag').val() == 1){
					text+='Addition Of ';
				}
				else if($('#approvalFlag').val() == 4){
					text+='Updation Of ';
				}
				text = "Are You Sure You Want to "+text+"User!";
				$('#hiddenFormId').val($("#"+formParentDivID).attr('id'));
				$('#reject').modal('show');
				$('#modelText').text(text);
			}
			
			
			/*var text='';
			if(approvalFlag == 1){
				text='Approve ';
			}
			else{
				text='Reject ';
			}
			if($('#approvalFlag').val() == 1){
				text+='Addition Of ';
			}
			else if($('#approvalFlag').val() == 4){
				text+='Updation Of ';
			}
			if (confirm("Are You Sure You Want to "+text+"User!")) {
				if($('#approvalFlag').val() == 1){

					if(approvalFlag == 1){
						$('#approvalFlag').val(2);
					}
					else{
						$('#approvalFlag').val(3);
					}
				}
				else if($('#approvalFlag').val() == 4){

					if(approvalFlag == 1){
						$('#approvalFlag').val(5);
					}
					else{
						$('#approvalFlag').val(6);
					}
				}

				$('#submiteditUserInfo').ajaxSubmit({
					clearForm:true,
					dataType: 'json',
					contentType: 'application/x-www-form-urlencoded',
					success: editUserInformationResponse
				});
				return false;
				if(callbackMethod != undefined && callbackMethod =='viewUAMApprovalRequests')
				SubForm($("#"+formParentDivID),viewUAMApprovalRequests);
				else
					SubForm($("#"+formParentDivID),editUserInformationResponse);
			}*/
		} else {
			modalAlertToShowCustomMessage("Enter Proper Email Id", 'warning');
		}
	}
	
	function submitRejectUserInfo2(approvalFlag){
		
		if($.trim($('#rejectRemark').val())==''){
			alert('Please enter reason of rejection!');
			$('#rejectRemark').val('');
			return;
		}
		
		if($('#hiddenFormId').val() != '' && $('#rejectRemark').val() != ''){
		var form = $('#'+ $('#hiddenFormId').val());
		$(form.find('input[name="rejectRemark"]')).val($('#rejectRemark').val());
		if(form.find('input[name="approvalFlag"]').val() == 1){
				form.find('input[name="approvalFlag"]').val(3);
		}
		else if(form.find('input[name="approvalFlag"]').val() == 4){
				form.find('input[name="approvalFlag"]').val(6);
		}
		$('#hiddenFormId').val('');
		SubForm(form,editUserInformationResponse);
		}
	}
	
		function approveRejectUserInfoDirect(obj,approvalFlag) {
				var text='';
				if(approvalFlag == 1){
					text='Approve ';
					if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 1){
						text+='Addition Of ';
					}
					else if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 4){
						text+='Updation Of ';
					}
					if (confirm("Are You Sure You Want to "+text+"User!")) {
						if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 1){

							if(approvalFlag == 1){
								$(obj).parents('form').find('input[name="approvalFlag"]').val(2);
							}
							else{
								$(obj).parents('form').find('input[name="approvalFlag"]').val(3);
							}
						}
						else if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 4){

							if(approvalFlag == 1){
								$(obj).parents('form').find('input[name="approvalFlag"]').val(5);
							}
							else{
								$(obj).parents('form').find('input[name="approvalFlag"]').val(6);
							}
						}
						SubForm($(obj).parents('form'),editUserInformationResponse);
					}
					
					
				}
				else{
					text='Reject ';
					if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 1){
						text+='Addition Of ';
					}
					else if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 4){
						text+='Updation Of ';
					}
					
					text = "Are You Sure You Want to "+text+"User!";
					$('#hiddenFormId').val($(obj).parents('form').attr('id'));
					$('#reject').modal('show');
					$('#modelText').text(text);
					
				}
				
		}
		
		function submitRejectUserInfo(approvalFlag){
			
			if($.trim($('#rejectRemark').val())==''){
				alert('Please enter reason of rejection!');
				$('#rejectRemark').val('');
				return;
			}
			
			if($('#hiddenFormId').val() != '' && $('#rejectRemark').val() != ''){
			var form = $('#'+ $('#hiddenFormId').val());
			$(form.find('input[name="rejectRemark"]')).val($('#rejectRemark').val());
			if(form.find('input[name="approvalFlag"]').val() == 1){
					form.find('input[name="approvalFlag"]').val(3);
			}
			else if(form.find('input[name="approvalFlag"]').val() == 4){
					form.find('input[name="approvalFlag"]').val(6);
			}
			$('#hiddenFormId').val('');
			SubForm(form,editUserInformationResponse);
			}
		}
	
	/*function approveRejectUserInfoDirect(obj,approvalFlag) {
		var text='';
		if(approvalFlag == 1){
			text='Approve ';
		}
		else{
			text='Reject ';
		}
		if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 1){
			text+='Addition Of ';
		}
		else if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 4){
			text+='Updation Of ';
		}
		if (confirm("Are You Sure You Want to "+text+"User!")) {
			if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 1){

				if(approvalFlag == 1){
					$(obj).parents('form').find('input[name="approvalFlag"]').val(2);
				}
				else{
					$(obj).parents('form').find('input[name="approvalFlag"]').val(3);
				}
			}
			else if($(obj).parents('form').find('input[name="approvalFlag"]').val() == 4){

				if(approvalFlag == 1){
					$(obj).parents('form').find('input[name="approvalFlag"]').val(5);
				}
				else{
					$(obj).parents('form').find('input[name="approvalFlag"]').val(6);
				}
			}

			$('#submiteditUserInfo').ajaxSubmit({
					clearForm:true,
					dataType: 'json',
					contentType: 'application/x-www-form-urlencoded',
					success: editUserInformationResponse
				});
				return false;
			SubForm($(obj).parents('form'),editUserInformationResponse);
		}
		}*/
	
	
	function editUserInformationResponse(data) {
		if (data.status_code == 101 || data.status_code==201) {
			modalAlertToShowCustomMessage(data.message, 'warning');
		} else if (data.status_code == 200) {
			//modalAlertToShowCustomMessage(data.message, 'success');
			resetForm('submiteditUserInfo');
			swal(
					{
						title : "Edit User",
						text : data.message,
						type : "success",
					}).then(function() {
						location.reload();
						
			});
			
		} 
		
	}
	
	function fetchUserInformation(){
		if($.trim($('#empCode').val()) != ''){
			$.ajax({
				url: "/AdminModule/fetchUserInformation",
				type: 'POST',
				//async:false,
				//dataType: 'JSON',
				data:{
					e_code:$('#empCode').val(),
					_csrf:$('#csrfToken').val()
					
				},
				success:function(response){
					if(null != response && undefined != response && response != ''){
					var data= $.parseJSON(response);
					//console.log("user information=="+data);				
					$('#editemailId').val(data.emailId);
					$('#edituserName').val(data.userName);
					$('#editemployeeCode').val(data.employeeCode);
					$('#editmobileNo').val(data.contactDetails);
					$('#editpassword').val(data.password);
					$('#editreportingManager').val(data.reportingManager);
					$('#editdesignation').val(data.designation);
					$('#editdepartment').val(data.department);
					$('#editdepartment_name').val(data.department_name);
					$('#editlocation').val(data.location);
					$('#hiddenLocation').val(data.location);
					$('#editHub').val(data.hub);
					$('#editstate').val(data.state);
					$('#hiddenState').val(data.state);
					$('#editregion').val(data.region);
					$('#editreportingManagerEcode').val(data.reporting_manager_ecode);
					$('#editsupervisorDet').val(data.supervisorContactDetails);
					$('#editalternateEmail').val(data.alternateEmail);
					$('#editrole').val(data.role);
					$('#hiddenRole').val(data.role);
					$('#branchCodeEdit').val(data.branchCode);
					$('#branchNameEdit').val(data.branchName);
					$('#editdept_broad_category').val(data.deptBroadCategory);	
					$('#hdfcUserId').val(data.hdfcUserId);
					
					// Set isELearing flag
					if(data.isLearningAvlbl==true){
						$('input[name="isLearningAvlbl"][value="1"]').prop('checked', true);
					}
					else{
						$('input[name="isLearningAvlbl"][value="0"]').prop('checked', true);
					}					
					
					$('#failedAttempts').val(data.failedAttempts);
					$('#hiddenPassword').val(data.password);
					$('#approvalFlag').val(data.approvalFlag);
					 $('select[name="subState"] option[value="'+data.subState+'"]').prop('selected','selected');
				/*	 $('select[name="isDelete"] option[value="'+data.isActive+'"]').prop('selected','selected');
					 $('select[name="isDormant"] option[value="'+data.isActive+'"]').prop('selected','selected');*/
					/*$('#container').removeClass('off');
					$('#deleteContainer').removeClass('off');*/
				//	$('#lockedContainer').removeClass('off');
					/*if(data.isActive == false){
						$('#container').addClass('off');						
					}
					else if(data.isActive == true){
						$('#container').removeClass('off');						
					}*/
					/*if(data.failedAttempts > 5){
						$('#lockedContainer').addClass('on');						
					}*/
					
					$('#editUserBasicDiv').hide();
					if($('#empCode').val() == $('#eCodeHomePage').val() || $('#authorityVal').val()== 'UAM_CHECKER'){
						$('#approveBtn').hide();
						$('#rejectBtn').hide();
						$('#submitEditBtn').show();
					}
					$('#editUserInfo').show('slow');
					
					
					//enable/disable fields.
					if(data.subState!=1){
						/*$('#editemailId').attr("disabled", "disabled"); 
						$('#edituserName').attr("disabled", "disabled"); 
						$('#editemployeeCode').attr("disabled", "disabled"); 
						$('#editmobileNo').attr("disabled", "disabled"); 
						$('#editpassword').attr("disabled", "disabled"); 
						$('#editreportingManager').val(data.reportingManager);
						$('#editdesignation').attr("disabled", "disabled"); 
						$('#editdepartment').val(data.department);
						$('#editdepartment_name').val(data.department_name);
						$('#editlocation').prop('disabled', 'disabled');
						$('#editHub').attr("disabled", "disabled"); 
						$('#editstate').val(data.state);defualt disable
						$('#editregion').attr("disabled", "disabled"); 
						$('#editreportingManagerEcode').attr("disabled", "disabled"); 
						$('#editsupervisorDet').attr("disabled", "disabled"); 
						$('#editalternateEmail').attr("disabled", "disabled"); 
						$('#editrole').prop('disabled', 'disabled');
						$('#branchCodeEdit').val(data.branchCode);
						$('#branchNameEdit').val(data.branchName);
						$('#editdept_broad_category').val(data.deptBroadCategory);	
						$('#hdfcUserId').attr("disabled", "disabled"); 
						$('#departmentTag').prop('disabled', 'disabled');
						$('#branchlist').prop('disabled', 'disabled');
						$('input[name=isLearningAvlbl]').attr("disabled",true);*/
						
						$('#editemailId').attr('readonly', true); 
						$('#edituserName').attr('readonly', true); 
						$('#editemployeeCode').attr('readonly', true); 
						$('#editmobileNo').attr('readonly', true); 
						$('#editpassword').attr('readonly', true); 
						$('#editreportingManager').val(data.reportingManager);
						$('#editdesignation').attr('readonly', true); 
						$('#editdepartment').val(data.department);
						$('#editdepartment_name').val(data.department_name);
						$('#editlocation').prop('disabled', 'disabled');
						$('#editHub').attr('readonly', true); 
						/*$('#editstate').val(data.state);*//*defualt disable*/
						$('#editregion').attr('readonly', true); 
						$('#editreportingManagerEcode').attr('readonly', true); 
						$('#editsupervisorDet').attr('readonly', true); 
						$('#editalternateEmail').attr('readonly', true); 
						$('#editrole').prop('disabled', 'disabled');
						$('#branchCodeEdit').val(data.branchCode);
						$('#branchNameEdit').val(data.branchName);
						$('#editdept_broad_category').val(data.deptBroadCategory);	
						$('#hdfcUserId').attr('readonly', true); 
						$('#departmentTag').prop('disabled', 'disabled');
						$('#branchlist').prop('disabled', 'disabled');
						$('input[name=isLearningAvlbl]').attr('disabled', true);
						
					}
					
					
					}
					else{
						modalAlertToShowCustomMessage("User Does Not Exist in the system", 'warning');
					}
					
					console.log(data);
					
					// Set Department name										
					if(data.departmentId == undefined || data.departmentId=="" || data.departmentId==null){
						$('#departmentTag').val("");
						$('#hiddenDepartmentId').val("");
					}
					else{
						$('#departmentTag').val(data.departmentId);	
						$('#hiddenDepartmentId').val(data.departmentId);
					}
					
					// Set branch name				
					if(data.branchId == undefined || data.branchId=="" || data.branchId==null){
						$('#branchlist').val("");
						$('#hiddenBranchId').val();
					}
					else{
						$('#branchlist').val(data.branchId);
						$('#hiddenBranchId').val(data.branchId);
					}					
				}
			});
		}
		else{
			$('#empCode').val('');
			modalAlertToShowCustomMessage("Please enter employee code", 'warning');
		}
	}

	function submitPDDImport(formParentDivID) {
		
		//alert($("#file-1")[0].files.length);
		
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You are uploading PDD fresh leads datasheet.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
		}).then(function(isConfirm) {
		        
		    	if (isConfirm) {
		    		
		    		/* var startUrl = "/AdminModule/pddImport";
		    		   var pollUrl = "/AdminModule/progressBar";
		    		   var poll = new Poll();
		    		   poll.start(startUrl,pollUrl);*/

		    		
		    		var sock = new SockJS('/AdminModule');
		    		var stompClient = Stomp.over(sock);
		    		
		    		
		    		//Callback function to be called when stomp client is connected to server
		    		var connectCallback = function() {
		    			 	
		    		  stompClient.subscribe('/topic/pdd-lead-import-progress', renderProgress);
		    		};
		    		// Callback function to be called when stomp client could not connect to server
		    		var errorCallback = function(error) {
		    		  alert(error.headers.message);
		    		};
		    		 
		    		// Connect to server via websocket
		    		stompClient.connect("", connectCallback, errorCallback); 
				   // $('#wait').show();
		    		
				var file = document.getElementById('file-1').files[0]
				var key = "vahangyan";
				// Uses different reader for all files
				var reader = new FileReader();
		
				reader.onload = function() {
					
					var salt = CryptoJS.lib.WordArray.random(128/8);
					var iv = CryptoJS.lib.WordArray.random(128/8);
		//			console.log('salt  '+ salt );
		//			console.log('iv  '+ iv );
					
					// To construct our multipart form data request,
					// We need a separator to define each part of the request
					var boundary = "blob";
					
					var data = AESFileEncryption(key, salt, iv, file, reader, boundary, "pddFile");
					$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
					$.ajax({
						headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
						url: "/AdminModule/pddImport",
						type: 'POST',
						processData: false,  // tell jQuery not to process the data
						contentType: false,  // tell jQuery not to process the data
						data:data,
						success:function(response){
							$('#wait').hide();
							stompClient.disconnect();
							resetForm('submitPDDImport');
							console.log(response);
							if(response == null || response == ""){
								$( "#pdd-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
							}
							else if(response.indexOf('header-mismatch') != -1){
								$( "#pdd-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Headers Mismatch! Ensure Header Row is same as sample file', 'warning');
							}
							else if(response.indexOf('SUCCESS') != -1)
							{
//								progress();
								$( "#pdd-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
							}
							else if(response.indexOf('FAILURE') != -1)
							{
								$( "#pdd-excel-download-link" ).hide();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Some error occurred. Please do not upload blank excel file And Ensure Header Row is same as sample file', 'warning');
							}
							else if(response.indexOf('WARNING') != -1){
								var download = document.getElementById('pdd-error-excel-download-link');
								var arrayData= response.split("~");
								download.setAttribute('href', arrayData[3]);	
								console.log(arrayData[3]);
								download.setAttribute('download', 'LogFile.xlsx');
								$('#submitPDDImportBtn').hide();
								$( "#pdd-excel-download-link" ).show();
								$("#fileLabel").html('Upload file customer data (.xlsx)');
								modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
										'. Please go through download link for more detail.', 'warning');
		
							}
						}, 
						error: function(jqXHR, textStatus, errorThrown) {
							console.log('jqXHR:');
							console.log(jqXHR);
							console.log('textStatus:');
							console.log(textStatus);
							console.log('errorThrown:');
							console.log(errorThrown);
		
						}
					});
				}
		
				reader.readAsDataURL(file);
		    	}
	    });
		
	}

	function renderProgress(frame) {
		var data = JSON.parse(frame.body);
		$('#wait').show();
		$("#loaderid").html(data);
//		alert(data);
	}

    function progress(){
	$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
	$.ajax({
//		headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
		url: "/AdminModule/progressBar",
		type: 'GET',
		processData: false,  // tell jQuery not to process the data
		contentType: false,  // tell jQuery not to process the data
		data:{},
		success:function(response){
			if(response!=undefined && response!=0 && response<11){
				 var id = setInterval(frame, 0.5);
				  function frame() {
					  alert(response);
					  console.log("processdata:::"+response);
					  progress();
				  }
			}else{
				alert("100%");
				
			}
		}, 
		error: function(jqXHR, textStatus, errorThrown) {
			console.log('jqXHR:');
			console.log(jqXHR);
			console.log('textStatus:');
			console.log(textStatus);
			console.log('errorThrown:');
			console.log(errorThrown);

		}
	});
}


	function submitPDDImportResponse(content) {
		$('#showPDDImport #loaderImg').hide();
	    resetForm('submitPDDImport');
	    if(content == null || content == ""){
	    	 modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
	    }
	    else if(content.indexOf('SUCCESS') != -1)
	    {
	        $( "#pdd-excel-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
	    }
	    else{
	        var download = document.getElementById('pdd-excel-download-link');
	        var arrayData= content.split("~");
	        download.setAttribute('href', arrayData[3]);
	        download.setAttribute('download', 'LogFile.xlsx');
	        $('#submitPDDImportBtn').addClass('hidden');
	        $( "#pdd-excel-download-link" ).removeClass( "hidden" );
	        modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
	        		'. Please go through download link for more detail.', 'warning');
	}
	
	}
	
	function submitPDDReport(formParentDivID) {
	    
	    var dateSelected="";
	    var eCodeSelected="";
	    var parameter;
	    var target = $('input[name="reportTyperadio"]:checked').val();
	    var activity = $('input[name="activity"]:checked').val();
	    var arr = [];
	    if(target == 'Single'){
	    		
	    	eCodeSelected='';
	    	dateSelected= $('#reportDateTag option:selected').val();
	    	if(dateSelected == null || typeof dateSelected === "undefined" || dateSelected =='')
	    	{
	    		 modalAlertToShowCustomMessage("Date not selected", 'warning');
	    		 return false;
	    	}
	    }
	    else if(target == 'Multiple'){
	    	eCodeSelected='';
	    	var formDate=$('#dateReportFrom').val();
	    	var toDate =$('#dateReportTo').val();
	    	
	    	if(formDate==null || formDate=='')
	    	{
	    		 modalAlertToShowCustomMessage("From Date not selected", 'warning');
	    		 return false;
	    	}
	    	
	    	if(toDate==null || toDate=='')
	    	{
	    		 modalAlertToShowCustomMessage("To Date not selected", 'warning');
	    		 return false;
	    	}
	    	
	    	
	    	if(new Date(formDate) > new Date(toDate))
	    	{
	    		 modalAlertToShowCustomMessage("To Date greater than from date", 'warning');
	    		 return false;
	    	}	
	    	
	    	
	    	dateSelected= formDate+"~"+toDate;
	    }
	    else if(target == 'Ecode'){
	    	dateSelected='';
	    	eCodeSelected=$('#eCodeTag').val();
	    	
	    	if(eCodeSelected == null || typeof eCodeSelected === "undefined" || eCodeSelected =='')
	    	{
	    		 modalAlertToShowCustomMessage("ECode not selected", 'warning');
	    		 return false;
	    	}
	    	
	    }
	    
	    $('input.docType:checkbox:checked').each(function () {
	           arr.push($(this).val());
	    });
	    
	    if(arr.length==0)
	    {
	    	 modalAlertToShowCustomMessage("Document type not selected", 'warning');
    		 return false;
	    }
	    	    
	    
	   // parameter = 'date='+$('#showPDDReportDiv .date > .form-control').val();
	    $.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
	    parameter = 'date='+dateSelected+'&e_code='+eCodeSelected+'&activity='+activity+"&docType="+arr;
	    $('#wait').show();
		var response = makeAjaxCall('pddReport',parameter);
		if(null != response && response != ""){
			var download = document.getElementById('pdd-report-download-link');
			download.setAttribute('href', response);
			download.setAttribute('download', 'LogFile.xlsx');
			$( "#downloadButton" ).show();
			$('#wait').hide();
			modalAlertToShowCustomMessage("Report successfully generated. Please click on download button.", 'success');
		}
		else{
			$('#wait').hide();
			 modalAlertToShowCustomMessage("No data found.", 'warning');	
		}
	}
	
	
	function submitInsuranceReport(formParentDivID) {

		var dateSelected="";
		var eCodeSelected="";
		var parameter;
		$( "#downloadButton" ).hide();
		var reportDate=$('#dateReport').val();

		if(reportDate==null || reportDate=='')
		{
			modalAlertToShowCustomMessage("Date not selected", 'warning');
			return false;
		}
	    parameter = 'date='+reportDate;
	    $('#wait').show();
	    $.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('insuranceReport',parameter);
		if(null != response && response != ""){
			$('#wait').hide();
			var download = document.getElementById('insurance-report-download-link');
			download.setAttribute('href', response);
			download.setAttribute('download', 'LogFile.xlsx');
			$( "#downloadButton" ).show();
			
			modalAlertToShowCustomMessage("Report successfully generated. Please click on download report button.", 'success');
		}
		else{
			$('#wait').hide();
			 modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');	
		}
	}
	
	
	function submitPDDReportResponse(content) {
	
	    resetForm('submitPDDImport');
	    $( "#pdd-excel-download-link" ).hide();
	    if(content == null || content == ""){
	    	 modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
	    }
	    else if(content.indexOf('SUCCESS') != -1)
	    {
	        $( "#pdd-excel-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
	    }
	    else{
	        var download = document.getElementById('pdd-excel-download-link');
	        var arrayData= content.split("~");
	        download.setAttribute('href', arrayData[3]);
	        download.setAttribute('download', 'LogFile.xlsx');
	        $( "#pdd-excel-download-link" ).show();
	        modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
	        		'. Please go through download link for more detail.', 'warning');
	
	    }
	
	}
	
	function submitPDDStatusImport(formParentDivID) {
	
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You are uploading PDD closure leads datasheet.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
	    }).then(function(isConfirm) {
	        
	    	if (isConfirm) {   
			$('#wait').show();
	    		var sock = new SockJS('/AdminModule');
	    		var stompClient = Stomp.over(sock);
	    		//Callback function to be called when stomp client is connected to server
	    		var connectCallback = function() {
	    		  stompClient.subscribe('/topic/pdd-lead-clousre-progress', renderProgress);
	    		}; 
	    		// Callback function to be called when stomp client could not connect to server
	    		var errorCallback = function(error) {
	    		  alert(error.headers.message);
	    		};
	    		// Connect to server via websocket
	    		stompClient.connect("",connectCallback, errorCallback);
	 
			var file = document.getElementById('file-1').files[0]
			var key = "vahangyan";
			// Uses different reader for all files
			var reader = new FileReader();
	
			reader.onload = function() {
				
				var salt = CryptoJS.lib.WordArray.random(128/8);
				var iv = CryptoJS.lib.WordArray.random(128/8);
	//			console.log('salt  '+ salt );
	//			console.log('iv  '+ iv );
				
				// To construct our multipart form data request,
				// We need a separator to define each part of the request
				var boundary = "blob";
				
				var data = AESFileEncryption(key, salt, iv, file, reader, boundary, "pddStatusFile");
				$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
				$.ajax({
					headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
					url: "/AdminModule/pddStatusUpload",
					type: 'POST',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					data:data,
					success:function(response){
						$('#wait').hide();
						stompClient.disconnect();
						resetForm('submitPDDStatusImport');
						if(response == null || response == ""){
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
						}
						else if(response == 'header-mismatch'){
							  modalAlertToShowCustomMessage('Column Headers do not match with sample file. Please use sample file for reference', 'warning'); 
						  }
						else if(response.indexOf('SUCCESS') != -1)
						{
							$( "#pdd-excel-downlod-link" ).hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
						}
						else if(response.indexOf('FAILURE') != -1)
						{
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Oops Some error occurred. Please do not enter blank excel file', 'warning');
						}
						else{
							var download = document.getElementById('pdd-error-excel-download-link');
							var arrayData= response.split("~");
							download.setAttribute('href', arrayData[3]);
							download.setAttribute('download', 'LogFile.xlsx');
							$('#submitPDDImportBtn').hide();
							$( "#pdd-excel-download-link" ).show();
							$("#fileLabel").html('Upload file customer data (.xlsx)');
							modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
									'. Please go through download link for more detail.', 'warning');
	
						}
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
	
					}
				});
			}
	
			reader.readAsDataURL(file);
	    	}
	    }/*,
	    function() {
	    	modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');
	      }*/
	    );
	}
	
	function submitPDDStatusImportResponse(content) {
		$('#showPDDStatusImport #loaderImg').hide();
	    resetForm('submitPDDStatusImport');
	    if(content == null || content == ""){
	    	 modalAlertToShowCustomMessage('Some error occurred.Please enter valid excel file', 'warning');
	    }
	    else if(content.indexOf('SUCCESS') != -1)
	    {
	        $( "#pdd-status-excel-download-link" ).addClass( "hidden" );
	        modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
	    }
	    else{
	        var download = document.getElementById('pdd-status-excel-download-link');
	        var arrayData= content.split("~");
	        download.setAttribute('href', arrayData[3]);
	        download.setAttribute('download', 'LogFile.xlsx');
	        $('#pddStatusSubmit').addClass('hidden');
	        $( "#pdd-status-excel-download-link" ).removeClass( "hidden" );
	        modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
	        		'. Please go through download link for more detail.', 'warning');
	
	    }
	
	}
	
	function showReportType(){
		var target = $('input[name="reportTyperadio"]:checked').val();
		$('#singleReportDate').hide();
		$('#multipleReportDate').hide();
		$('#eCodeReport').hide();
		$('#reportFooter').hide();
		$('#pdd-report-download-link').attr('href','');
		$('#downloadButton').hide();
		$('#submitPddReport').show();
		$('#dateReportFrom').val('');
		$('#dateReportTo').val('');
		
		if (target == 'Single') {
			$('#singleReportDate').show();
			$('#reportFooter').show();
			fetchSingleReportDates();
		}
		else if(target == 'Multiple'){
			$('.input-daterange input').each(function() {
				$(this).datepicker("clearDates");
			});
			$('#multipleReportDate').show();
			$('#reportFooter').show();
		}
		else if(target == 'Ecode'){
			fetchPDDReportEcode();
	
		}
		
	}
	
	function fetchSingleReportDates(){
        $('#wait').show();
 		$.ajax({
 			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()}, 
 			type:'POST', 
 			url:"/AdminModule/fetchSingleReportDates",
 			success:function(data){
				//console.log(data);
				$('#wait').hide();
				$('#reportDateTag').html('');
				if(null != data && undefined != data){
				$.map(data,function(item){
					$('#reportDateTag').append('<option value="'+item+'">'+item+'</option>');
				});
				}
				$('#singleReportDate').show();
				$('#reportFooter').show();
			}
 		});
	}
	var eCodes="";
	function fetchPDDReportEcode(){
		if(eCodes!=""){
			$('#eCodeTag').append(eCodes);
			$('#eCodeReport').show();
			$('#reportFooter').show();
	    }	
		else{	
			$('#wait').show();
	 		$.ajax({
	 			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()}, 
	 			type:'POST', 
	 			url:"/AdminModule/fetchPDDReportEcode",
	 			success:function(data){
	 				$('#wait').hide();
					//console.log(data);
					$('#eCodeTag').html('');
					$.map(data,function(item){
						eCodes=eCodes+'<option value="'+item+'">'+item+'</option>';
					});
					$('#eCodeTag').append(eCodes);
					$('#eCodeReport').show();
					$('#reportFooter').show();
				}
	 		});
		}
		
	}
	
	function fetchBranchMaster(code,name){
		$.ajax({
			url: "/AdminModule/fetchBranchMaster",
			type: 'POST',
			data:{
				_csrf:$('#csrfToken').val()
			},		
			async:false,
			//dataType: 'JSON',
			success:function(data){
				//console.log(data);
				var htmlCode="";
				var htmlName="";
				$.map(data,function(item){
					htmlCode += '<option value="'+item.branchCode+'" code="'+item.branchCode+'_'+item.branchName+'">'+item.branchCode+'</option>';
					htmlName += '<option value="'+item.branchName+'" code="'+item.branchCode+'_'+item.branchName+'">'+item.branchName+'</option>';
				});
				  $('#'+code).append(htmlCode);
				  $('#'+name).append(htmlName);
			}
		});
	}
	function changeBranchName(el,branchName){
		var arrayData= $(el).find(':selected').attr('code').split("_");
		if(undefined != arrayData){
			$('#'+branchName).val(arrayData[1]);
		}
	}
	function changeBranchCode(el,branchCode){
		var arrayData= $(el).find(':selected').attr('code').split("_");
		if(undefined != arrayData){
			$('#'+branchCode).val(arrayData[0]);
		}
	}
	
	function initDateTimePicker(){
		var dt = new Date();
		var nextdate=dt.getDate()+1;
		var selected=new Date(dt.getFullYear(), dt.getMonth(), nextdate, 8, 0, 0, 0);
		var range = new Date(selected.getFullYear(),selected.getMonth()+1,selected.getDate(),19,0,0,0);
		$("#datenotification").AnyPicker(
				{
					mode: "datetime",
	
					dateTimeFormat: "yyyy-MM-dd HH:mm:ss",
					//inputDateTimeFormat: "dd/MM/yyyy hh:mm AA",
					 minValue: selected,
					 maxValue:range,
					selectedDate:selected, 
					//inputChangeEvent: "onChange",
					onInit: function()
					{
						oAP1 = this;
						console.log("maxValue : " + oAP1.setting.maxValue);
						console.log("minValue : " + oAP1.setting.minValue);
						console.log("selectedValue : " + oAP1.setting.selectedDate);
					},
	
					onSetOutput: function(sOutput, oSelectedValues)
					{
						console.log("Changed Value : " +oSelectedValues.date);
						var cDate = oSelectedValues.date;
						var cHours =cDate.getHours();
						if((cHours>= 8 && cHours<19) || (cHours==19 && cDate.getMinutes() == 0)){
						console.log('ok time');
						}
						else{
		               	modalAlertToShowCustomMessage('Please select time in business hours( 08:00 hrs to 19:00 hrs)','warning');
							this.setSelectedDate(selected);
						}
					}
					//maxValue: new Date(2016, 0, 19, 19, 0, 0, 0)
					
					
				});
	}
	//========================== mass mailer =====================================
	
	//mass mailer file upload Ajax request here
	function submitMassMailerFileUpload(formParentDivID) {
	
		if(document.getElementById('resourceFile').files[0]
		&& document.getElementById('dataFile').files[0]){
			if (confirm("Are You Sure You Want to upload mass mailer Information!")) {
				$('#submitMassMailerFileUpload').ajaxSubmit({
					contentType: 'application/x-www-form-urlencoded',
					enctype: 'multipart/form-data',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					success: submitMassMailerFileUploadResponse
				});
			}
			else {
				modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');
			}
		}else{
			modalAlertToShowCustomMessage("Please select both files.", 'warning');
		}
	
	}
	
	//mass mailer file upload Response here
	function submitMassMailerFileUploadResponse(content) {
	
		resetForm('submitMassMailerFileUpload');
	
		var responseArray = content.split("#");
		if(responseArray[0]=='SUCCESS')
		{
			var fieldNameArray = responseArray[1].split("~");
			var submit = document.getElementById("submit");
			submit.setAttribute("onclick", "sendMassMailer('"+responseArray[1]+"')");
			var keyDataField = document.getElementById("keyDataField");
			var valueDataField = document.getElementById("valueDataField");
			while (keyDataField.hasChildNodes()) {
				keyDataField.removeChild(keyDataField.lastChild);
			}
			while (valueDataField.hasChildNodes()) {
				valueDataField.removeChild(valueDataField.lastChild);
			}
			$.each(fieldNameArray, function(i, item) {			
				var keyElement = document.createElement('div');
				keyElement.setAttribute("class", "col-lg-12 inputbox");
				keyElement.innerHTML = '<input type="text" id="keyDataField'+(i+1)+'" name="keyDataField'+(i+1)+'" value="'+item+'" placeholder="Key#'+(i+1)+'" readonly="readonly">';
	
				var valueElement = document.createElement('div');
				valueElement.setAttribute("class", "col-lg-12 inputbox");
				valueElement.innerHTML = '<input type="text" id="valueDataField'+(i+1)+'" name="valueDataField'+(i+1)+'" placeholder="value#'+(i+1)+'">';
	
				keyDataField.appendChild(keyElement);
				valueDataField.appendChild(valueElement);
			});
			modalAlertToShowCustomMessage('File has been uploaded successfully.', 'success');
		}
		else{
	//		var download = document.getElementById('csv-download-link');
	//		download.setAttribute('href', content);
	//		download.setAttribute('download', 'Error-Log.csv');
	//		$( "#csv-download-link" ).removeClass( "hidden" );
			modalAlertToShowCustomMessage('Server encountered problem. Please try again.', 'warning');
	
		}
	
	}
	
	function getMassMailerPreview(){
		$.ajax({
			url: "/AdminModule/massMailerPreview",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				console.log(data);
				var responseArray = data.split("#");
				var preview = document.getElementById('previewIframe');
				preview.setAttribute('src', responseArray[1]);
			}
		});
	}
	
	function sendMassMailer(fieldNames){
		var fieldNameArray = fieldNames.split("~");
		var fieldData = '';
		$.each(fieldNameArray, function(i, item) {
			fieldData = fieldData + item + '~' + $('#valueDataField'+(i+1)).val() + '#'
		});
		fieldData = fieldData.substring(0, (fieldData.length-1));
		$.ajax({
			url: "/AdminModule/sendMassMailer",
			type: 'POST',
			data:"data="+fieldData,
			success:function(data){
				if(data=='SUCCESS'){
					modalAlertToShowCustomMessage('Mass mailer sending event initiated successfully.', 'success');
					var keyDataField = document.getElementById("keyDataField");
					var valueDataField = document.getElementById("valueDataField");
					while (keyDataField.hasChildNodes()) {
						keyDataField.removeChild(keyDataField.lastChild);
					}
					while (valueDataField.hasChildNodes()) {
						valueDataField.removeChild(valueDataField.lastChild);
					}
				}else{
					modalAlertToShowCustomMessage('Please upload file.', 'warning');
				}
	
			}
		});
	}
	
	function fetchAssignTOReport(){
		$('#reportAssignedToMsg').hide();
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#hiddenEcode').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/reportAssignedTO", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				// 	console.log(result);
				if(undefined != result && undefined != result.data) {
					$('#reportAssignedToDiv').html('');
					$('#reportAssignedToDiv').append('<tr><td width="70%"><div class="table-heading">Report Name</div></td><td width="20%"><div class="table-heading">Cut off Time</div></td>' +
							'<td width="10%" class="icontap2 table-heading">View</td></tr>');
					
					$.map(result.data.assignReport,function(item){
					    var res = item.reportName.replace(/'/g, "\\'");
						$('#reportAssignedToDiv').append('<tr><td>'+item.reportName+'</td><td><i class="fa fa-clock-o" aria-hidden="true"></i> '+item.cutOffTime+'</td><td class="icontap"><a id="'+item.reportId+'"onclick="fetchCompleteReportDetails('+item.reportId+', false)"><i class="fa fa-angle-right" aria-hidden="true"></i></a></td></tr>');
					});
					
					$('#reportAssignedToList').append('<label class="col-sm-12 top7"><div class="table-heading">Report Name</div></label>');
					$.map(result.data.assignReport,function(item) {
						$('#reportAssignedToList').append('<label class="col-sm-12 top7" id='+item.reportId+'><a id="'+item.reportId+'"onclick="fetchCompleteReportDetails('+item.reportId+', false)">'+item.reportName+'</a></label>');
					});
				} else {
					$('#reportAssignedToMsg').show();
				}
			}
		});
	}
	
	function fetchAssignBYReport(){
		$('#reportAssignedByMsg').hide();
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#hiddenEcode').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/reportAssignedBY", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				//	console.log(result);
				if(undefined != result && undefined != result.data && undefined != result.data.assignReport){
					$('#reportAssignedByDiv').html('');
					$('#reportAssignedByDiv').append('<tr><td width="70%"><div class="table-heading">Report Name</div></td><td width="20%"><div class="table-heading">Cut off Time</div></td>' +
							'<td width="5%" class="icontap2">Edit</td>'+
							'<td width="5%" class="icontap">View</td></tr>');
					
					$.map(result.data.assignReport,function(item){
					    var res = item.reportName.replace(/'/g, "\\'");
					    
						//$('#reportAssignedByDiv').append('<label class="col-sm-12 top7"><a id="'+item.reportId+'"onclick="fetchCompleteReportDetails('+item.reportId+', true)">'+item.reportName+'</a></label>');
						$('#reportAssignedByDiv').append('<tr><td width="70%">'+item.reportName+'</td><td width="20%"><i class="fa fa-clock-o" aria-hidden="true"></i> '+item.cutOffTime+'</td>' +
								'<td width="5%" class="icontap2"><a href="#" id="'+item.reportId+'"onclick=\"editCreateReportData(\''+item.cutOffTime+'\',\''+res+'\','+item.reportId+')\"><i class="fa fa-pencil" aria-hidden="true"></i></a></td>'+
								'<td width="5%" class="icontap"><a href="#" id="'+item.reportId+'"onclick="fetchCompleteReportDetails('+item.reportId+', true)"><i class="fa fa-angle-right" aria-hidden="true"></i></a></td></tr>');
					});
				}
				else{
					$('#reportAssignedByMsg').show();
				}
			}
		});
		fetchReferenceReportEmpList();
	}
	
	function editCreateReportData(cutOffTime, reportName, reportId) {
		$('#createReportId').addClass('hidden');
		$('#editReportId').removeClass('hidden');
		$('#createButtonReportId').addClass('hidden');
		$('#editButtonReportId').removeClass('hidden');
		
		$('#setTargetReport').addClass('hidden');
		$('#createReportDiv').removeClass('hidden');
		
		$('#baseReportId').val(reportId);
		$('#reportName').val(reportName);
		$('#cutOfTime').val(cutOffTime);
		$("#cutOfTime").AnyPicker("destroy");
		$("#cutOfTime").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "hh:mm AA", 
			viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
			onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues); }});
	}
	
	function fetchRegionList(){
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#hiddenEcode').val(), type:'region'};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/getTargetList", dataType: "json", data:JSON.stringify(finalData), async:false, 
			success:function(result){
	//			console.log(result);
				if(undefined != result && undefined != result.data){
					$('#regionListLebel').removeClass('hidden');
					$('#regionListDiv').html('');
					var optionList = '';
					$.map(result.data.object,function(item){
	//					console.log(item);
						optionList += '<option value="'+item+'">'+item+'</option>';
					});
					$('#regionListDiv').append('<select id="regionList" required class="custome-select">' + optionList + '</select>');
	
					$( '#regionList' ).off('change');
					$( '#regionList' ).on('change', function() {
						fetchRegionWiseEmpList();
					});
					$( '#regionList option:first').attr('selected','selected');
					$( '#regionList' ).trigger('change');
	
					//$('#regionList').searchableSelect();
					//	$('#regionList').searchableSelect();
				}else{
					$('#regionListLebel').addClass('hidden');
				}
			}
		});
	}
	
	function fetchRegionWiseEmpList(){
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#hiddenEcode').val(), region:$('#regionList').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/getTargetEmpList", dataType: "json", data:JSON.stringify(finalData), async:false, 
			success:function(result){
	//			console.log(result);
				if(undefined != result && undefined != result.data){
					$('#empListLebel').removeClass('hidden');
					$('#empListDiv').html('');
					var optionList = '';
					$.map(result.data.empList,function(item){
						//console.log(item);
						optionList = optionList + '<option value="'+item.empCode+'">'+item.name+' - '+item.empCode+'</option>';
					});
					$('#empListDiv').append('<select required id="empList" class="custome-select">' + optionList + '</select>');
					
					$( '#empList' ).off('change');
					$( '#empList' ).on('change', function() {
						fetchReportMonths();
					});
					$('#empList option:first').attr('selected','selected');
					$('#empList').trigger('change');
					//$('#empList').searchableSelect();
					//	$('#empList').searchableSelect();
				} else {
					//$('#empListLebel').addClass('hidden');
					$('#empListDiv').html('');
					//var optionList = '<option></option>';
					$('#empListDiv').append('<select required id="empList" class="custome-select">' + optionList + '</select>');
					//$('#empList').searchableSelect();
					$('#empList option:first').attr('selected','selected');
					$('#empList').trigger('change');
				}
			}
		});
	}
	
	function fetchReferenceReportEmpList(){
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#hiddenEcode').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/reportAssignedTO", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
	//			console.log(result);
				if(undefined != result && undefined != result.data){
					$('#referenceReportlabel').removeClass('hidden');
					$('#referenceReportDiv').html('');
					var optionList = '<option selected value=0>Select Report</option>';
					$.map(result.data.assignReport,function(item){
						//console.log(item);
						optionList = optionList + '<option value="'+item.reportId+'">'+item.reportName+'</option>';
					});
					$('#referenceReportDiv').append('<select required id="referenceReportId" class="custome-select">' + optionList + '</select>');
					//$('#referenceReportId').searchableSelect();
				}else{
					$('#referenceReportlabel').addClass('hidden');
				}
			}
		});
	}
	
	function fetchReportMonths(){
		$('#fetchPreviousMonthDataDiv').hide();
		$('#fetchLastMonthTargetId').hide();
		resetForm('targetDetailFormId');
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {reportId:$('#newReportId').val(), region:$('#regionList').val(), empCode:$('#empList').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/getReportMonth", dataType: "json", data:JSON.stringify(finalData), async:false, 
			success:function(result){
				//	console.log(result);
				if(undefined != result && undefined != result.data){
					$('#targetMonthsLi').removeClass('hidden');
					$('#targetMonthsButton').removeClass('hidden');
					$('#targetMonths').html('');
					var optionList = '';
					$.map(result.data.month,function(item){
						optionList = optionList + '<option value="'+item+'">'+item+'</option>';
					});
					$('#targetMonths').append('<select required id="targetSelectMonth" class="custome-select">' + optionList + '</select>');
					//$('#targetSelectMonth').searchableSelect();
				}else{
					$('#targetMonthsLi').addClass('hidden');
					$('#targetMonthsButton').addClass('hidden');
				}
			}
		});
	}
	
	function fetchCompleteReportDetails(el, flag){
	//	var reportId = $(el).attr('id');
		$('#newReportId').val(el);
		var reportId = el;
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {reportId:parseInt(reportId)};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/completeTargetReport", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				console.log(result);
				if (undefined != result && undefined != result.data && result.data.regionWiseData.length != 0){
					$('#regionWiseDiv').html('');
					$('#completeCreateReportNameTargetId').html(result.data.reportName);
					
					$.map(result.data.regionWiseData,function(item){
						$('#completeCreateReportNameTargetId').html(item.reportName);
						/*var html ='<div class="collapse-new"><div class="deta-list"><ul><li>'+item.region+'</li>'+ 
						'<li>&nbsp;</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.nomTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.uomTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.adcTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.bcsTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.totalDisbursement+' cr.</li></ul></div>'+
						'<span class="collapse-heading"></span><div class="collapse-iner">';*/
						var html = '<tr><td data-th="Region">'+item.region+'</td><td data-th="Month">&nbsp;</td><td data-th="NOM">'+item.nomTotalDisbursement+
						'cr.</td><td data-th="UOM">'+item.uomTotalDisbursement+'cr.</td><td data-th="ADC">'+item.adcTotalDisbursement+
						'cr.</td><td data-th="BCS">'+item.bcsTotalDisbursement+'cr.</td><td data-th="Total">'+item.totalDisbursement+
						'cr.</td><td data-th="Achieved %">&nbsp;</td></tr>';
						
						$.map(item.assignedTargetData,function(item1){
							/*html+='<div class="deta-list collapsemater"><ul><li><i class="fa fa-user" aria-hidden="true"></i>'+
							'<span>'+item1.name+'</span></li>'+
							'<li>'+item1.month+'</li><li>'+
							'<i class="fa fa-inr" aria-hidden="true"></i>'+item1.nomDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.uomDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.adcDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.bcsDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.totalDisbursement+' cr.</li>'+
							'<li></li>';
							if(flag) {
								html+='<span class="editicon"><a href="#" onclick="fetchCompleteTargetDetails('+item1.targetId+')"><i class="fa fa-pencil" aria-hidden="true"></i>'+
								'</a></span>';
							}
							html+='</ul></div>';*/
							html += '<tr><td data-th="Region">'+item1.name+'</td><td data-th="Month">&nbsp;</td><td data-th="NOM">'+item1.nomDisbursement+
							'cr.</td><td data-th="UOM">'+item1.uomDisbursement+'cr.</td><td data-th="ADC">'+item1.adcDisbursement+
							'cr.</td><td data-th="BCS">'+item1.bcsDisbursement+'cr.</td><td data-th="Total">'+item1.totalDisbursement+
							'cr.</td><td data-th="Achieved %">&nbsp;</td></tr>';
						});
						html+="</div></div>";
						$('#regionWiseDiv').append(html);
					});
					/*$('#regionWiseDiv').append('<div class="unit-show" style="background-color:#d0ddf2; font-weight:600;"><div class="deta-list"><ul><li>Grand Total</li><li>&nbsp;</li>'+
	                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandNomDisbursement+' cr.</li>'+
	                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandUomDisbursement+' cr.</li>'+
	                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandAdcDisbursement+' cr.</li>'+
	                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandBcsDisbursement+' cr.</li>'+
	                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandDisbursement+' cr.</li></ul></div></div>');*/
					$('#regionWiseDiv').append('<tr><th data-th="Region">Grand Total</th><th data-th="Month">&nbsp;</th><th data-th="NOM">'+result.data.grandNomDisbursement+
							'cr.</th><th data-th="UOM">'+result.data.grandUomDisbursement+'cr.</th><th data-th="ADC">'+result.data.grandAdcDisbursement+
							'cr.</th><th data-th="BCS">'+result.data.grandBcsDisbursement+'cr.</th><th data-th="Total">'+result.data.grandDisbursement+
							'cr.</th><th data-th="Achieved %">&nbsp;</th></tr>');
					
					$('#completeTargetDiv .collapse-heading').addClass('fechado');
					var $active = null;
					$('#completeTargetDiv .collapse-heading').off('click');
					$('#completeTargetDiv .collapse-heading').on('click',function(){
	
						if ($active !== null){
							$active.next().slideToggle("fast");
							$active.removeClass('aberto');
							$active.addClass('fechado');
						} 
	
						$active = $(this);
						$active.addClass('aberto');
						$next = $active.next();
	
						if ($next.is(":hidden")){
							$next.slideToggle("fast");
						}else{
							$active.removeClass('aberto');
							$active.addClass('fechado');
							$active = null;     
						}
	
					});
					$('#setTargetReport').addClass('hidden');
					$('#completeTargetDiv').removeClass('hidden');
					if (!flag) {
						$('#completeCreateTargetId').addClass('hidden');
					} else {
						$('#completeCreateTargetId').removeClass('hidden');
					}
	
				} else {
					completeCreateTarget();
				}
			} 
		});
		dataModelPopup();
	}
	
	function fetchCompleteTargetDetails(targetEl) {
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {targetId:targetEl};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/getTargetReport", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				console.log(result);
				if(undefined != result && undefined != result.data) {
					fetchRegionList();
					//fetchRegionWiseEmpList();
					fetchReportMonths();
					
					$('#cutOffTimeDetailId').html(result.data.cutOffTime);
					$('#reportNameDetailId').html(result.data.reportName);
					
					$('#editTargetReportId').val(targetEl);
	
					$('#completeTargetDiv').addClass('hidden');
	
					$('#createTargetDiv').removeClass('hidden');
					$('#fetchTotalTargetDiv').addClass('hidden');
					
					$("#regionList option[value='"+ result.data.region +"']").attr("selected", "selected");
					//$('#regionList').searchableSelect();
					$('#regionList').trigger('change');
					
					$("#empList option[value='"+ result.data.empCode +"']").attr("selected", "selected");
					$( '#empList' ).trigger('change');
					//$('#empList').val(result.data.empName);
	
					$('#fetchTargetMonth').val(result.data.month +" "+result.data.year);
					$("#fetchTargetMonth").AnyPicker("destroy");
					$("#fetchTargetMonth").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "MMM yyyy", 
						viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
						onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues);} });
	
					$('#targetNOMUnits').val(result.data.nomUnits);
					$('#targetNOMDis').val(result.data.nomDisbursement);
	
					$('#targetUOMUnits').val(result.data.uomUnits);
					$('#targetUOMDis').val(result.data.uomDisbursement);
	
					$('#targetADCUnits').val(result.data.adcUnits);
					$('#targetADCDis').val(result.data.adcDisbursement);
	
					$('#targetBCSUnits').val(result.data.bcsUnits);
					$('#targetBCSDis').val(result.data.bcsDisbursement);
					
					$('#createTargetButtonId').addClass('hidden');
					$('#editTargetButtonId').removeClass('hidden');
					$('#createTargetId').addClass('hidden');
					$('#editTargetId').removeClass('hidden');
				} 
			}
		});
	}
	
	function fetchAssignTarget(){
		var d = new Date(); 
		var curr_date = d.getDate(); 
		var curr_month = d.getMonth()+1; 
		var curr_year = d.getFullYear();
	
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {month:curr_month, reportId:$('#newReportId').val(), year:curr_year, empCode:$('#hiddenEcode').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val() 
			}, type:'POST', url:"/AdminModule/fetchTarget", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				console.log(result);
				if(undefined != result && undefined != result.data) {
					//$('#completeTargetDiv').removeClass('hidden');
	
					$('#targetMonth').html(result.data.month);
					$('#targetNom').html(result.data.nomUnits);
					$('#targetNomCr').html(result.data.nomDisbursement);
					$('#targetUom').html(result.data.uomUnits);
					$('#targetUomCr').html(result.data.uomDisbursement);
					$('#adcUnits').html(result.data.adcUnits);
					$('#adcCr').html(result.data.adcDisbursement);
					$('#BcsUnits').html(result.data.bcsUnits);
					$('#BcsCr').html(result.data.bcsDisbursement);
				} else {
					$('#fetchTotalTargetDiv').addClass('hidden');
				}
			}
		});
	}
	
	function fetchLastMonthAssignTarget(flag){
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {month:$('#targetSelectMonth').val().split(", ")[0], reportId:$('#newReportId').val(), year:$('#targetSelectMonth').val().split(", ")[1], empCode:$('#empList').val(), region:$('#regionList').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val() 
			}, type:'POST', url:"/AdminModule/fetchTarget", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				console.log(result);
				if(undefined != result && undefined != result.data) {
					$('#targetDiv').removeClass('hidden');
					if (flag) {
						$('#fetchPreviousMonthDataDiv').html('');
						var html ='<ul><li><span>Nom</span><div class="trg-count"><i class="fa fa-inr" aria-hidden="true"></i> '+result.data.nomDisbursement+' </div> <small>Cr.</small></li>'+
						'<li><span>uom</span><div class="trg-count"><i class="fa fa-inr" aria-hidden="true"></i> '+result.data.uomDisbursement+' </div> <small>Cr.</small></li>'+
						'<li><span>adc</span><div class="trg-count"><i class="fa fa-inr" aria-hidden="true"></i> '+result.data.adcDisbursement+' </div> <small>Cr.</small></li>'+
						'<li><span>bcs</span><div class="trg-count"><i class="fa fa-inr" aria-hidden="true"></i> '+result.data.bcsDisbursement+' </div> <small>Cr.</small></li></ul>'+
						'<div class="copycode"><a onclick="fetchLastMonthAssignTarget('+false+')"><i class="fa fa-clone" aria-hidden="true"></i>Copy same target for below month</a> <div class="showdiv hidden" id="showtickCopyId"><span class="tickcopy"><img src="images/tick.svg" th:src="@{images/tick.svg}" width="25px"></span></div></div>';
						$('#fetchPreviousMonthDataDiv').append(html);
					} else {
						var nomAmount = result.data.nomDisbursement;
						nomAmount = nomAmount.replace(/\,/g,'');
						nomAmount = Number(nomAmount);
							
						var uomAmount = result.data.uomDisbursement;
						uomAmount = uomAmount.replace(/\,/g,'');
						uomAmount = Number(uomAmount);
						
						var adcAmount = result.data.adcDisbursement;
						adcAmount = adcAmount.replace(/\,/g,'');
						adcAmount = Number(adcAmount);
						
						var bcsAmount = result.data.bcsDisbursement;
						bcsAmount = bcsAmount.replace(/\,/g,'');
						bcsAmount = Number(bcsAmount);
							
						$('#fetchTargetMonth').val(result.data.month +" "+result.data.year);
	
						$('#targetNOMUnits').val(result.data.nomUnits);
						$('#targetNOMDis').val(nomAmount);
	
						$('#targetUOMUnits').val(result.data.uomUnits);
						$('#targetUOMDis').val(uomAmount);
	
						$('#targetADCUnits').val(result.data.adcUnits);
						$('#targetADCDis').val(adcAmount);
	
						$('#targetBCSUnits').val(result.data.bcsUnits);
						$('#targetBCSDis').val(bcsAmount);
						
						$('#showtickCopyId').removeClass('hidden');
					}
				} else {
					$('#fetchTotalTargetDiv').addClass('hidden');
				}
			}
		});
	}
	
	function createReport() {
		$('#createReportId').removeClass('hidden');
		$('#editReportId').addClass('hidden');
		$('#createButtonReportId').removeClass('hidden');
		$('#editButtonReportId').addClass('hidden');
		
		
		$('#setTargetReport').addClass('hidden');
		$('#createReportDiv').removeClass('hidden');
		$("#cutOfTime").AnyPicker("destroy");
		$("#cutOfTime").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "hh:mm AA", 
			viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
			onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues); }});
		
		resetForm('reportFormId');
	}
	
	function editReport() {
		var form = $( "#reportFormId" );
		form.validate({rules: { reportName: {required: true, regex: /^[a-zA-Z][a-zA-Z0-9-_\':. ]{1,100}$/ }}});
		if (form.valid())  {
			if (undefined != $('#cutOfTime').val() && undefined != $('#reportName').val() && '' != $('#cutOfTime').val() && '' != $('#reportName').val()) {
				var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
				var data = {cutoffTime:$('#cutOfTime').val(), reportName:$('#reportName').val(), reportid:$('#referenceReportId').val(), empCode:$('#hiddenEcode').val(), id:$('#baseReportId').val()};
				var finalData = {info:info, data:data};
				$.ajax({
					headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
					}, type:'POST', url:"/AdminModule/createReport", dataType: "json", data:JSON.stringify(finalData),
					success:function(result){
						if (undefined != result.data.reportId && '' != result.data.reportId)  {
							$('#setTargetReport').removeClass('hidden');
							$('#createReport').addClass('hidden');
							$('#createReportDiv').addClass('hidden');
							
							fetchAssignTOReport();
							fetchAssignBYReport();
						}
					}
				});
			}}
	}
	
	function createNewReport() {
		var form = $( "#reportFormId" );
		form.validate({rules: { reportName: {required: true, regex: /^[a-zA-Z][a-zA-Z0-9-_\':. ]{1,100}$/ }}});
		if (form.valid())  {
			if (undefined != $('#cutOfTime').val() && undefined != $('#reportName').val() && '' != $('#cutOfTime').val() && '' != $('#reportName').val()) {
				var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
				var data = {cutoffTime:$('#cutOfTime').val(), reportName:$('#reportName').val(), reportid:$('#referenceReportId').val(), empCode:$('#hiddenEcode').val(), id:0};
				var finalData = {info:info, data:data};
				$.ajax({
					headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
					}, type:'POST', url:"/AdminModule/createReport", dataType: "json", data:JSON.stringify(finalData),
					success:function(result){
						if (undefined != result.data.reportId && '' != result.data.reportId)  {
							$('#newReportId').val(result.data.reportId);
							$('#setTargetReport').addClass('hidden');
							$('#createReportDiv').removeClass('hidden');
							$('#createReportDiv').addClass('hidden');
	
							fetchAssignTarget();
							$('#setTargetReport').addClass('hidden');
							$('#createReportDiv').addClass('hidden');
							$('#createTargetDiv').removeClass('hidden');
							$('#completeTargetDiv').addClass('hidden');
							$("#fetchTargetMonth").AnyPicker("destroy");
							$("#fetchTargetMonth").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "MMM yyyy", 
								viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
								onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues);} });
	
							fetchRegionList();
							//fetchRegionWiseEmpList();
							fetchReportMonths();
							
							//$('#regionList').searchableSelect();
							$('#regionList').trigger('change');
							
							$('#cutOffTimeDetailId').html($('#cutOfTime').val());
							$('#reportNameDetailId').html($('#reportName').val());
							
							$('#createTargetButtonId').removeClass('hidden');
							$('#editTargetButtonId').addClass('hidden');
							$('#createTargetId').removeClass('hidden');
							$('#editTargetId').addClass('hidden');
						}
					}
				});
			}}
	}
	
	function completeCreateTarget() {
		resetForm('targetDetailFormId');
		
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {reportId:$('#newReportId').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/getBaseReportDetail", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				if (undefined != result.data)  {
					
					$('#cutOffTimeDetailId').html(result.data.cutOffTime);
					$('#reportNameDetailId').html(result.data.reportName);
					
					$('#newReportId').val();
					$('#setTargetReport').addClass('hidden');
					$('#createReportDiv').removeClass('hidden');
					$('#createReportDiv').addClass('hidden');
	
					fetchAssignTarget();
					$('#setTargetReport').addClass('hidden');
					$('#createReportDiv').addClass('hidden');
					$('#createTargetDiv').removeClass('hidden');
					$('#completeTargetDiv').addClass('hidden');
					$("#fetchTargetMonth").AnyPicker("destroy");
					$("#fetchTargetMonth").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "MMM yyyy",
						viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
						onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues);} });
	
					fetchRegionList();
					//$('#regionList').searchableSelect();
					$('#regionList').trigger('change');
					//fetchRegionWiseEmpList();
					fetchReportMonths();
					
					$('#createTargetButtonId').removeClass('hidden');
					$('#editTargetButtonId').addClass('hidden');
					$('#createTargetId').removeClass('hidden');
					$('#editTargetId').addClass('hidden');
				}
			}
		});
	}
	
	function createTarget() {
		createNewReport();
		dataModelPopup();
	}
	
	function cancelReport(){
		$('#setTargetReport').removeClass('hidden');
		$('#createReport').addClass('hidden');
		$('#createReportDiv').addClass('hidden');
	}
	
	function cancelTarget(){
		$('#createTargetDiv').addClass('hidden');
		$('#setTargetReport').removeClass('hidden');
	}
	
	function submitTarget(){
		var form = $( "#targetDetailFormId" );
		var validate=form.validate();
		if (validate.form())  {
	
			var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
			var data = {bcsDisbursement:$('#targetBCSDis').val(), bcsUnits:$('#targetBCSUnits').val(), 
					adcDisbursement:$('#targetADCDis').val(),  adcUnits:$('#targetADCUnits').val(), 
					uomDisbursement:$('#targetUOMDis').val(), uomUnits:$('#targetUOMUnits').val(), 
					nomDisbursement:$('#targetNOMDis').val(), nomUnits:$('#targetNOMUnits').val(), 
					month:$('#fetchTargetMonth').val().split(" ")[0], 
					year:$('#fetchTargetMonth').val().split(" ")[1], 
					assignedEmpCode:$('#empList').val(), 
					region:$('#regionList').val(), 
					reportId:$('#newReportId').val(), 
					targetId:$('#editTargetReportId').val(),
					empCode:$('#hiddenEcode').val()};
	
			var finalData = {info:info, data:data};
			$.ajax({
				headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
				}, type:'POST', url:"/AdminModule/createTargetReport", dataType: "json", data:JSON.stringify(finalData),
				success:function(result){
					if (undefined != result.data.id && '' != result.data.id)  {
						$('#completeTargetDiv').removeClass('hidden');
						$('#createTargetDiv').addClass('hidden');
	
						fetchCompleteReportDetails($('#newReportId').val(), true);
					}
				}
			});
		}
	}
	
	function fetchGenerateReportRegionList(eCode) {
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		//var data = {empCode:$('#hiddenEcode').val()};
		var data = {empCode:eCode};
		var finalData = {info:info, data:data};
		var optionList = '';
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json'  , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', 
			async:false,
			url:"/AdminModule/assignedReportList", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
	//			console.log(result);
				if(undefined != result && undefined != result.data){
					
					$.map(result.data.assignReport,function(item){
						optionList += '<option value="'+item.reportId+'">'+item.reportName+'</option>';
					});
					
				}
			}
		});
		$('#generateReportRegionListDiv').html('<select id="generateReportRegionList" required>' + optionList + '</select>');
		$('#generateReportRegionList').searchableSelect();
		$('#generateReportTypeDIV').html("<select id='generateReportTypeId' required><option value=''>Select User Role</option><option value='1'>Compiled Report</option><option value='2'>Date wise Report</option></select>");
		$('#generateReportTypeId').searchableSelect();
		$("#generateReportMonthId").AnyPicker("destroy");
		$("#generateReportMonthId").AnyPicker({mode: "datetime", showComponentLabel: true, dateTimeFormat: "yyyy-MM-dd", 
			viewSections:{header: [],contentTop: [],contentBottom: [],footer: ["cancelButton", "setButton"]},
			onChange: function(iRow, iComp, oSelectedValues){ console.log("Changed Value : " + iRow + " " + iComp + " " + oSelectedValues); }});
	}
	
	function generateCompiledDetail() {
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#hiddenEcode').val(), date:$('#generateReportMonthId').val(), 
				reportType:$('#generateReportTypeId').val(), reportId:$('#generateReportRegionList').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/getCompiledReport", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				console.log(result);
				if (undefined != result && undefined != result.data){
					$('#generateReportNotFoundId').addClass('hidden');
					$('#generateReport').addClass('hidden');
					$('#generateCompleteReport').removeClass('hidden');
					$('#generateCompiledReportDiv').html('');
					$('#generateCompiledReportDiv').html('<tr><th data-th="Region">Region</th><th data-th="Month">Month</th><th data-th="NOM">NOM</th><th data-th="UOM">UOM</th><th data-th="ADC">ADC</th><th data-th="BCS">BCS</th><th data-th="Total">Total</th><th data-th="Achieved %">Achieved %</th></tr>');
					var html = '';
					var grandTotal = result.data.total;
					var grandNomDisbursement = result.data.nomDisbursement;
					var grandUomDisbursement = result.data.uomDisbursement;
					var grandAdcDisbursement =result.data.adcDisbursement;
					var grandBcsDisbursement = result.data.bcsDisbursement;
					//html += '<ul>'; 
					console.log(result.data.compiledDisbursementReport);
					$.map(result.data.compiledDisbursementReport, function(item){
						
						/*grandTotal += parseFloat(item.total);
						grandNomDisbursement += parseFloat(item.nomDisbursement);
						grandUomDisbursement += parseFloat(item.uomDisbursement);
						grandAdcDisbursement += parseFloat(item.adcDisbursement);
						grandBcsDisbursement += parseFloat(item.bcsDisbursement);*/
						/*html += '<ul><li>'+item.region+'</li><li>'+item.date+'</li><li><i class="fa fa-inr" aria-hidden="true"></i> '+item.nomDisbursement+''+
						'cr.</li><li><i class="fa fa-inr" aria-hidden="true"></i> '+item.uomDisbursement+'cr.</li><li><i class="fa fa-inr" aria-hidden="true"></i> '+item.adcDisbursement+''+
						'cr.</li><li><i class="fa fa-inr" aria-hidden="true"></i> '+item.bcsDisbursement+'cr.</li><li><i class="fa fa-inr" aria-hidden="true"></i> '+item.total+'cr.</li><li>'+item.acheivedPerc+'%</li></ul>';*/
						
						html += '<tr><td data-th="Region">'+item.region+'</td><td data-th="Month">'+item.date+'</td><td data-th="NOM">'+item.nomDisbursement+
						'cr.</td><td data-th="UOM">'+item.uomDisbursement+'cr.</td><td data-th="ADC">'+item.adcDisbursement+
						'cr.</td><td data-th="BCS">'+item.bcsDisbursement+'cr.</td><td data-th="Total">'+item.total+
						'cr.</td><td data-th="Achieved %">'+item.acheivedPerc+'%</td></tr>';
						
					});
					//html += '</ul>';
					
					$('#generateCompiledReportDiv').append(html);
					/*$('#generateCompiledReportDiv').append('<div class="unit-show" style="background-color:#d0ddf2; font-weight:600;"><div class="deta-list">'+
							'<ul><li>Grand Total</li><li>&nbsp;</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+grandNomDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+grandUomDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+grandAdcDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+grandBcsDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+grandTotal+' cr.</li></ul></div></div>');*/
					
					$('#generateCompiledReportDiv').append('<tr><th data-th="Region">Grand Total</th><th>&nbsp;</th>'+
			                '<th data-th="NOM"><i class="fa fa-inr" aria-hidden="true"></i>'+grandNomDisbursement+' cr.</th>'+
			                '<th data-th="UOM"><i class="fa fa-inr" aria-hidden="true"></i>'+grandUomDisbursement+' cr.</th>'+
			                '<th data-th="ADC"><i class="fa fa-inr" aria-hidden="true"></i>'+grandAdcDisbursement+' cr.</th>'+
			                '<th data-th="BCS"><i class="fa fa-inr" aria-hidden="true"></i>'+grandBcsDisbursement+' cr.</th>'+
			                '<th data-th="Total"><i class="fa fa-inr" aria-hidden="true"></i>'+grandTotal+' cr.</th></tr>');
				} else {
					$('#generateReportNotFoundId').removeClass('hidden');
				}
			} 
		});
	}
	
	function cancelGenerateCompiledDetail() {
		$('#generateReport').addClass('hidden');
	}
	
	function dataModelPopup() {
		$('#addNewEmployeeFRId').removeClass('hidden');
		
		var Modal = (function() {
			var modalOpen = $('.data-modal-open'),
			modalClose = $('.data-modal-close');
			// modalWrapper = $('.data-modal-wrapper');
			//console.log(modalOpen);
			return {
				init: function() {
					this.abrir();
					this.fechar();
				},
	
				abrir: function() {
					/* modalOpen.onclick = function(e) {
			            e.preventDefault;
			              modalWrapper.classList.add("modal-opened");
			          }*/
					$.each(modalOpen,function(e){
						$(this).click(function(){
							e.preventDefault;
							$('#'+$(this).attr('popup')).addClass("modal-opened");
							//console.log($('#'+$(this).attr('popup')));
						});
					});
				},
	
				fechar: function() {
					/* modalClose.onclick = function(e) {
			              e.preventDefault;
			              modalWrapper.classList.remove("modal-opened");
			            }*/
					$.each(modalClose,function(e){
						$(this).click(function(){  
							e.preventDefault;
							// console.log( $(this).parents('.modal-wrapper'));
							$(this).parents('.modal-wrapper').removeClass("modal-opened");
						});
					});
				}
			}
		}());
		Modal.init();
		
		$(".creatform").click(function(){
			$(".showform").slideToggle('slow');
		});
	
		$(".gettarget").click(function(){
			$(".target-amount").slideDown('slow');
		});
	}
	
	function searchReportEmployee() {
		if (undefined != $('#searchedEmpId').val()) {
			var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
			var data = {empCode:$('#searchedEmpId').val(), loginEmpCode:$('#hiddenEcode').val()};
			var finalData = {info:info, data:data};
			$.ajax({
				headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
				}, type:'POST', url:"/AdminModule/searchEmpDetail", dataType: "json", data:JSON.stringify(finalData),async:false,
				success:function(result){
					console.log(result);
					
					fetchDepartmentList();
					getBranchList();

					if (undefined != result && undefined != result.data){
						
						$('#searchedEmpName').val(result.data.name);
	
						$('#searchedEmpCode').val(result.data.empCode);
						$('#searchedEmpDesig').val(result.data.designation);
	
						$('#searchedEmpEmail').val(result.data.email);
						$('#searchedEmpMobile').val(result.data.mobile);
	
						//$('#searchedEmpDept').val(result.data.department);
						
						
						
						$('#searchedEmpCity').val(result.data.city);
	
						$('#searchedEmpRMId').val(result.data.reportingManaer);
						$('#searchedEmpRMEcode').val(result.data.reportingManagerEmp);
						
						/*$('#searchedEmpBREcode').val(result.data.branchCode);
						$('#searchedEmpBRName').val(result.data.branchName);*/
						
						// Set Department name										
						if(result.data.departmentId == undefined || result.data.departmentId=="" || result.data.departmentId==null){
							$('#departmentTag').val("all");	
						}
						else{
							$('#departmentTag').val(result.data.departmentId);						
						}
						// Set branch name				
						if(result.data.branchId == undefined || result.data.branchId=="" || result.data.branchId==null){
							$('#branchlist').val("all");					
						}
						else{
							$('#branchlist').val(result.data.branchId);
						}
						
						$('#addReportEmpButtonId').removeClass('hidden');
						$('#createReportEmpButtonId').addClass('hidden');
						
						//$('#createNewUserButtonId').addClass('hidden');
						$('#searchedEmpDetailNotFoundId').addClass('hidden');
						$(".showCheckDetailform").slideToggle('slow');
					} else {
						$('#searchedEmpDetailNotFoundId').removeClass('hidden');
						$('#createEmpDetailNotFoundId').removeClass('hidden');
						
						$('#createReportEmpButtonId').removeClass('hidden');
						//$('#createNewUserButtonId').removeClass('hidden');
						$('#searchedEmpDetailEnteredId').addClass('hidden');
						$(".showCheckDetailform").slideToggle('slow');
						
						$('#addReportEmpButtonId').addClass('hidden');
						$('#createReportEmpButtonId').removeClass('hidden');
						$('#addEmpDetailEnteredId').addClass('hidden');
						
						resetForm('createNewUserFromReportId');
					} 
				} 
			});
		}
	}
	
	function addReportInEmployee() {
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {name:null, empCode:$('#searchedEmpCode').val(), 
				designation:null,  email:null, 
				mobile:null, department:null, 
				city:null, reportingManager:null, 
				reportingManagerEmp:null, 
				branchCode:null,
				branchName:null,
				loginEmpCode:$('#hiddenEcode').val(), 
				region:$('#regionList').val(),
				reportId:$('#newReportId').val(),
				branchId: $("#branchlist option:selected").val(),
				departmentId: $("#departmentTag option:selected").val()};
	
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/createRequestUser", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				if (undefined != result.data)  {
					$('#addReportEmpButtonId').removeClass('hidden');
					$('#createReportEmpButtonId').addClass('hidden');
					$('#addEmpDetailEnteredId').removeClass('hidden');
					
					$('#searchedEmpMessageId').html(result.data.msg);
					
					$(".showCheckDetailform").slideToggle('slow');
					fetchRegionList();
				}
			}
		});
	}
	
	function CreateNewUserInReport() {
		var form = $( "#createNewUserFromReportId" );
		var validate=form.validate();
		if (validate.form())  {
			var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
			var data = {name:$('#searchedEmpName').val(), empCode:$('#searchedEmpCode').val(), 
					designation:$('#searchedEmpDesig').val(),  email:$('#searchedEmpEmail').val(), 
					mobile:$('#searchedEmpMobile').val(), department:$('#searchedEmpDept').val(), 
					city:$('#searchedEmpCity').val(), reportingManager:$('#searchedEmpRMId').val(), 
					reportingManagerEmp:$('#searchedEmpRMEcode').val(), 
					branchCode:$('#searchedEmpBREcode').val(),
					branchName:$('#searchedEmpBRName').val(), 
					region:$('#regionList').val(),
					reportId:0};
	
			var finalData = {info:info, data:data};
			$.ajax({
				headers: {'Accept': 'application/json', 'Content-Type': 'application/json' 
				}, type:'POST', url:"/AdminModule/createRequestUser", dataType: "json", data:JSON.stringify(finalData),
				success:function(result){
					if (undefined != result.data)  {
						//$('#addNewEmployeeFRId').addClass('hidden');
						$('#searchedEmpDetailNotFoundId').addClass('hidden');
						$('#searchedEmpDetailEnteredId').removeClass('hidden');
						$(".showform").slideToggle('slow');
						resetForm('createNewUserFromReportId');
					}
				}
			});
		}
	}
	
	function generateExcel() {
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {eCode:$('#hiddenEcode').val(), date:$('#generateReportMonthId').val(), type:$('#generateReportTypeId').val(),  reportId:$('#generateReportRegionList').val()};
	
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/downCompleteReport", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				var typeInt = parseInt($('#generateReportTypeId').val());
				console.log(typeInt);
				if (undefined != result.data)  {
					var data1 = {eCode:result.data.encEcode, date:$('#generateReportMonthId').val(), 
							reportId:result.data.encReportId, type:typeInt};
					var finalData1 = {data:data1};
					var generateDate = $('#generateReportMonthId').val();
					var xhttp = new XMLHttpRequest();
					xhttp.onreadystatechange = function() {
						var a;
						if (xhttp.readyState === 4 && xhttp.status === 200) {
							// Trick for making downloadable link
							a = document.createElement('a');
							//console.log(xhttp);
							a.href = xhttp.response;
							if(typeInt == 1)
								a.download = "compiled_"+generateDate+"_"+formatDate(new Date())+".zip";
							else
								a.download = "date_"+generateDate+"_"+formatDate(new Date())+".zip";
							a.style.display = 'none';
							document.body.appendChild(a);
							a.click();
						}
					};
					// Post data to URL which handles post request
					xhttp.open("POST", "/DailyReportingNew/frontEndWeb/generateExcel");
					xhttp.setRequestHeader("Content-Type", "application/json");
					// You should set responseType as blob for binary responses
					//xhttp.responseType = 'blob';
					xhttp.send(JSON.stringify(finalData1));
				} 
			}
		});
	}
	
	function formatDate(date) {
		var d = new Date(date),
		month = '' + (d.getMonth() + 1),
		day = '' + d.getDate(),
		year = d.getFullYear();
	
		if (month.length < 2) month = '0' + month;
		if (day.length < 2) day = '0' + day;
	
		return [year, month, day].join('-');
	}
	
	function showeLearningReportType(){
		var target = $('input[name="reportTyperadio"]:checked').val();
		$('#singleeLearningReportDate').hide();
		$('#multipleeLearningReportDate').hide();
		$('#reportFooter').hide();
		$('#eLearning-report-download-link').attr('href','');
		$('#downloadButton').hide();
		$('#submiteLearningReport').show();
		$('#dateReportFrom').val('');
		$('#dateReportTo').val('');
		$('#bydate').val('');
		$('#categoryTag').html('');
		if (target == 'Single') {
			$('#singleeLearningReportDate').show();
			$('#reportFooter').show();
			$('#categoryeLearningReport').hide();
		}
		else if(target == 'Multiple'){
			$('.input-daterange input').each(function() {
				$(this).datepicker("clearDates");
			});
			
			$('#multipleeLearningReportDate').show();
			$('#reportFooter').show();
			$('#singleeLearningReportDate').hide();
			$('#categoryeLearningReport').hide();
		}
		else if(target == 'category'){
			fetcheLearningReportCategory();
		}
	}
	
	/*function fetchSingleReportDates(){
		$.ajax({
			url: "/AdminModule/fetchSingleReportDates",
			type: 'POST',
			//async:false,
			//dataType: 'JSON',
			success:function(data){
				//console.log(data);
				$('#reportDateTag').html('');
				$.map(data,function(item){
					$('#reportDateTag').append('<option value="'+item+'">'+item+'</option>');
				});
				$('#singleReportDate').removeClass('hidden');
				$('#reportFooter').removeClass('hidden');
			}
		});
	}*/
	
	var category="";
	function fetcheLearningReportCategory(){
		if(category!=""){
			$('#categoryTag').append(category);
			$('#categoryeLearningReport').show();
			$('#reportFooter').show();
		}	
		else{		

			$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
			$('#wait').show();
			$.ajax({
				url: "/AdminModule/fetcheLearningReportCat",
				type: 'POST',
				//async:false,
				//dataType: 'JSON',
				success:function(data){
					$('#wait').hide();
					$('#categoryTag').html('');
					$.map(data,function(item){
						category=category+'<option value="'+item+'">'+item+'</option>';
					});
					$('#categoryTag').append(category);
					$('#categoryeLearningReport').show();
					$('#reportFooter').show();
				}
			});
		}	
	}
	
	function submiteLearningReport() {

		var dateSelected="";
		var categorySelected="";
		var parameter;
		$("#elearning-excel-download-link" ).hide();
		var target = $('input[name="reportTyperadio"]:checked').val();

		if(target == 'Single'){
			categorySelected='';
			dateSelected= $('#bydate').val();
			
			if(dateSelected == null || typeof dateSelected === "undefined" || dateSelected =='')
	    	{
	    		 modalAlertToShowCustomMessage("Date not selected", 'warning');
	    		 return false;
	    	}
		}
		else if(target == 'Multiple'){
			categorySelected='';
			
			var formDate=$('#dateReportFrom').val();
	    	var toDate =$('#dateReportTo').val();
	    	
	    	if(formDate==null || formDate=='')
	    	{
	    		 modalAlertToShowCustomMessage("From Date not selected", 'warning');
	    		 return false;
	    	}
	    	
	    	if(toDate==null || toDate=='')
	    	{
	    		 modalAlertToShowCustomMessage("To Date not selected", 'warning');
	    		 return false;
	    	}
	    	
	    	
	    	if(new Date(formDate) > new Date(toDate))
	    	{
	    		 modalAlertToShowCustomMessage("To Date greater than from date", 'warning');
	    		 return false;
	    	}	
	    	
	    	dateSelected= formDate+"~"+toDate;
			
		}
		else if(target == 'category'){
			dateSelected='';
			categorySelected=$('#categoryTag').val();
			
			if(categorySelected == null || typeof categorySelected === "undefined" || categorySelected =='')
	    	{
	    		 modalAlertToShowCustomMessage("Category not selected", 'warning');
	    		 return false;
	    	}
			
		}
		parameter = 'date='+dateSelected+'&category='+categorySelected;
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('eLearningReport', parameter);
		if(null != response && response != ""){
			resetForm('showELearningReportDiv');
			var download = document.getElementById('eLearning-report-download-link');
			download.setAttribute('href', response);
			download.setAttribute('download', 'LogFile.xlsx');
			$("#elearning-excel-download-link" ).show();
			modalAlertToShowCustomMessage("Report successfully generated. Please click on download button.", 'success');
		}
		else{
			modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');	
		}
	}
	
	
	function getELearningCertificate() {
		var ecode = $.trim($('#eLearningCertificateEcode').val());
		var moduleId = $('#eLearningCertificateModule').val();
		var moduleValue = $("#eLearningCertificateModule option:selected").text();
		if (ecode !='' && moduleId != '' && moduleValue!= '' && moduleValue !== 'Select Module') {
			var parameter ='ecode='+ecode+'&moduleName='+encodeURIComponent(moduleValue)+'&moduleId='+moduleId;
			$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
			var response = makeAjaxCall("getELearningCertificate",parameter);
			if(response!=null && response!=""){
				resetForm('eLearningCertificate');
				window.open(response);
			}
			else
			    modalAlertToShowCustomMessage("Please Enter Valid Ecode", 'warning');
		}else {
			modalAlertToShowCustomMessage("Please Select All Fields", 'warning');
		}
	}
	
	function eLearningCertificateModule() {
		$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall("getELearningModule",null);
		$.each($.parseJSON(response), function(i, item) {
			$('#eLearningCertificateModule').append('<option value="'+item.id+'">'+item.name+'</option>');
		});
	}
	function checkDec(el){
		 var ex = /^[0-9]+\.?[0-9]*$/;
		 if(ex.test(el.value)==false){
		   el.value = el.value.substring(0,el.value.length - 1);
		  }
		}
	function submitPDDReassignment(formParentDivID) {
	
		$( "#downloadButtonDiv" ).hide();
		var reasgnType= $('input[name="reasgnType"]:checked').val();
		var eCodeType= $('input[name="eCodeType"]:checked').val();
		if(((reasgnType=='los' && $.trim($('#losCode').val())!='') || (reasgnType!='los' && $.trim($('#losCode').val())=='') ) && $.trim($('#currentCode').val())!='' && $.trim($('#newCode').val())!='')
		{
			swal({
		        title: "Are you sure?",
		        text: "Do you want to reassign leads?",
		        type: "warning",
		        showCancelButton: true,
		        confirmButtonColor: '#DD6B55',
		        confirmButtonText: 'Yes, I am sure!',
		        cancelButtonText: "No, cancel it!",
		        closeOnConfirm: true,
		        closeOnCancel: false
			}).then(function(isConfirm) {
				
				$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
				$('#wait').show();
				SubForm($('#reassignForm'),submitPDDReassignmentResponse)
			});
		}
		else{
			modalAlertToShowCustomMessage("Please enter values in all fields.", 'warning');
		}			
		 
	}
	function submitPDDReassignmentResponse(response) {
	 		//alert("hello");
		$('#wait').hide();
		var data = JSON.parse(response);
		//alert(data.status);
		if (data.status == "success") {
			resetFormPddReassign('reassignForm');
			var download = document.getElementById('pdd-reassignment-download-link');
			download.setAttribute('href', data.url);
			download.setAttribute('download', 'LogFile.xlsx');
			$( "#downloadButtonDiv" ).show();
			modalAlertToShowCustomMessage('Lead reassigned. Please click on download button for details.', 'success');
	
		} else {
			modalAlertToShowCustomMessage(data.status, 'error');
		}
	
	
	}
	
	function hideShow(id)
	{
		if(id!=null && undefined != id ){
			
			var target= $('input[name="reportType"]:checked').val();
			if(target=='dateRange')
				$('#dateRangeDiv').show();
			else
				$('#dateRangeDiv').hide();
		}
		else
		{	
			var losCode=$('#losCode').val();

			if(losCode!=null && losCode!='')
				$('#losCode').val('');

			var target= $('input[name="reasgnType"]:checked').val();
			if(target=="los"){
				$('#losCodeDiv').show();
			}
			else{
				$('#losCodeDiv').hide();
			}

		} 
	}
	
	function submitNotificationReport(formParentDivID) {
	
	    var dateSelected="";
	    var textSelected="";
	    var parameter;
	    var target = $('input[name="reportTyperadio"]:checked').val();
	    if(target == 'Single'){
	    	textSelected='';
	    	dateSelected= $('#reportDateTagNotification').val();
	    	
	    }
	    else if(target == 'Text'){
	    	dateSelected='';
	    	textSelected=$('#notiText').val();
	    }
	   // parameter = 'date='+$('#showPDDReportDiv .date > .form-control').val();
	    parameter = 'date='+dateSelected+'&text='+textSelected;
	    $.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
		var response = makeAjaxCall('notificationReport',parameter);
		
		if(null != response && response != "" && response == "No Record Found")
			modalAlertToShowCustomMessage("No Records found For selected criteria.Please try again.", 'warning');
		else if(null != response && response != ""){
			var download = document.getElementById('notification-report-download-link');
			download.setAttribute('href', response);
			download.setAttribute('download', 'LogFile.xlsx');
			$( "#downloadButton" ).show();
			modalAlertToShowCustomMessage("Report successfully generated. Please click on download button.", 'success');
		}
		else{
			 modalAlertToShowCustomMessage("No Report Generated For selected criteria.Please try again.", 'warning');	
		}
	       
	}
	function showNotificationReportType(){
		var target = $('input[name="reportTyperadio"]:checked').val();
		$('#reportDate').hide();
		$('#notificationText').hide();
		$('#notification-report-download-link').attr('href','');
		$('#notification-report-download-link').addClass('hidden');
		$('#submitNotificationReport').show();
		if (target == 'Single') {
			$('#reportDateTagNotification').val('');
			$('#reportDate').show();
		}
		else if(target == 'Text'){
			$('#notiText').val('');
			$('#notificationText').show();
		}
		
	}
	
	function fetchReportCreatorData(){
		var html="";
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {eCode:$('#hiddenEcode').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
			url: "/AdminModule/fetchReportCreatorEcodes",
			type: 'POST',
			dataType: "json",
			data:JSON.stringify(finalData),
			async:false,
			//dataType: 'JSON',
			success:function(response){
				console.log("response:: "+response);
				if(undefined != response && undefined != response.data && undefined != response.data.userInfo && response.data.userInfo.length> 0){
					$('#dailyReportsDiv #mylist').html('');
					$('#dailyReportsDiv #myPager').html('');
					$('#dailyReportsDiv #total_reg').html('');
				$.map(response.data.userInfo,function(item){
					var length =0;
					
					var info1 = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
					var data1 = {empCode:item.eCode};
					var finalData1 = {info:info1, data:data1};
					$.ajax({
						headers: {'Accept': 'application/json', 'Content-Type': 'application/json' 
						}, type:'POST', url:"/AdminModule/reportAssignedBY", dataType: "json", data:JSON.stringify(finalData1),
						async:false,
						success:function(result){
							var newHtml='';
							if(undefined != result && undefined != result.data && undefined != result.data.assignReport){
								length = result.data.assignReport.length;
							}
							html+='<div class="unit-show"> <div class="collapse-new report-list"><div class="deta-list member-bg"><ul><li>'+item.userName+'</li><li>&nbsp;</li><li>E-Code : '+item.eCode+'</li><li>No of Reports : '+length+'</li></ul></div><span class="collapse-heading"></span> <div class="collapse-iner">';
							if(undefined != result && undefined != result.data && undefined != result.data.assignReport){
								
								var i=0;
								//var classCss='blue';
								$.map(result.data.assignReport,function(item){
									
									/*if(i%3 == 1){
										classCss ='yellow';
									}
									else if(i%3 == 2){
										classCss ='purpel';
									}*/
								    var res = item.reportName.replace(/'/g, "\\'");
								    newHtml+='<div class="deta-list"><ul><li>'+item.reportName+'</li>'
								        +'<li>'+item.createdOn+'</li><li>Cut of Time : '+item.cutOffTime+'</li><li></li><span class="view-sec"><a id="'+item.reportId+'"onclick="fetchCompleteReportDetailsForSenior('+item.reportId+')">View <i class="fa fa-eye" aria-hidden="true"></i></a></span></ul></div>';
								    i=i+1;
								});
								
								}
							else{
								newHtml+='<div class="deta-list">No Reports Available</div>';
							}
							newHtml+='</div></div></div>';
							if(undefined != newHtml)
							html+=newHtml;
							
						}
					});
				});
				$('#dailyReportsDiv #mylist').append(html);
				$('#dailyReportsDiv .collapse-heading').addClass('fechado');
				var $active = null;
				$('#dailyReportsDiv .collapse-heading').off('click');
				$('#dailyReportsDiv .collapse-heading').on('click',function(){
	
				  if ($active !== null){
				    $active.next().slideToggle("fast");
				    $active.removeClass('aberto');
				    $active.addClass('fechado');
				  } 
				  
				  $active = $(this);
				  $active.addClass('aberto');
				  $next = $active.next();
				  
				  if ($next.is(":hidden")){
				    $next.slideToggle("fast");
				  }else{
				    $active.removeClass('aberto');
				    $active.addClass('fechado');
				    $active = null;     
				  }
				  
				});
				$('#dailyReportsDiv #mylist').pageMe({
			          pagerSelector:'#dailyReportsDiv #myPager',
			          activeColor: 'blue',
			          prevText:'Prev',
			          nextText:'Next',
			          showPrevNext:true,
			          hidePageNumbers:false,
			          perPage:6
			        });
			
			}
			}
		});
	}
	function fetchCompleteReportDetailsForSenior(el){
	//	var reportId = $(el).attr('id');
		var reportId = el;
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {reportId:parseInt(reportId)};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/completeTargetReport", dataType: "json", data:JSON.stringify(finalData),
			success:function(result){
				console.log(result);
				
					$('#regionWiseDiv').html('');
					$('#completeCreateReportNameTargetId').html(result.data.reportName);
					if (undefined != result && undefined != result.data && result.data.regionWiseData.length != 0){
					$.map(result.data.regionWiseData,function(item){
						$('#completeCreateReportNameTargetId').html(item.reportName);
						var html ='<div class="collapse-new"><div class="deta-list"><ul><li>'+item.region+'</li>'+ 
						'<li>&nbsp;</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.nomTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.uomTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.adcTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.bcsTotalDisbursement+' cr.</li>'+
						'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item.totalDisbursement+' cr.</li></ul></div>'+
						'<span class="collapse-heading"></span><div class="collapse-iner">';

						$.map(item.assignedTargetData,function(item1){
							html+='<div class="deta-list collapsemater"><ul><li><i class="fa fa-user" aria-hidden="true"></i>'+
							'<span>'+item1.name+'</span></li>'+
							'<li>'+item1.month+'</li><li>'+
							'<i class="fa fa-inr" aria-hidden="true"></i>'+item1.nomDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.uomDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.adcDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.bcsDisbursement+' cr.</li>'+
							'<li><i class="fa fa-inr" aria-hidden="true"></i>'+item1.totalDisbursement+' cr.</li>'+
							'<li></li>';
							html+='</ul></div>';
						});
						//html+="</div></div>";
						$('#regionWiseDiv').append(html);
					});
					
	
			} 
					$('#regionWiseDiv').append('<div class="unit-show" style="background-color:#d0ddf2; font-weight:600;"><div class="deta-list"><ul><li>Grand Total</li><li>&nbsp;</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandNomDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandUomDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandAdcDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandBcsDisbursement+' cr.</li>'+
			                '<li><i class="fa fa-inr" aria-hidden="true"></i>'+result.data.grandDisbursement+' cr.</li></ul></div></div>');
					
							
							$('#completeTargetDiv .collapse-heading').addClass('fechado');
							var $active = null;
							$('#completeTargetDiv .collapse-heading').off('click');
							$('#completeTargetDiv .collapse-heading').on('click',function(){
			
								if ($active !== null){
									$active.next().slideToggle("fast");
									$active.removeClass('aberto');
									$active.addClass('fechado');
								} 
			
								$active = $(this);
								$active.addClass('aberto');
								$next = $active.next();
			
								if ($next.is(":hidden")){
									$next.slideToggle("fast");
								}else{
									$active.removeClass('aberto');
									$active.addClass('fechado');
									$active = null;     
								}
			
							});
							$('#setTargetReport').addClass('hidden');
							$('#dailyReportsDiv').addClass('hidden');
							$('#completeCreateTargetId').addClass('hidden');
							$('#completeTargetDiv').removeClass('hidden');
			}
		});
	}
	
	function fetchGenerateReportCreatorList() {
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {eCode:$('#hiddenEcode').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()
			}, type:'POST', url:"/AdminModule/fetchReportCreatorEcodes", dataType: "json", data:JSON.stringify(finalData),async:false,
			success:function(response){
				//console.log(response);
				if(undefined != response && undefined != response.data && undefined != response.data.userInfo && response.data.userInfo.length> 0){
					$('#generateReportCreatorDiv').html('');
					var optionList = '';
					$.map(response.data.userInfo,function(item){
						optionList += '<option value="'+item.employeeCode+'">'+item.userName+'</option>';
					});
					$('#generateReportCreatorDiv').append('<select id="generateReportEcodeList" class="custome-select" required>' + optionList + '</select>');
					$( '#generateReportEcodeList' ).off('change');
					$( '#generateReportEcodeList' ).on('change', function() {
						fetchGenerateReportRegionList(this.value);
					});
					$( '#generateReportEcodeList option:first').attr('selected','selected');
					$( '#generateReportEcodeList' ).trigger('change');
					//$('#generateReportCreatorDiv').searchableSelect();
				}
			}
		});
	}
	
	function searchDailyReport(){
		if(undefined != $('#searchByTxt').val()){
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {empCode:$('#searchByTxt').val()};
		var finalData = {info:info, data:data};
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' 
			}, type:'POST', url:"/AdminModule/reportAssignedBY", dataType: "json", data:JSON.stringify(finalData),
			async:false,
			success:function(result){
				var newHtml='';
				var html='';
				$('#dailyReportsDiv #mylist').html('');
				$('#dailyReportsDiv #myPager').html('');
				$('#dailyReportsDiv #total_reg').html('');
				if(undefined != result && undefined != result.data){
					var length=0;
					if(undefined != result.data.assignReport && result.data.assignReport.length>0){
						length=result.data.assignReport.length;
					}
					html+='<div class="unit-show"> <div class="collapse-new report-list"><div class="deta-list member-bg"><ul><li>'+result.data.username+'</li><li>&nbsp;</li><li>E-Code : '+result.data.eCode+'</li><li>No of Reports : '+length+'</li></ul></div><span class="collapse-heading"></span> <div class="collapse-iner">';
					if(undefined != result.data.assignReport && result.data.assignReport.length>0){
						var i=0;
						//var classCss='blue';
						$.map(result.data.assignReport,function(item){
							
							/*if(i%3 == 1){
								classCss ='yellow';
							}
							else if(i%3 == 2){
								classCss ='purpel';
							}*/
							var res = item.reportName.replace(/'/g, "\\'");
							newHtml+='<div class="deta-list"><ul><li>'+item.reportName+'</li>'
							+'<li>'+item.createdOn+'</li><li>Cut of Time : '+item.cutOffTime+'</li><li></li><span class="view-sec"><a id="'+item.reportId+'"onclick="fetchCompleteReportDetailsForSenior('+item.reportId+')">View <i class="fa fa-eye" aria-hidden="true"></i></a></span></ul></div>';
							i=i+1;
						});
	
					}
					else{
						newHtml+='<div class="deta-list">No Reports Available</div>';
					}
					newHtml+='</div></div></div>';
					if(undefined != newHtml)
						html+=newHtml;
	
					$('#dailyReportsDiv #mylist').append(html);
					$('#dailyReportsDiv .collapse-heading').addClass('fechado');
					var $active = null;
					$('#dailyReportsDiv .collapse-heading').off('click');
					$('#dailyReportsDiv .collapse-heading').on('click',function(){
	
						if ($active !== null){
							$active.next().slideToggle("fast");
							$active.removeClass('aberto');
							$active.addClass('fechado');
						} 
	
						$active = $(this);
						$active.addClass('aberto');
						$next = $active.next();
	
						if ($next.is(":hidden")){
							$next.slideToggle("fast");
						}else{
							$active.removeClass('aberto');
							$active.addClass('fechado');
							$active = null;     
						}
	
					});
					$('#dailyReportsDiv #mylist').pageMe({
						pagerSelector:'#dailyReportsDiv #myPager',
						activeColor: 'blue',
						prevText:'Prev',
						nextText:'Next',
						showPrevNext:true,
						hidePageNumbers:false,
						perPage:6
					});
				}
				else{
					searchByReportName();
				}
				}
			});
		}
		else{
			fetchReportCreatorData();
		}
	}
	
	function searchByReportName(){
		var info = {appVersion:'', serverSyncTime:'', deviceId:'', sessionId:''};
		var data = {reportName:$('#searchByTxt').val()};
		var finalData = {info:info, data:data};
		var html='';
		$.ajax({
			headers: {'Accept': 'application/json', 'Content-Type': 'application/json' 
			}, type:'POST', url:"/AdminModule/searchReportBasisName", dataType: "json", data:JSON.stringify(finalData),
			success:function(response){
	//			console.log(result);
				$('#dailyReportsDiv #mylist').html('');
				$('#dailyReportsDiv #myPager').html('');
				$('#dailyReportsDiv #total_reg').html('');
				if(undefined != response && undefined != response.data && undefined != response.data.seniorReportViews && response.data.seniorReportViews.length> 0){
	
					
				$.map(response.data.seniorReportViews,function(item){
					var length=0;
					if(undefined != item.reports){
						length=item.reports.length;
					}
					html+='<div class="unit-show"> <div class="collapse-new report-list"><div class="deta-list member-bg"><ul><li>'+item.username+'</li><li>&nbsp;</li><li>E-Code : '+item.eCode+'</li><li>No of Reports : '+length+'</li></ul></div><span class="collapse-heading"></span> <div class="collapse-iner">';
					var newHtml='';
					if(undefined != item.reports){
								
								var i=0;
								//var classCss='blue';
								$.map(item.reports,function(item1){
								/*	if(i%3 == 1){
										classCss ='yellow';
									}
									else if(i%3 == 2){
										classCss ='purpel';
									}*/
								    var res = item1.reportName.replace(/'/g, "\\'");
								    newHtml+='<div class="deta-list"><ul><li>'+item1.reportName+'</li>'
								        +'<li>'+item1.created_on+'</li><li>Cut of Time : '+item1.cutOffTime+'</li><li></li><span class="view-sec"><a id="'+item1.reportId+'"onclick="fetchCompleteReportDetailsForSenior('+item1.reportId+')">View <i class="fa fa-eye" aria-hidden="true"></i></a></span></ul></div>';
								    i=i+1;
								});
								
								}
							else{
								newHtml+='<div class="deta-list">No Reports Available</div>';
							}
							newHtml+='</div></div></div>';
							if(undefined != newHtml)
							html+=newHtml;
				});		
				$('#dailyReportsDiv #mylist').append(html);
				$('#dailyReportsDiv .collapse-heading').addClass('fechado');
				var $active = null;
				$('#dailyReportsDiv .collapse-heading').off('click');
				$('#dailyReportsDiv .collapse-heading').on('click',function(){
	
				  if ($active !== null){
				    $active.next().slideToggle("fast");
				    $active.removeClass('aberto');
				    $active.addClass('fechado');
				  } 
				  
				  $active = $(this);
				  $active.addClass('aberto');
				  $next = $active.next();
				  
				  if ($next.is(":hidden")){
				    $next.slideToggle("fast");
				  }else{
				    $active.removeClass('aberto');
				    $active.addClass('fechado');
				    $active = null;     
				  }
				  
				});
				$('#dailyReportsDiv #mylist').pageMe({
			          pagerSelector:'#dailyReportsDiv #myPager',
			          activeColor: 'blue',
			          prevText:'Prev',
			          nextText:'Next',
			          showPrevNext:true,
			          hidePageNumbers:false,
			          perPage:6
			        });
			
			
				}
				else{
					html+='<div class="unit-show"> No Data Available';
					$('#dailyReportsDiv #mylist').append(html);
				}
			}
		});
	}
	function SubForm(e,clickHandler){
	   // e.preventDefault();
	    var url=$(e).closest('form').attr('action'),
	        data=$(e).closest('form').serialize();
	    $.ajax({
	        url:url,
	        type:'post',
	        data:data,
	        success:function(response){
	        	clickHandler.call(this,response);
	           }
	        });
	 }
	function onContainerClick (event) {
		  if(event.classList.contains('off')) {
		    event.classList.remove('off');		  
		  } else {
		    event.classList.add('off');		   
		  }
		  if($('#lockedContainer').hasClass('off')){
			  $('input[name="failedAttempts"]').val(6);
			//  $('input[name="isActive"]').val(2);
		  }
		  else{
			  $('input[name="failedAttempts"]').val(0);
			  $('input[name="isActive"]').val(true);
		  }
		  /*if($('#container').hasClass('off')){
			  $('input[name="isActive"]').val(false);
		  }
		  else{
			  $('input[name="isActive"]').val(true);
		  }
		  if($('#deleteContainer').hasClass('off')){
			  $('input[name="isDelete"]').val(true);
		  }
		  else{
			  $('input[name="isDelete"]').val(false);
		  }*/
		  
	}
	function filterRequests(type){
		if(type == 1){
			
		}
		else if(type == 2){
			
		}
	}
	
	function viewEditDetail(el){
		window.location = "/AdminModule/editUserDetail?e_code="+$(el).parents('form').find('input[name="employeeCode"]').val()+"&_csrf="+$('#csrfToken').val();
		
	}
	function viewUAMApprovalRequests(data){
		if (data.status_code == 101 || data.status_code==201) {
			modalAlertToShowCustomMessage(data.message, 'warning');
		} else if (data.status_code == 200) {
			//window.location = "/AdminModule/uamApprovalRequests?_csrf="+$('#csrfToken').val();
			resetForm('submiteditUserInfo');
			swal(
					{
						title : "Edit User",
						text : data.message,
						type : "success",
					}).then(function() {
						//location.reload();
						window.location = "/AdminModule/uamApprovalRequests?_csrf="+$('#csrfToken').val();
						
			});
		}
	}
	function saveComment(el){
		var leadid= $(el).attr('leadid');
		var comment = $(el).parent().siblings().find('input[type="text"]').val();
		if(undefined != leadid && undefined != comment && comment != ''){
			$.ajax({
				url:"/AdminModule/saveComment",
				  data:{
					  "comment":comment,
					  "leadid":leadid,
					  "_csrf":$('#csrfToken').val(),
				  },
				  type: 'POST',
				  success:function(response){
					  if (response.status_code == 101 || response.status_code==201) {
							modalAlertToShowCustomMessage(response.message, 'warning');
						} else if (response.status_code == 200) {
							//modalAlertToShowCustomMessage(response.message, 'success');
							//showAlertAndCallFunction("PDD RIC Operations",response.message,"success",location.reload());
							swal(
									{
										title : "PDD RIC Operations",
										text : response.message,
										type : "success",
									}).then(function() {
										location.reload();
										
							});
						}
				  }
			});
		}
		else{
			modalAlertToShowCustomMessage('Please enter a comment', 'warning');
		}
	}
	function updateVehicleNumber(el){
		var leadid= $(el).attr('leadid');
		var rcNo = $(el).parents('.button-box').siblings().find('input[name="vehicleNo"]').val();
		if(undefined != leadid && undefined != rcNo){
			/*var regex = /^[A-Z]{2}[ -][0-9]{1,2}(?: [A-Z])?(?: [A-Z]*)? [0-9]{4}$/i;
			var regex1 = /^[A-Z]{2}[0-9]{1,2}(?:[A-Z])?(?:[A-Z]*)?[0-9]{4}$/i;
			if(regex.test(rcNo) ||regex1.test(rcNo) ){*/
			$.ajax({
				url:"/AdminModule/updateVehicleNumber",
				  data:{
					  "rcNo":rcNo,
					  "leadid":leadid,
					  "_csrf":$('#csrfToken').val(),
				  },
				  type: 'POST',
				  success:function(response){
					  if (response.status_code == 101 || response.status_code==201) {
							modalAlertToShowCustomMessage(response.message, 'warning');
						} else if (response.status_code == 200) {
							modalAlertToShowCustomMessage(response.message, 'success');
							if(rcNo != ''){
							$(el).parent('span').hide();
							$(el).parents('.button-box').siblings().find('input[name="vehicleNo"]').addClass('dissable');
							$(el).parent().siblings('.editbtn').show();
							$(el).parent().siblings('.uploadbtn').hide();
						//	$(el).parent().siblings('.rcno-action').show();
							}
						}
				  }
			});
			/*}
			else{
				modalAlertToShowCustomMessage('Please enter a valid vehicle number', 'warning');
			}*/
		}
		else{
			modalAlertToShowCustomMessage('Please enter a vehicle number', 'warning');
		}
	}
	function editVehicleNumber(el){
		$(el).parent('span').hide();
		$(el).parents('.button-box').siblings().find('input[name="vehicleNo"]').removeClass('dissable');
		$(el).parent().siblings('.rcno-action').hide();
		$(el).parent().siblings('.savebtn').show();
		$(el).parent().siblings('.uploadbtn').show();
	}
	
	function showModal(el){
		var imgList=$(el).attr('imglist');
		var leadid= $(el).attr('leadId');
		var type= $(el).attr('type');
		var imgType = 1;
		if(undefined != leadid && leadid != ''){
			$('#myModal1 #carouselIndicator').html('');
			$('#myModal1 #carouselInner').html('');
			$('#myModal1 #carouselThumbnail').html('');
			if(null != imgList && undefined != imgList){
				$('#myModal1 #modalTitle').html($(el).siblings('a').attr('type'));
				$('#myModal1 #modalDownload').attr('href',$(el).siblings('a').attr('href'));
				if(type == '1'){
					$('#approveRejectDiv').html('<div class=rejectbtn><a id=rejectBtn aria-hidden=true><i aria-hidden=true class="fa fa-times"></i> Reject</a></div><div class=Approval><a id=approveBtn><i aria-hidden=true class="fa fa-check"></i> Approve</a></div>');
					$('#rejectBtn').off('click');
					$('#rejectBtn').on('click',function(item){
						rejectApproveDoc(leadid,$(el).siblings('a').attr('type'),1);
					});
					$('#approveBtn').off('click');
					$('#approveBtn').on('click',function(item){
						rejectApproveDoc(leadid,$(el).siblings('a').attr('type'),2);
					});
				}
				else if(type == '2' ){
					$('#approveRejectDiv').html('<div class=Approval><a><i aria-hidden=true class="fa fa-check"></i> Approved</a></div>');
				}
				else if(type == '4'){
					$('#approveRejectDiv').html('<div class=rejectbtn><a aria-hidden=true><i aria-hidden=true class="fa fa-times"></i> Rejected</a></div>');
					imgType=0;
				}
				var carousalIndicator = '';
				var carousalInner='';
				var carouselThumbnail='';
				var index=0;
				$.map($.parseJSON(imgList),function(item){
					if(imgType == item.isActive){
						if(index == 0){
							carousalIndicator+='<li data-target="#carousel-example-generic" data-slide-to="'+index+'" class="active"></li>';
							carousalInner+='<div class="item active srle"><img src="'+item.imageUrl+'" alt="'+index+'.jpg" class="img-responsive"></div>';

						}
						else{
							carousalIndicator+='<li data-target="#carousel-example-generic" data-slide-to="'+index+'"></li>';
							carousalInner+='<div class="item"><img src="'+item.imageUrl+'" alt="'+index+'.jpg" class="img-responsive"></div>';
						}
						carouselThumbnail+='<li><img src="'+item.imageUrl+'" alt="'+index+'.jpg"></li>';
						index++;
					}
				});
				if(undefined != carousalInner && carousalInner != ''){
				$('#myModal1 #carouselIndicator').html(carousalIndicator);
				$('#myModal1 #carouselInner').html(carousalInner);
				$('#myModal1 #carouselThumbnail').html(carouselThumbnail);
				}
				else{
					$('#myModal1 #carouselInner').html('No Preview available');
				}
				$('#myModal1').modal('show');
			}
			
		}
	}
	
	function rejectApproveDoc(leadid,type,flag){
		if(flag == 2){
			$('#approveReject #confirmTitle').html('Approve Documents');
			if(type =='all'){
				$('#approveReject #confirmText').html('Are you sure you want to approve all documents?');
			}
			else{
				$('#approveReject #confirmText').html('Are you sure you want to approve the document?');
			}
		}
		else if(flag == 1){
			$('#approveReject #confirmTitle').html('Reject Documents');
			if(type =='all'){
				$('#approveReject #confirmText').html('Are you sure you want to reject all documents?');
			}
			else{
				$('#approveReject #confirmText').html('Are you sure you want to reject the document?');
			}
		}
		else if(flag == 6){
			
			$('#approveReject #confirmTitle').html('ForeClose Lead');
			$('#approveReject #confirmText').html('Are you sure you want to foreclose the lead?');
			
		}
		$('#confirmYes').off('click');
		$('#confirmYes').on('click',function(item){
			if(flag == 2){
				rejectApproveDocFinal(leadid,type,flag);
			}
			else if(flag == 1 || flag == 6){
				$('#approveReject').modal('hide');
				if(flag == 1)
					$('#rejectRemark #rejectTitle').html('Reject Document');
				else 
					$('#rejectRemark #rejectTitle').html('ForeClose Lead');
				$('#rejectRemark input[type="button"][value="Yes"]').off('click');
				$('#rejectRemark input[type="button"][value="Yes"]').on('click',function(){
					if($('#remarkText').val() != undefined && $('#remarkText').val()!= ''){
						rejectApproveDocFinal(leadid,type,flag,$('#remarkText').val());
					}
				});
				$('#rejectRemark input[type="button"][value="No"]').off('click');
				$('#rejectRemark input[type="button"][value="No"]').on('click',function(){
					$('#rejectRemark').modal('hide');
				});
				$('#rejectRemark').modal('show');
				
			}
		});
		$('#confirmNo').off('click');
		$('#confirmNo').on('click',function(item){
			$('#approveReject').modal('hide');
		});
		$('#myModal1').modal('hide');
		$('#approveReject').modal('show');
		
	}
	function rejectApproveDocFinal(leadid,type,flag,remark){
		if(undefined != leadid && undefined != type){
			$.ajax({
				url:"/AdminModule/rejectApproveDoc",
				  data:{
					  "leadid":leadid,
					  "type":type,		
					  "opType":flag,
					  "remark":remark,
					  "_csrf":$('#csrfToken').val(),
				  },
				  type: 'POST',
				  success:function(response){
					  $('#myModal1').modal('hide');
					  $('#approveReject').modal('hide');
					  $('#rejectRemark').modal('hide');
					  if (response.status_code == 101 || response.status_code==201) {
							modalAlertToShowCustomMessage(response.message, 'warning');
						} else if (response.status_code == 200) {
							//modalAlertToShowCustomMessage(response.message, 'success');
							swal(
									{
										title : "PDD RIC Operations",
										text : response.message,
										type : "success",
									}).then(function() {
										location.reload();
										
							});
							//showAlertAndCallFunction("PDD RIC Operations",response.message,"success",location.reload());
						}
				  }
			})
	}
	}
	function clickOnFilter(el){
		$('.reset-btn input[type="button"]').attr("disabled", "disabled");
		$(el).parent().siblings('input[type="button"][value="Filter"]').click();
		$('.reset-btn input[type="button"]').removeAttr("disabled");
	}
	/*function showAlertAndCallFunction(title,message,type,callFunc){
		swal(
				{
					title : title,
					text : message,
					type : type,
				}).then(function() {
					//location.reload();
					callFunc.call(this,response);
					
		});
	}*/
	function setFileLabel(aId,divId,submitButtonId){ 
		
		var fileName= $("#file-1").val().replace(/.*[\/\\]/, '');
		$("#fileLabel").html(fileName);
		$(submitButtonId).show();
		var download = document.getElementById(aId);
		if(undefined != download && download.length > 0){
		download.setAttribute('href', '#');
		$( divId ).hide();	
		}
		 
	}
	
	function uploadPDFFile() {
			var formData = new FormData();
			var uploadFiles=[];
			var captions=[];
			var elements = document.getElementsByClassName('inputfile');
			
			if($("#file-1")[0].files.length > 0){
					 	var ext = $('#file-1').val().split('.').pop().toLowerCase();
						if($.inArray(ext, ['pdf']) == -1) {
							modalAlertToShowCustomMessage("Only PDF files are allowed", 'warning');
							return;
						}
				        formData.append('file', elements[0].files[0]);
			}
			else{
				modalAlertToShowCustomMessage("Please upload pdf file", 'warning');
				return;
			}
				
			
			$("#pdfUpload").submit();
	}
	
	function saveVehicleDetails() {
	     
		var dto=$('#vehicleDetailsDto').val();
			
	    swal({
	        title: "Are you sure?",
	        text: "You want to save Vehicle Details.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
		}).then(function(isConfirm) {
		        
		    	if (isConfirm) {
		    		$('#wait').show();
				$.ajax({
					url: "/AdminModule/saveVehicleDetails",
					type: 'POST',
					data:{
						  "vehicleDetailsDto":dto,
						  "_csrf":$('#csrfToken').val(),
					},
					success:function(response){ 
						  if(response==null || undefined == response)
							  modalAlertToShowCustomMessage("Oops something went wrong.Please try again.", 'warning');
						  else if (response.status == 'failure') {
							modalAlertToShowCustomMessage(response.message, 'warning');
						} else if (response.status == 'success') {
							//modalAlertToShowCustomMessage(response.message, 'success');
							swal(
									{
										title : "PDD RIC Operations",
										text : response.message,
										type : "success",
									}).then(function() {
										$('#cancelHref').get(0).click();
										
							});
							//showAlertAndCallFunction("PDD RIC Operations",response.message,"success",location.reload());
						}
						  $('#wait').hide();
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
						
					}
				});
				 
				 
		
				 
		    	}
	    });
	    
	}
	
	function showUploadmodal(el)
	{
		var leadid= $(el).attr('leadid');
		$('#uploadRC').modal('show');
		$('#leadIdUpload').val(leadid);
	}
	
	function submitPddRicBulkUpload()
	{
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload zip file", 'warning');
			return false;
		}
		
		var ext = $('#file-1').val().split('.').pop().toLowerCase();
		if($.inArray(ext, ['zip','gz']) == -1) {
			modalAlertToShowCustomMessage("Only ZIP/GZIP files are allowed", 'warning');
			return;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You want to upload vehicle details zip file.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
		}).then(function(isConfirm) {

				$('#wait').show();

				var formData = new FormData();
				var file = document.getElementById('file-1').files[0]
				formData.append('file',file );
		    	$.ajax({
						headers : {
							'X-CSRF-TOKEN' : $('#csrfToken').val(),'Content-Type': undefined
						},
						url : "/AdminModule/pddRicBulkUpload",
						type : 'POST',
					//	async : false,
						processData : false, // tell jQuery not to process the data
						contentType : false, // tell jQuery not to process the data
						data : formData,
						success : function(response) {
							$('#wait').hide();
							resetForm('submitCustomNotification');
							console.log(response);
							if(response==null || undefined == response){
								$( "#pddUpload-excel-download-link" ).hide();
								$("#fileLabel").html('Upload RC Copy Bulk Data File(.zip)');
								modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid zip file. Use sample file for reference', 'warning');
							}
							else if(response.status == 'success')
							{
								var download = document.getElementById('pddUpload-error-excel-download-link');
								download.setAttribute('href', response.zipUrl);	
								console.log(response.zipUrl);
								download.setAttribute('download', 'LogFile.zip');
								$( "#pddUpload-excel-download-link" ).show();
								$("#fileLabel").html('Upload RC Copy Bulk Data File(.zip)');
								modalAlertToShowCustomMessage('Zip file has been processed successfully', 'success');
							}
							else if(response.status == 'failure')
							{
								$( "#pddUpload-excel-download-link" ).hide();
								$("#fileLabel").html('Upload RC Copy Bulk Data File(.zip)');
								modalAlertToShowCustomMessage(response.message, 'warning');
							}
							
						}
					});
			
	    });
	}
	
	function showHideAppVersion(id)
	{
		if(id == 'all')
		{
			$('#all').show();
			$('#android').hide();
			$('#ios').hide();
			$('#dType').val('all');
			
		}			 
		else if (id == 'android'){
			$('#all').hide();
			$('#android').show();
			$('#ios').hide();
			$('#dType').val('3');
		}
		else if (id == 'ios'){
			$('#all').hide();
			$('#android').hide();
			$('#ios').show();
			$('#dType').val('1');
		}
	}
	
	

	
	  function fatchLeadDetailsList(startLimit,endLimit,flag) {
		  //alert("1");
		  var htmlFragment = "";
		  var dataRequest={
			  "startLimit":startLimit,
			  "endLimit":endLimit
		  }
	      $.ajax({
	    	//  headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
	    	url: "/AdminModule/unAssignInsuranceLead1",
	        type: 'POST',
	        //dataType: "JSON",
	        //async:false,
	        data: {
	        	 startLimit:startLimit,
				  endLimit:endLimit,
				  _csrf:$('#csrfToken').val()
	        },
	        success: function(data) {
	        	console.log(data);
	            if ($.isEmptyObject(data)) {
	                console.log("no responseJSON found");
	            } else {
	                var responseData = JSON.parse(data);
                    $.map(responseData, function(item){
                    	 totalcount = item.count;
                        htmlFragment += " <li><div class='col-lg-6'><div class='assignee_name'>" + item.customerName + "</div><div class='data_list'><span class='assign-fisrt' >" +
                        		" LOS Number1 </span><select class='assign-second'><option value=" + item.los + " " +
                        		" >" + item.los + "</option></select></div><div class='data_list'><span class='assign-fisrt'>Mo.</span>" +
                        		" <div class='assign-second' >" + item.mobNum + "</div></div><div class='data_list'>" +
                        		" <span class='assign-fisrt'>Address </span> "+
								" <span class='assign-second'>" + item.address + " </span>" +
								" </div></div><div class='col-lg-6 text-right'> "+
								" <span class='netpremium'>Net premium </span><span class='price' >" + item.premium + "<img src='images/rupee.svg' width='15'>" +
								" </span><div class='right-arrow'><a href='unassign-detail.html'><img src='images/right-arrow.svg' width='12'></a></div></div>" +
								" <div class='col-lg-12'><div class='vehicle-data'><span class='vehicle-heading'>Vehicle</span> " +
								" <span class='vehicle-name' >" + item.vehicle + "</span> " +
								"  </div><div class='vehicle-data'><span class='vehicle-heading'>Policy type</span>" +
								" <span class='vehicle-name'>" + item.policyType + "</span></div><div class='vehicle-data'><span class='vehicle-heading'>Previous Insurance</span>" +
								" <span class='vehicle-name' >" + item.prevInsurance + "</span></div><div class='vehicle-data'><span class='vehicle-heading'>" +
								" Policy No.</span>" + item.policyNo + "<span class='vehicle-name' '></span></div><div class='vehicle-data'>" +
								" <span class='vehicle-heading'>Expiry Date</span><span class='vehicle-name red' >" + item.expiryDate + "</span></div>" +
								" </div><div class='checkbar'><span class='act-dct checkbox-btn checkbtn'><input value='value-1' id='checkItem' name='rc2' " +
								" type='checkbox'><label for='checkItem' onclick=''><span>Assign</span></label></span></div></li>";
                    });
			if (undefined != responseData) {
	                    $('#myDiv li').remove();
	                    if (flag) {
	                    	
	                       // totalcount = responseData.count;
	                        //alert("totl---"+totalcount);
	                        if (totalcount == 0) $('#fromPage').html("0");
	                        else $('#fromPage').html(Math.ceil(startLimit / companyDisplayCount) + 1);
	                        $('#pageRange').html(Math.ceil(totalcount / companyDisplayCount));
	                        $('.halfbtnprev').attr('disabled', true).css('background-color', 'grey');
	                        $('.halfbtnnext').removeAttr('disabled').css('background-color', '#004b8f');
	                        if ($('#fromPage').html() == $('#pageRange').html()) $('.halfbtnnext').attr('disabled', true).css('background-color', 'grey');
	                       /* if (totalcount < 6) $('.halfbtnnext').attr('disabled', true).css('background-color', 'grey');
	                        else   $('.halfbtnnext').removeAttr('disabled').css('background-color', '#004b8f');
	                    */}
	                   
	                    $('#myDiv').append(htmlFragment);
	                }
	            }
	        }
    
	       	
	        });
	     // alert("2");
	}

	  
	  
	  function fatchAssignLeadDetailsList(startLimit,endLimit,flag) {
		  //alert("1");
		  var htmlFragment = "";
		  var dataRequest={
			  "startLimit":startLimit,
			  "endLimit":endLimit
		  }
	      $.ajax({
	    	//  headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
	    	url: "/AdminModule/assignInsuranceLead1",
	        type: 'POST',
	        //dataType: "JSON",
	        //async:false,
	        data: {
	        	 startLimit:startLimit,
				  endLimit:endLimit,
				  _csrf:$('#csrfToken').val()
	        },
	        success: function(data) {
	        	console.log(data);
	            if ($.isEmptyObject(data)) {
	                console.log("no responseJSON found");
	            } else {
	                var responseData = JSON.parse(data);
                    $.map(responseData, function(item){ 
                    	 totalcount = item.count;
                        htmlFragment += " <li><div class='col-lg-6'><div class='assignee_name'>" + item.customerName + "</div> <a href='#'><img src='images/pencil.svg' width='25'></a><div class='data_list'><span class='assign-fisrt' >" +
                        		" LOS Number1 </span><select class='assign-second'><option value=" + item.los + " " +
                        		" >" + item.los + "</option></select></div><div class='data_list'><span class='assign-fisrt'>Mo.</span>" +
                        		" <div class='assign-second' >" + item.mobNum + "</div></div><div class='data_list'>" +
                        		" <span class='assign-fisrt'>Address </span> "+
								" <span class='assign-second'>" + item.address + " </span>" +
								" </div></div><div class='col-lg-6 text-right'> "+
								" <span class='netpremium'>Net premium </span><span class='price' >" + item.premium + "<img src='images/rupee.svg' width='15'>" +
								" </span><div class='right-arrow'><a href='assign-detail.html'><img src='images/right-arrow.svg' width='12'></a></div>" +
								" <div class='col-lg-12'> <span class='payzapp_text'>2 PayZapp link send</span> <span class='payzappBtn'><a href='https://www.hdfcbank.com/htdocs/common/PayZapp/index.html'>PayZaap Link</a></span> </div></div>" +
								" <div class='col-lg-12'><div class='vehicle-data'><span class='vehicle-heading'>Vehicle</span> " +
								" <span class='vehicle-name' >" + item.vehicle + "</span><span class='assign-second' " +
								"  ></span></div><div class='vehicle-data'><span class='vehicle-heading'>Policy type</span>" +
								" <span class='vehicle-name'>" + item.policyType + "</span></div><div class='vehicle-data'><span class='vehicle-heading'>Previous Insurance</span>" +
								" <span class='vehicle-name' >" + item.prevInsurance + "</span></div><div class='vehicle-data'><span class='vehicle-heading'>" +
								" Policy No.</span>" + item.policyNo + "<span class='vehicle-name' '></span></div><div class='vehicle-data'>" +
								" <span class='vehicle-heading'>Expiry Date</span><span class='vehicle-name red' >" + item.expiryDate + "</span></div>" +
								" </div><div class='checkbar'><div class='status'><span class='sts-heading'>Status -</span><span class='sts-result yellow'>" + item.currentDisPostion + "</span></div><div class='status'>" +
								" <span class='sts-heading'>Assign to -</span><span class='sts-result'>" + item.assignee + "</span> "+
								"  </div><span class='act-dct checkbox-btn checkbtn'><input value='value-1' id='checkItem' name='rc2' " +
								" type='checkbox' class='reassignCheck'><label for='checkItem' onclick=''><span>Assign</span></label></span></div></li>";
                    });
			if (undefined != responseData) {
	                    $('#myDiv li').remove();
	                    if (flag) {
	                        //totalcount = responseData.count;
	                        if (totalcount == 0) $('#fromPage').html("0");
	                        else $('#fromPage').html(Math.ceil(startLimit / companyDisplayCount) + 1);
	                        $('#pageRange').html(Math.ceil(totalcount / companyDisplayCount));
	                        $('.halfbtnprev').attr('disabled', true).css('background-color', 'grey');
	                        $('.halfbtnnext').removeAttr('disabled').css('background-color', '#004b8f');
	                        if ($('#fromPage').html() == $('#pageRange').html()) $('.halfbtnnext').attr('disabled', true).css('background-color', 'grey');
	                    }
	                   
	                    $('#myDiv').append(htmlFragment);
	                }
	            }
	        }
    
	       	
	        });
	     // alert("2");
	}

	  function leadHistory(losNum) {
		  //alert("history");
		  var htmlFragment = "";
		  var dataRequest={
				  "losNum":losNum
			  }
	      $.ajax({
			  //headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
		    	//url: "/AdminModule/selfAssignInsuranceLead1",
		       // type: 'POST',
		        //dataType: "JSON",
		        //async:false,
		    	url: "/AdminModule/selfAssignLeadHistory",
		        type: 'POST',
		        data: {
		        	losNum:losNum,
					  _csrf:$('#csrfToken').val()
		        },
		        success: function(data) {
		        	console.log(data);
		            if ($.isEmptyObject(data)) {
		                console.log("no responseJSON found");
		            } else {
		                var responseData = JSON.parse(data);
	                    $.map(responseData, function(item){ 
	                    	 totalcount = item.count;
	                        htmlFragment += "<li> <div class='task-status'><img src='images/flag.svg' width='16'> " + item.oldDisPostion + " >>" +
						                        		" " + item.currentDisPostion + "</div><div class='small-text'>Last Login - " + item.empName + "</div>" +
						                        		"<div class='small-text'>" + item.lastLogin + "</div></li>";
	                    });
				if (undefined != responseData) {
		                    $('#historyData li').remove();
/*		                    if (flag) {
		                       // totalcount = responseData.count;
		                        if (totalcount == 0) $('#fromPage').html("0");
		                        else $('#fromPage').html(Math.ceil(startLimit / companyDisplayCount) + 1);
		                        $('#pageRange').html(Math.ceil(totalcount / companyDisplayCount));
		                        $('.halfbtnprev').attr('disabled', true).css('background-color', 'grey');
		                        $('.halfbtnnext').removeAttr('disabled').css('background-color', '#004b8f');
		                        if ($('#fromPage').html() == $('#pageRange').html()) $('.halfbtnnext').attr('disabled', true).css('background-color', 'grey');
		                    }*/
		                   
		                    $('#historyData').append(htmlFragment);
		                }
		            }
		        }
		        });
		}
	  
	  
	  function calculatePremium(losNum) {
		 // alert("calculatePremium");
		  var htmlFragment = "";
		  var dataRequest={
				  "losNum":losNum
			  }
	      $.ajax({
			  //headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
		    	//url: "/AdminModule/selfAssignInsuranceLead1",
		       // type: 'POST',
		        //dataType: "JSON",
		        //async:false,
		    	url: "/AdminModule/calculatePremium",
		        type: 'POST',
		        data: {
		        	losNum:losNum,
					  _csrf:$('#csrfToken').val()
		        },
				success:function(data){
					//console.log(data);
					$('#depCovNameList').empty().append('<option selected value="all">Select DepCover Name</option>');
					//var abc=data.insuranceSegmentDepCoverJoin;
					$.map(data,function(item){
						var chacekname=item.depCapName;
						var ncbVal=item.ncbValues;
						var res = ncbVal.split(",");
						if(chacekname!=null)
						$('#depCovNameList').append('<option value="'+item.zeroDepAmt+'" code="'+item.depCapName+'_'+item.zeroDepAmt+'"> '+item.depCapName+'s' +'</option>');
						$('#ncbValue').append('<option value='+res+'>' +res+'</option>');
						
						
						if(item.idvAmount!=null){
							//alert(item.idvAmount);
							document.getElementById("idvAmount").value=item.idvAmount;
							document.getElementById("basicPrem").value=item.premium;
							document.getElementById("totalTaxes").value=item.taxAmount;
							
							
						}
					});
					//$('#departmentType').removeClass('hidden');
				}
/*		        success: function(data) {
		        	console.log(data);
		            if ($.isEmptyObject(data)) {
		                console.log("no responseJSON found");
		            } else {
		                var responseData = JSON.parse(data);
	                    $.map(responseData, function(item){ 
	                    	 totalcount = item.count;
	                        htmlFragment += "";
	                    });
				if (undefined != responseData) {
					$.map(data,function(item){
						$('#depCovNameList').append('<option value="'+item.id+'">'+item.insuranceDepCoverMaster.name +'</option>');
					});
		                   // $('#depCovNameList').append(htmlFragment);
		                }
		            }
		        }*/
		        });
		}
	  
	  
	  function fatchSelfDetailsList(startLimit,endLimit,flag) {
		  //alert("1");
		  var htmlFragment = "";
		  var dataRequest={
			  "startLimit":startLimit,
			  "endLimit":endLimit
		  }
	      $.ajax({
	    	//  headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
	    	url: "/AdminModule/selfAssignInsuranceLead1",
	        type: 'POST',
	        //dataType: "JSON",
	        //async:false,
	        data: {
	        	 startLimit:startLimit,
				  endLimit:endLimit,
				  _csrf:$('#csrfToken').val()
	        },
	        success: function(data) {
	        	console.log(data);
	            if ($.isEmptyObject(data)) {
	                console.log("no responseJSON found");
	            } else {
	                var responseData = JSON.parse(data);
                    $.map(responseData, function(item){ 
                    	 totalcount = item.count;
                        htmlFragment += " <li><div class='col-lg-6'><div class='assignee_name'>" + item.customerName + "</div> <a href='#' data-toggle='modal' data-target='#edit_user'><img src='images/pencil.svg' width='25'></a><div class='data_list'><span class='assign-fisrt' >" +
                        		" LOS Number1 </span><select class='assign-second'><option value=" + item.los + " " +
                        		" >" + item.los + "</option></select></div><div class='data_list'><span class='assign-fisrt'>Mo.</span>" +
                        		" <div class='assign-second' >" + item.mobNum + "</div></div><div class='data_list'>" +
                        		" <span class='assign-fisrt'>Address </span> "+
								" <span class='assign-second'>" + item.address + " </span>" +
								" </div></div><div class='col-lg-6 text-right'> "+
								" <span class='netpremium'>Net premium </span><span class='price' >" + item.premium + "<img src='images/rupee.svg' width='15'>" +
								" </span><div class='right-arrow'><a href='/AdminModule/losDetails?losNum=" + item.los + "'><img src='images/right-arrow.svg' width='12'></a></div><div class='col-lg-12'>" +
								" <span class='payzappBtn'><a href='#' onclick='payzappLinkSend(" + item.los + ")'>PayZaap Link</a></span></div></div>" +
								" <div class='col-lg-12'><div class='vehicle-data'><span class='vehicle-heading'>Vehicle</span> " +
								" <span class='vehicle-name' >" + item.vehicle + "</span> " +
								"  </div><div class='vehicle-data'><span class='vehicle-heading'>Policy type</span>" +
								" <span class='vehicle-name'>" + item.policyType + "</span></div><div class='vehicle-data'><span class='vehicle-heading'>Previous Insurance</span>" +
								" <span class='vehicle-name' >" + item.prevInsurance + "</span></div><div class='vehicle-data'><span class='vehicle-heading'>" +
								" Policy No.</span>" + item.policyNo + "<span class='vehicle-name' '></span></div><div class='vehicle-data'>" +
								" <span class='vehicle-heading'>Expiry Date</span><span class='vehicle-name red' >" + item.expiryDate + "</span></div>" +
								" </div><div class='checkbar'><div class='selft_left'><span class='act-dct checkbox-btn'><input value='value-1' id='checkItem' name='rc2' " +
								" type='checkbox'><label for='checkItem' onclick=''><span>Reassign</span></label></span>" +
								" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class='sts-heading'>Assign to -</span><span class='sts-result'>" + item.assignee + "</span> "+
								" </div><div class='self_right'>" +
								" <div class='selft-btn' data-toggle='modal' data-target='#myModal' onclick='leadHistory(" + item.los + ")'>History</div><div class='selft-btn' data-toggle='modal' data-target='#policy_upload'>Policy Upload</div>" +
								" <div class='selft-btn' data-toggle='modal' data-target='#share_quotation'>Quotation Share</div><div class='selft-btn' data-toggle='modal' data-target='#myModal2' onclick='calculatePremium(" + item.los + ")'>" +
								" Calculate</div><input type='button' data-toggle='modal' data-target='#warning-lead' value='Update Status'> "+
								" </div></div></li>";
                    });
			if (undefined != responseData) {
	                    $('#myDiv li').remove();
	                   // alert(flag);
	                    if (flag) {
	                       // totalcount = responseData.count;
	                        if (totalcount == 0) $('#fromPage').html("0");
	                        else $('#fromPage').html(Math.ceil(startLimit / companyDisplayCount) + 1);
	                       // alert("q");
	                        $('#pageRange').html(Math.ceil(totalcount / companyDisplayCount));
	                        $('.halfbtnprev').attr('disabled', true).css('background-color', 'grey');
	                        $('.halfbtnnext').removeAttr('disabled').css('background-color', '#004b8f');
	                        if ($('#fromPage').html() == $('#pageRange').html()) $('.halfbtnnext').attr('disabled', true).css('background-color', 'grey');
	                   // alert("end");
	                    }
	                   
	                    $('#myDiv').append(htmlFragment);
	                }
	            }
	        }
    
	       	
	        });
	     // alert("2");
	}
	  

	  function sendPayzappLink(losNum) {
		  //alert("1");
		  var htmlFragment = "";
		  var dataRequest={
			 
			  "losNum":losNum,
			  "depCap":depCap,
			  "idv":idv,
			  "basicPremium":basicPremium,
			  "tax":tax,
			  "ncb":ncb,
			  "discount":discount
		  }
	      $.ajax({
	    	//  headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
	    	url: "/AdminModule/sendPayzappLink",
	        type: 'POST',
	        //dataType: "JSON",
	        //async:false,
	        data: {
	        	 losNum:losNum,
	        	 depCap:depCap,
	        	 idv:idv,
	        	 basicPremium:basicPremium,
	        	 tax:tax,
	        	 discount:discount,
				  _csrf:$('#csrfToken').val()
	        },
	        success: function(data) {
	        	console.log(data);
	            if ($.isEmptyObject(data)) {
	                console.log("no responseJSON found");
	            } else {
	                var responseData = JSON.parse(data);
                    $.map(responseData, function(item){ 
                    	 totalcount = item.count;
                        htmlFragment += " ";
                    });
			if (undefined != responseData) {
	                    $('#myDiv li').remove();
	                    $('#myDiv').append(htmlFragment);
	                }
	            }
	        }
    
	       	
	        });
	     // alert("2");
	}
	  
	  
	  function fetchUAMCityList(city, state){
			$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
			$.ajax({
				url: "/AdminModule/fetchUAMCityList",
				type: 'POST',
				//async:false,
				//dataType: 'JSON',
				success:function(data){
					var htmlCity="";
					var htmlState="";
					$.each(data, function(i, item) {
						htmlCity += '<option value="'+i+'" code="'+i+'_'+data[i]+'">'+i+'</option>';
						htmlState += '<option value="'+data[i]+'" code="'+i+'_'+data[i]+'">'+data[i]+'</option>';
					});
					$('#'+city).append(htmlCity);
					$('#'+state).append(htmlState);
				}
			});
		}
	  
	  function changeStateName(el,stateList){
		  	$('#hiddenState').val('');
		  	$('#hiddenLocation').val('');
			var arrayData= $(el).find(':selected').attr('code').split("_");
			if(undefined != arrayData){
				$('#'+stateList).val(arrayData[1]);
				$('#hiddenState').val(arrayData[1]);
				$('#hiddenLocation').val(arrayData[0]);
			}
		}
	  
	  function changeRoleName(el,roleList){
		  	$('#hiddenRole').val('');
			//var arrayData= $(el).find(':selected').attr('code').split("_");
		  	var arrayData= $(el).find(':selected').val();
			if(undefined != arrayData){
				$('#'+roleList).val(arrayData);
				$('#hiddenRole').val(arrayData);
				/*$('#'+roleList).val(arrayData[1]);
				$('#hiddenRole').val(arrayData[1]);*/
			}
		}
	  function changeDepartmentName(el,deptList){
		  	$('#hiddenDepartmentId').val('');
			//var arrayData= $(el).find(':selected').attr('code').split("_");
		  	var arrayData= $(el).find(':selected').val();
			if(undefined != arrayData){
				$('#'+deptList).val(arrayData);
				$('#hiddenDepartmentId').val(arrayData);
				/*$('#'+deptList).val(arrayData[1]);
				$('#hiddenDepartmentId').val(arrayData[1]);*/
			}
		}
	  function changeBranchName(el,branchList){
		  	$('#hiddenBranchId').val('');
			//var arrayData= $(el).find(':selected').attr('code').split("_");
		  	var arrayData= $(el).find(':selected').val();
			if(undefined != arrayData){
				$('#'+branchList).val(arrayData);
				$('#hiddenBranchId').val(arrayData);
				/*$('#'+branchList).val(arrayData[1]);
				$('#hiddenBranchId').val(arrayData[1]);*/
			}
		}
	  
	  
	  function payzappLinkSend(losNum) {
		  alert("1");
		  var htmlFragment = "";
		  var dataRequest={
			 
			  "losNum":losNum
		  }
	      $.ajax({
	    	//  headers: {'Accept': 'application/json', 'Content-Type': 'application/json', 'X-CSRF-TOKEN':$('#csrfToken').val()},
	    	url: "/AdminModule/payzappLinkSend",
	        type: 'POST',
	        //dataType: "JSON",
	        //async:false,
	        data: {
	        	 losNum:losNum,
				  _csrf:$('#csrfToken').val()
	        },
	        success: function(data) {
	        	console.log(data);
	            if ($.isEmptyObject(data)) {
	                console.log("no responseJSON found");
	            } else {
	                var responseData = JSON.parse(data);
                    $.map(responseData, function(item){ 
                    	 totalcount = item.count;
                        htmlFragment += " ";
                    });
			if (undefined != responseData) {
	                    $('#myDiv li').remove();
	                    $('#myDiv').append(htmlFragment);
	                }
	            }
	        }
    
	       	
	        });
	     // alert("2");
	}

		/*function changeCityName(el,cityList){
			var arrayData= $(el).find(':selected').attr('code').split("_");
			if(undefined != arrayData){
				$('#'+cityList).val(arrayData[0]);
			}
		}*/
	  
	  function isLastFivePassword(el){
		  
		  console.log('el:: '+el);
		  
		  var e_code = $("input[name=employeeCode]").val();
		  var password = $(el).val();
		  var hiddenPassword = $('#hiddenPassword').val();
		  if(hiddenPassword!=password){
			  $('#wait').show();
			  var dataRequest={
					  "e_code":e_code,
					  "password":password
				  }
				$.ajax({
					type:'POST', 
					url: "/AdminModule/isLastFivePassword", 
					data: {
						e_code:e_code,
						password:password,
						_csrf:$('#csrfToken').val()
			        },
					//async:false,
					//dataType: 'JSON',
					success:function(data){
						$('#wait').hide();
						if(data==true){
							modalAlertToShowCustomMessage("You cannot set your last 10 password. Please try again.", 'warning');
							$('#editpassword').val(hiddenPassword);
						}
					}
				});
		  }
		  
		  
	  }
	  
	  function showHidePassword(ID){
		  var x = document.getElementById(ID);
		  var t = document.getElementsByClassName("pass-showhide"); 
		    if (x.type === "password") {
		        x.type = "text";
		        $(".pass-showhide").text("Hide");
		    } else {
		        x.type = "password";
		        $(".pass-showhide").text("Show");
		    }
	  }
	  
	  function changeDepVal(el){
		  var val=$(el).find(':selected').attr('code').split("_");
		  //alert(val[1]);
		  document.getElementById("depCovPrice").innerHTML=val[1];
	  }
	  
	  function submitFinnoneImport(el,divName,fileLabel){
		  //alert($("#file-1")[0].files.length);

		  if($('#'+divName+' input[type="file"]')[0].files.length < 1){
			  modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			  return false;
		  }
		  
		  $('#wait').show();
		  var file = $('#'+divName+' input[type="file"]')[0].files[0]
		  var key = "vahangyan";
		  // Uses different reader for all files
		  var reader = new FileReader();

		  reader.onload = function() {

			  var salt = CryptoJS.lib.WordArray.random(128/8);
			  var iv = CryptoJS.lib.WordArray.random(128/8);
			  //			console.log('salt  '+ salt );
			  //			console.log('iv  '+ iv );

			  // To construct our multipart form data request,
			  // We need a separator to define each part of the request
			  var boundary = "blob";

			  var data = AESFileEncryption(key, salt, iv, file, reader, boundary, "pddFile");
			  $.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
			  $.ajax({
				  headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
				  url: "/AdminModule/pddUploadFinnoneFile?fileType="+$(el).attr('id'),
				  type: 'POST',
				  processData: false,  // tell jQuery not to process the data
				  contentType: false,  // tell jQuery not to process the data
				  data:data,
				  success:function(response){
					  $('#wait').hide();
					  if(response == null || response == ""){
						//  $(fileLabel).html('Upload file customer data (.xlsx)');
						  modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
					  }
					  else if(response == 'header-mismatch'){
						  modalAlertToShowCustomMessage('Column Headers do not match with sample file. Please use sample file for reference', 'warning'); 
					  }
					  else
					  {
						  var temp = response.split("~");
						  if(undefined != temp && temp.length>0){
							  $(el).val(temp[0]);
							  // $(fileLabel).html('Upload file customer data (.xlsx)');
							  modalAlertToShowCustomMessage('Excel file has been uploaded successfully with record count '+temp[1], 'success');
							  if($('#vgFile').val() != undefined && $('#vgFile').val() != '' && $('#finnoneFile').val() != undefined && $('#finnoneFile').val() != '' ){
								  $('#matchProcessBtn').removeClass('dissable-btn');
							  }
							  else{
								  $('#matchProcessBtn').addClass('dissable-btn');
							  }
						  }
						  else{
							  modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning'); 
						  }
					  }
				  }, 
				  error: function(jqXHR, textStatus, errorThrown) {
					  console.log('jqXHR:');
					  console.log(jqXHR);
					  console.log('textStatus:');
					  console.log(textStatus);
					  console.log('errorThrown:');
					  console.log(errorThrown);

				  }
			  });
		  }

		  reader.readAsDataURL(file);

	  }
	  function resetPDDMatchFiles(){
		  $('#finnoneFile').val('');
		  $('#vgFile').val('');
		  $('#fileLabel1').html('Upload file customer data (.xlsx)');
		  $('#fileLabel2').html('Upload file customer data (.xlsx)');
		  $('#matchProcessBtn').addClass('dissable-btn');
	  }
	  var matchedRecords="";
	  function startMatchProcess(){
		  if($('#vgFile').val() == undefined || $('#vgFile').val() == ''){
			  modalAlertToShowCustomMessage('Please upload Vahangyan file to continue', 'warning');
			  return;
		  }
		  if($('#finnoneFile').val() == undefined || $('#finnoneFile').val() == ''){
			  modalAlertToShowCustomMessage('Please upload Finnone file to continue', 'warning');
			  return;
		  }
		  $('#wait').show();
		  var data={
				  vgFile:$('#vgFile').val(),
				  finnoneFile:$('#finnoneFile').val()
		  };
		  $.ajax({
			  type:'POST', 
			  headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()},
			  url: "/AdminModule/startMatchProcess", 
			  data:JSON.stringify(data),
			  success:function(response){
				  $('#wait').hide();
				  if(undefined != response && response!= ''){
					 // var response=$.parseJSON(responseData);
					  if(undefined != response.status && response.status.code == 101){
						  modalAlertToShowCustomMessage(response.status.message, 'warning');
					  }
					  else if(response.data == undefined ){
						  modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel files. Use sample files for reference', 'warning');
					  }
					  else{
						  $('#match-process #totalProcessed').html(response.data.totalProcessed);
						  $('#match-process #matched').html(response.data.matched);
						  $('#match-process #partialMatched').html(response.data.partiallyMatched);
						  $('#match-process #rejected').html(response.data.rejected);
						  $('#match-process #alreadyApproved').html(response.data.alreadyApproved);
						  $('#match-process #downloadApproved').hide();
						  if(response.data.alreadyApproved > 0){
						  $('#match-process #downloadApproved a').attr('href',response.data.alreadyApprovedFileUrl);
						  $('#match-process #downloadApproved').show();
						  }
						  matchedRecords = response;
						  $('#match-process').modal('show');
					  }
				  }
				  else
					  modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel files. Use sample files for reference', 'warning');
			  }
		  
		  });
	  }
	  function viewMatchedRecords(){
		  $('#match-process').modal('hide');
		  resetPDDMatchFiles();
		  if(matchedRecords != "" && undefined != matchedRecords.data && matchedRecords.data.bulkSlot != undefined){
			 /* $.ajax({
					  type:'POST', 
					  headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()},
					  url: "/AdminModule/viewMatchResults", 
					  data:JSON.stringify(matchedRecords),
					  success:function(){
						  
					  }
			  });*/
			//  $('#matchProcessRequestBean').val(JSON.stringify(matchedRecords.data));
			  $('#bulkSlot').val(matchedRecords.data.bulkSlot)
			  $('#submitPDDMatchForm').submit();
		  }
		  else
			  modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel files. Use sample files for reference', 'warning'); 
	  }
	  function showMatchDetail(el){
		  $('.reassignCheck').prop('checked',false);
		  var temp = $('.result-tab li.active a').attr('href');
		  if(undefined == temp || temp == '')
			  temp = '#matchDiv';
		  var selectedIndex=$(temp+' .line').index($(el).parents('.line'));
		  var comparison=$(el).attr('comparisonString');
		  var agreementNumber=$(el).attr('agreementNumber');
		  var status=$(el).attr('status');
		  var pdfUrl=$(el).attr('pdfUrl');
		  $('#match-process #dataMatch').html('');
		  $('#match-process #agreementNumber').html(agreementNumber);
		  $('#match-process #viewPDF').attr('href',pdfUrl);
		  $('#match-process input[name="rc1"]').prop('checked',false);
		  $('#match-process .remark-text textarea').val('');
		  $('.remark-text').addClass('dissable');
		  $('#match-process #finalSubmit').hide();
		  if($('.result-tab li.active var').html() <=50)
			  $('#countTracker').html((selectedIndex+1)+"/"+$('.result-tab li.active var').html());
		  else
		   $('#countTracker').html((selectedIndex+1)+"/50");
		  $('#rowIndex').val(selectedIndex);
		  var maxIndex = $(temp+' .line').length -1 ;
		   if(undefined == maxIndex || maxIndex < 0)
			   maxIndex=0;
		   if(maxIndex == 0){
			   $('.left-slide').hide();
			   $('.right-slide').hide();
			   $('#match-process #finalSubmit').show();
		   }
		   else if(selectedIndex <=0){
			   $('.left-slide').hide();
			   $('.right-slide').show();
		   }
		   else if(selectedIndex >=maxIndex){
			   $('.left-slide').show();
			   $('.right-slide').hide();
		   }
		   else{
			   $('.left-slide').show();
			   $('.right-slide').show();
		   }
		  if(undefined != comparison){
			  var html="";
			  var remarks="";
			  $.map($.parseJSON(comparison),function(item){
				  html+='<div class="row"><label class="col-xs-12 col-lg-3 col-sm-3 col-md-3 form-group">'+item.fieldName+'</label><div class="col-xs-6 col-lg-3 col-sm-3 col-md-3 form-group">';
				  if(item.finnoneVal== undefined)
					  item.finnoneVal="";
				  html+='<input type="text" name="" disabled="disabled" value="'+item.finnoneVal+'"/> </div><div class="col-xs-6 col-lg-3 col-sm-3 col-md-3 form-group">';
				  if(item.vgVal== undefined)
					  item.vgVal="";
				  html+='<input type="text" name="" disabled="disabled" value="'+item.vgVal+'"/> </div><div class="col-xs-5 col-lg-2 col-sm-2 col-md-2 form-group remark-text">';
				  html+=item.message+'</div>';
				  if(item.percentMatch != undefined && item.percentMatch == 1.0){
					 html+='<img src="images/check.svg" width="20"></div></div>';
				  }
				  else if(item.percentMatch != undefined && item.percentMatch < 0.75){
					  //remarks+=item.fieldName+":- ";
					  if(remarks != '')
						  remarks+=" | ";
					  remarks+=item.message;
					 html+='<img src="images/cancel.svg" width="20"></div></div>';
				  }
				  else{
					//  remarks+=item.fieldName+":- ";
					//  remarks+=item.message+" | ";
					  html+='<img src="images/warning.svg" width="20"></div></div>'; 
				  }
			  });
			  if(status == 0)
				  $('#approveRejectDiv').show();
			  else 
				  $('#approveRejectDiv').hide();
			  $('#match-process #hiddenRemarks').val(remarks);
			  $('#match-process #dataMatch').html(html);
			  $('#match-process').modal('show');
		  }
	  }
	  function setFileLabelCustom(labelId,divId,submitButtonId){ 
			
			var fileName= $("#"+divId+" input[type='file']").val().replace(/.*[\/\\]/, '');
			$(labelId).html(fileName);
			$(submitButtonId).show();
			
			 
		}
	  
	  function approveReject(type,isFromSlide,isRemarksMandatory){
		  if(isFromSlide && $('#match-process input[name="rc1"]:checked').length ==0 ){
			  modalAlertToShowCustomMessage('Please approve OR reject the record', 'warning');
			  return;
		  }
		  if(isFromSlide == false && ($('#agreementNumber').html() == undefined || $('#agreementNumber').html()== '')){
			  modalAlertToShowCustomMessage('Please select agreement numbers', 'warning');
			  return;
		  }
		  $('#checkedTab').val($('.result-tab li.active').attr('id'));
		  var csrfVal = $('#csrfToken').val();
		  if(isRemarksMandatory && type == 2 && ($('#remarks').val() == undefined || $('#remarks').val() =='' )){
			  modalAlertToShowCustomMessage('Remarks is mandatory', 'warning');
			  return;
		  }
		  var approveReject=[];
		  if(isFromSlide){
				  //check if agreement number is already present in array update it else add it
				 var prevAgreementNo= $('#match-process #agreementNumber').html();
				 var isFound = false;
				 if(undefined != approvedRejectedData && approvedRejectedData.length>0){
					 for(var i in approvedRejectedData){
						 if(approvedRejectedData[i].agreementNumber == prevAgreementNo){
							 approvedRejectedData[i].status = $('#match-process input[name="rc1"]:checked').val();
							 approvedRejectedData[i].remarks = $('#match-process .remark-text textarea').val();
								isFound = true;
								//break;
						 }
					 }
				/*$.map(approvedRejectedData,function(item){
					if(item.agreementNumber == prevAgreementNo){
						item.status = $('#match-process input[name="rc1"]:checked').val();
						item.remarks = $('#match-process .remark-text textarea').html();
						isFound = true;
						//break;
					}
				});*/
				 }
				 if(!isFound){
					 var data={"agreementNumber":prevAgreementNo,"status":$('#match-process input[name="rc1"]:checked').val(),"remarks":$('#match-process .remark-text textarea').val()};
					 approvedRejectedData.push(data);
				 }
			  approveReject=approvedRejectedData;
		  }
		  else{
			  var temp = $('#agreementNumber').html().split(",");
			  $.each(temp,function(i,val){
				  var d = {"agreementNumber":val,"status":type,"remarks":$('#remarks').val()};
				  approveReject.push(d);
			  });
		  }
		  var data={"approveReject":approveReject};
		  $.ajax({
			  type:'POST', 
			  headers: {'X-CSRF-TOKEN':$('#csrfToken').val()},
			  url: "/AdminModule/approveRejectPDDMatchData",
			  contentType: 'application/json',
			  data:JSON.stringify(data),
			  success:function(response){
				  // console.log(response);
				  $('.reassignCheck').prop('checked',false);
				  if(undefined != response){
					  var res = $.parseJSON(response);
					  if(res.code == 100){
						  if(isFromSlide){
							  modalAlertToShowCustomMessage('Response Submitted Successfully', 'success');
						  }
						  else{
						  if(type==1){
							  modalAlertToShowCustomMessage('Match Approved Successfully', 'success');
						  }
						  else{
							  modalAlertToShowCustomMessage('Match Rejected Successfully', 'success');
						  }
						  }
						 $('#submitPDDMatchForm').submit();
					  }
					  else{
						  modalAlertToShowCustomMessage('Oops some error occurred. Please try again!', 'warning'); 
					  }
				  }
				  else{
					  modalAlertToShowCustomMessage('Oops some error occurred. Please try again!', 'warning'); 
				  }
			  }
		  
		  });
	  }
	  function approveAllMatched(status,systemStatus){
		  $.ajax({
			  type:'POST', 
			//  headers: {'Accept': 'application/json', 'Content-Type': 'application/json' , 'X-CSRF-TOKEN':$('#csrfToken').val()},
			  url: "/AdminModule/approveAllMatched", 
			  data:{
				  "_csrf":$('#csrfToken').val(),
				  "bulkSlot": $('#bulkSlot').val(),
				  "status":status,
				  "systemStatus":systemStatus
			  },
			  success:function(response){
				  if(undefined != response){
					  var res = $.parseJSON(response);
					  if(res.code == 100){
							  modalAlertToShowCustomMessage('All records Approved Successfully', 'success');
							  $('#submitPDDMatchForm').submit();
					  }
					  else{
						  modalAlertToShowCustomMessage('Oops some error occurred. Please try again!', 'warning'); 
					  }
				  }
				  else{
					  modalAlertToShowCustomMessage('Oops some error occurred. Please try again!', 'warning'); 
				  }
			  }
		  
		  });
	  }
	  function searchUserForCurrentECode(){
		  var userEcode=$('#userEcode').val();
		  var searchText = $('#searchText').val();
		  if(undefined!=searchText && $.trim(searchText)!=''){
			  //alert('searchText:: '+searchText+', userEcode:: '+userEcode);
			  $('#wait').show();
			  var dataRequest={
					  "userEcode":userEcode,
					  "searchText":searchText
				  }
				$.ajax({
					type:'POST', 
					url: "/AdminModule/searchUserForCurrentECode", 
					data: {
						userEcode:userEcode,
						searchText:searchText,
						_csrf:$('#csrfToken').val()
			        },
					//async:false,
					//dataType: 'JSON',
					success:function(response){
						$('#wait').hide();
						if(response == null || response == ""){
						  modalAlertToShowCustomMessage('No user found. Please try again.', 'warning');
						} else {
							console.log('searchUserForCurrentECode response: '+response);
							var html="";
							$('#myDiv').html('');
							$.map(response,function(item){
							  
								console.log('item.username:: '+item.username);
								
								html+='<li>';
								html+='<div class="inner-userpic">';
								html+='<img src="images/login-user.svg">';
								html+='</div>';
								html+='<div class="num-off-act">';
								html+='<p>'+item.username+'</p> <span>'+item.ecode+'</span>';
								html+='</div>';
								html+='<div class="right-assign">';
								html+='<div class="button">';
								html+='<a href="#">Assign - <span>'+item.assignCount+'</span></a>';
								html+='</div>';
								html+='<div class="button">';
								html+='<a href="#">Unassign - <span>'+item.unassignCount+'</span></a>';
								html+='</div>';
								html+='<div class="button">';
								html+='<a href="manage-team1.html">Team - <span>'+item.teamCount+'</span></a>';
								html+='</div>';
								html+='</div>';
								html+='</li>';
								
							});
							$('#myDiv').html(html);
						}
					}
				});
		  }else{
			  $('#searchText').val('');
			  modalAlertToShowCustomMessage("Please provide Username or Ecode.", 'warning');
		  }
		  
	  }
	  
	  function searchUserForThisECode(username,e_code){
			  $('#wait').show();
			  var dataRequest={
					  "e_code":e_code,
				  }
				$.ajax({
					type:'POST', 
					url: "/AdminModule/searchUserForThisECode", 
					data: {
						e_code:e_code,
						_csrf:$('#csrfToken').val()
			        },
					//async:false,
					//dataType: 'JSON',
					success:function(response){
						$('#wait').hide();
						if(response == null || response == ""){
						  modalAlertToShowCustomMessage('No user found. Please try again.', 'warning');
						} else {
							//console.log('searchUserForThisECode response: '+response);
							
							//navFunction();
							var prevUserName = $('#userName').val();
							var prevUserEcode = $('#userEcode').val();
							navFunction2(username,e_code,prevUserName,prevUserEcode);
							
							
							var html="";
							$('#myDiv').html('');
							$.map(response,function(item){
							  
								//console.log('item.username:: '+item.username);
								
								html+='<li>';
								html+='<div class="inner-userpic">';
								html+='<img src="images/login-user.svg">';
								html+='</div>';
								html+='<div class="num-off-act">';
								html+='<p id="un">'+item.username+'</p> <span id="ec">'+item.ecode+'</span>';
								html+='</div>';
								html+='<div class="right-assign">';
								html+='<div class="button">';
								html+='<a href="#">Assign - <span>'+item.assignCount+'</span></a>';
								html+='</div>';
								html+='<div class="button">';
								html+='<a href="#">Unassign - <span>'+item.unassignCount+'</span></a>';
								html+='</div>';
								html+='<div class="button">';
								html+='<a href="#" class="bcClass" onclick="searchUserForThisECode(\''+item.username+'\',\''+item.ecode+'\')">Team - <span>'+item.teamCount+'</span></a>';
								html+='</div>';
								html+='</div>';
								html+='</li>';
								
							});
							$('#myDiv').html(html);
							$('#userEcode').val(e_code);
						}
						
					}
				});
	  }
	  
	  function navFunction2(username,e_code,prevUserName,prevUserEcode){
		  var html = $('#ol').html();

		  if(html.indexOf(e_code) != -1){
			  //$('a[code='+e_code+']').next().remove();
			  var newNav = $('a[code='+e_code+']').closest('li').text();
			  $('a[code='+e_code+']').closest('li').nextAll().remove(); //remove all child element
			  $('a[code='+e_code+']').closest('li').remove(); //remove current html and replace by below one
			  
			  $('#ol').append($.parseHTML('<li class="current"><em>'+newNav+'</em></li>'));
			  
		  }else{
			  //alert(e_code + " not found");
			  var html2 = html.replace(/class="current"/g, "");
		  	  html2 = html2.replace(/<em>/g, "<a href=\"#\" onclick=\"searchUserForThisECode(\'"+prevUserName+"\',\'"+prevUserEcode+"\')\" code=\""+prevUserEcode+"\">");
		  	  html2 = html2.replace(/<\/em>/g, "</a>");
		  	  //alert(html2);
		  	  
		  	  $bc = $('<ol id="ol" class="cd-breadcrumb custom-separator"></ol>');
		  	  $bc.prepend('', '<li class="current"><em>'+username +' ('+e_code+')'+'</em></li>');
		  	  $('#nav').html($bc.prepend(html2));
		  }
		  return false;
	  }
	  function downloadBatchOutput(){
		  var finalData = {"batch":$('#bulkSlot').val(),"fromDate":$('#fromDate').val(),"toDate":$('#toDate').val()};

		  var xhttp = new XMLHttpRequest();
		  xhttp.onreadystatechange = function() {
			  var a;
			  if (xhttp.readyState === 4 && xhttp.status === 200) {
				  // Trick for making downloadable link
				  a = document.createElement('a');
				  //console.log(xhttp);
				  a.href = xhttp.response;
				  a.download = "pdd_ric_match_"+formatDate(new Date())+".zip";
				  a.style.display = 'none';
				  document.body.appendChild(a);
				  a.click();
			  }
		  };
		  // Post data to URL which handles post request
		  xhttp.open("POST", "/AdminModule/pddRICFinnoneUploadReport");
		  xhttp.setRequestHeader("Content-Type", "application/json");
		  xhttp.setRequestHeader("X-CSRF-TOKEN", $('#csrfToken').val());
		  // You should set responseType as blob for binary responses
		  //xhttp.responseType = 'blob';
		  xhttp.send(JSON.stringify(finalData));
	  }
	  
	  function rejectPasswordPoliciesPopUp(){
		  $('#reject').modal('show');
	  }
	  
	  function rejectPasswordPolicies(){
		  //if (confirm("Are You Sure You Want to Reject!")) {				
				//alert('Yes');
		  
		  if($.trim($('#rejectRemark').val())==''){
				alert('Please enter reason of rejection!');
				$('#rejectRemark').val('');
				return;
			}else{
				$('#wait').show();
				var rejectRemark = $('#rejectRemark').val();
				var dataRequest={
						  "rejectRemark":rejectRemark,
					  }
				$.ajax({
					type:'POST', 
					url: "/AdminModule/rejectPasswordPolicies", 
					data: {
						rejectRemark: rejectRemark,
						_csrf:$('#csrfToken').val()
					},
					//async:false,
					//dataType: 'JSON',
					success:function(data){
						$('#wait').hide();
						if(data==true){
							window.location = "/AdminModule/passwordPolicyApproval?_csrf="+$('#csrfToken').val();
						}
					}
				});
			}
		  		
			//}
	  }
	  
	  function approvePasswordPolicies(){
		  if (confirm("Are You Sure You Want to Approve!")) {				
				//alert('Yes');
			  $('#wait').show();
			  	$.ajax({
					type:'POST', 
					url: "/AdminModule/approvePasswordPolicies", 
					data: {
						_csrf:$('#csrfToken').val()
			        },
					//async:false,
					//dataType: 'JSON',
					success:function(data){
						$('#wait').hide();
						if(data==true){
							window.location = "/AdminModule/passwordPolicyApproval?_csrf="+$('#csrfToken').val();
						}
					}
				});
			}
	  }
	  
	  function downloadComparisonReport(){
		  var finalData = {"batch":$('#bulkSlot').val()};
		  var xhttp = new XMLHttpRequest();
		  xhttp.onreadystatechange = function() {
			  var a;
			  if (xhttp.readyState === 4 && xhttp.status === 200) {
				  // Trick for making downloadable link
				  a = document.createElement('a');
				  //console.log(xhttp);
				  a.href = xhttp.response;
				  a.download = "pdd_ric_match_"+formatDate(new Date())+".xlsx";
				  a.style.display = 'none';
				  document.body.appendChild(a);
				  a.click();
			  }
		  };
		  // Post data to URL which handles post request
		  xhttp.open("POST", "/AdminModule/pddRICMatchReport");
		  xhttp.setRequestHeader("Content-Type", "application/json");
		  xhttp.setRequestHeader("X-CSRF-TOKEN", $('#csrfToken').val());
		  // You should set responseType as blob for binary responses
		  //xhttp.responseType = 'blob';
		  xhttp.send(JSON.stringify(finalData));
	  }
	  var approvedRejectedData=[];
	  function slide(type){
		  if($('#match-process input[name="rc1"]:checked').length ==0 ){
			  modalAlertToShowCustomMessage('Please approve OR reject the record', 'warning');
			  return;
		  }
		  else{
			  //check if agreement number is already present in array update it else add it
			 var prevAgreementNo= $('#match-process #agreementNumber').html();
			 var isFound = false;
			 if(undefined != approvedRejectedData && approvedRejectedData.length>0){
				 for(var i in approvedRejectedData){
					 if(approvedRejectedData[i].agreementNumber == prevAgreementNo){
						 approvedRejectedData[i].status = $('#match-process input[name="rc1"]:checked').val();
						 approvedRejectedData[i].remarks = $('#match-process .remark-text textarea').val();
							isFound = true;
							//break;
					 }
				 }
			/*$.map(approvedRejectedData,function(item){
				if(item.agreementNumber == prevAgreementNo){
					item.status = $('#match-process input[name="rc1"]:checked').val();
					item.remarks = $('#match-process .remark-text textarea').html();
					isFound = true;
					//break;
				}
			});*/
			 }
			 if(!isFound){
				 var data={"agreementNumber":prevAgreementNo,"status":$('#match-process input[name="rc1"]:checked').val(),"remarks":$('#match-process .remark-text textarea').val()};
				 approvedRejectedData.push(data);
			 }
			 $('#match-process input[name="rc1"]').prop('checked',false).trigger('change');
			 $('#match-process .remark-text textarea').val('')
			 $('#match-process #finalSubmit').hide();
		   var index = $('#rowIndex').val();
		   var temp = $('.result-tab li.active a').attr('href');
			  if(undefined == temp || temp == '')
				  temp = '#matchDiv';
		   var maxIndex = $(temp+' .line').length -1;
		   if(undefined == maxIndex || maxIndex < 0)
			   maxIndex=0;
		   if(type == 0){
			   //right
			  index= parseInt(index)+1;
		   }
		   else{
			 //left
				index= parseInt(index)-1;
		   }
		   if(maxIndex == 0){
			   $('.left-slide').hide();
			   $('.right-slide').hide();
			   $('#match-process #finalSubmit').show();
		   }
		   else if(index <=0){
			   $('.left-slide').hide();
			   $('.right-slide').show();
		   }
		   else if(index >=maxIndex){
			   $('.left-slide').show();
			   $('.right-slide').hide();
			   $('#match-process #finalSubmit').show();
		   }
		   else{
			   $('.left-slide').show();
			   $('.right-slide').show();
		   }
		   var el =$(temp+' .line:eq('+index+') .right-arrow a');
		   $('#comparisonData').effect('slide');
		   if($('.result-tab li.active var').html() <= 50)
			   $('#countTracker').html((index+1)+"/"+$('.result-tab li.active var').html())
		 else 
			 $('#countTracker').html((index+1)+"/50");
		   var comparison=$(el).attr('comparisonString');
			  var agreementNumber=$(el).attr('agreementNumber');
			  var status=$(el).attr('status');
			  var pdfUrl=$(el).attr('pdfUrl');
			  $('#match-process #dataMatch').html('');
			  $('#match-process #agreementNumber').html(agreementNumber);
			  $('#match-process #viewPDF').attr('href',pdfUrl)
			   $('#rowIndex').val(index);
			  if(undefined != approvedRejectedData && approvedRejectedData.length>0){
				  for(var i in approvedRejectedData){
					  if(approvedRejectedData[i].agreementNumber == agreementNumber){
							 $('#match-process input[name="rc1"][value="'+approvedRejectedData[i].status+'"]').prop('checked','checked').trigger('change');
							 $('#match-process .remark-text textarea').val(approvedRejectedData[i].remarks);
							//break;
						}
				  }
					
					 }
			  if(undefined != comparison){
				  var html="";
				  var remarks="";
				  $.map($.parseJSON(comparison),function(item){
					  html+='<div class="row"><label class="col-xs-12 col-lg-3 col-sm-3 col-md-3 form-group">'+item.fieldName+'</label><div class="col-xs-6 col-lg-3 col-sm-3 col-md-3 form-group">';
					//  remarks+=item.fieldName+":- ";
					  if(item.finnoneVal== undefined)
						  item.finnoneVal="";
					  html+='<input type="text" name="" disabled="disabled" value="'+item.finnoneVal+'"/> </div><div class="col-xs-6 col-lg-3 col-sm-3 col-md-3 form-group">';
					  if(item.vgVal== undefined)
						  item.vgVal="";
					  html+='<input type="text" name="" disabled="disabled" value="'+item.vgVal+'"/> </div><div class="col-xs-5 col-lg-2 col-sm-2 col-md-2 form-group remark-text">';
					  html+=item.message+'</div>';
					//  remarks+=item.message+"\n";
					  if(item.percentMatch != undefined && item.percentMatch == 1.0){
						 html+='<img src="images/check.svg" width="20"></div></div>';
					  }
					  else if(item.percentMatch != undefined && item.percentMatch < 0.75){
						  if(remarks != '')
							  remarks+=" | ";
						  remarks+=item.message;
						 html+='<img src="images/cancel.svg" width="20"></div></div>';
					  }
					  else{
						 /* remarks+=item.fieldName+":- ";
						  remarks+=item.message+"\n";*/
						  html+='<img src="images/warning.svg" width="20"></div></div>'; 
					  }
				  });
				  if(status == 0)
					  $('#approveRejectDiv').show();
				  else 
					  $('#approveRejectDiv').hide();
				  $('#match-process #hiddenRemarks').val(remarks);
				  $('#match-process #dataMatch').html(html);
			  }
		  }
	   }
	  
	  function checkMinMax(){
		  var minLength = $('#minLength').val();
		  var maxLength = $('#maxLength').val();
		  
		  if(parseInt(minLength)<1 || parseInt(minLength)>99){
			  modalAlertToShowCustomMessage('Minimum Length should range between 1 to 99.', 'warning');
			  $('#minLength').val('');
			  return true;
		  }
		  
		  if(parseInt(maxLength)<1 || parseInt(maxLength)>99){
			  modalAlertToShowCustomMessage('Maximum Length should range between 1 to 99.', 'warning');
			  $('#maxLength').val('');
			  return true;
		  }
		  
		  if(parseInt(minLength) > parseInt(maxLength)){
			  modalAlertToShowCustomMessage('Minimum Length cannot be greater than Maximun Length.', 'warning');
			  $('#minLength').val('');
			  $('#maxLength').val('');
			  return true;
		  }
	  }
	  
	  function checkMaxWrongAttempt(){
		  var maxWrongLength = $('#maxWrongLength').val();
		  if(parseInt(maxWrongLength)<1 || parseInt(maxWrongLength)>99){
			  modalAlertToShowCustomMessage('Wrong Attempt should range between 1 to 99.', 'warning');
			  $('#maxWrongLength').val('');
			  return true;
		  }
	  }
	  
	  function resetSomeField(formId){
			$(':input','#'+formId)
			  .not(':button, :submit, :reset, :hidden')
		  	  .val('')
		  	  .removeAttr('checked')
		  	  .removeAttr('selected');
		}
	//========================== Tree Structure =====================================
	
	//function fetchCompleteHierarchyDetailsByECode(){
	//$.ajax({
	//url: "/AdminModule/fetchCompleteHierarchyDetailsByECode",
	//type: 'POST',
	////async:false,
	////dataType: 'JSON',
	//data:"e_code="+$('#dbName option:selected').val(),
	//success:function(data){
	//console.log(data);
	//$('#tableName').empty();
	//$.map(data,function(item){
	//$('#tableName').append('<option value="'+item+'">'+item+'</option>');
	//});
	//$('#dumpTypeDiv').removeClass('hidden');
	//}
	//});
	//}
	
	//google.charts.load('current', {packages:["orgchart"]});
	//google.charts.setOnLoadCallback(drawTree);
	
	/*function drawTree() {
		var data = new google.visualization.DataTable();
		data.addColumn('string', 'Name');
		data.addColumn('string', 'Manager');
		data.addColumn('string', 'ToolTip');
	
		// For each orgchart box, provide the name, manager, and tooltip to show.
		data.addRows([
			[{v:'Praveen', f:'Praveen<div style="color:red; font-style:italic">Manager</div>'}, '', 'AutoFinance'],
			[{v:'Gautam', f:'Gautam<div style="color:red; font-style:italic">Team Lead</div>'}, 'Praveen', 'Android'],
			['Vishu', 'Praveen', 'Server'],
			['Salil', 'Praveen', 'Business'],
			['RSO', 'Praveen', 'Tester/Business'],
			['CP', 'Praveen', 'Server'],
			['Manish', 'CP', 'Server'],
			['Shailesh', 'CP', 'Server'],
			['Deepak', 'Gautam', 'Android/iPhone'],
			['Roshan', 'Deepak', 'Android'],
			['Ankit', 'Deepak', 'Android'],
			['Yashwant', 'Gautam', 'Android'],
			['Nandan', 'RSO', 'Tester'],
			['Kapil', 'Salil', 'Business'],
			['Rahul', 'Praveen', 'DBA'],
			['Amit', 'Praveen', 'Designer'],
			['Rukhsar', 'Amit', 'Designer'],
			['Nishant', 'Praveen', 'Tester/Business']
			]);
	
		// Create the chart.
		var chart = new google.visualization.OrgChart(document.getElementById('tree_div'));
		// Draw the chart, setting the allowHtml option to true for the tooltips.
		chart.draw(data, {allowHtml:true});
	}
	//===================================================jQuery==================================================
	
	;(function($) {
		// Browser supports HTML5 multiple file?
		var multipleSupport = typeof $('<input/>')[0].multiple !== 'undefined',
		isIE = /msie/i.test( navigator.userAgent );
	
		$.fn.customFile = function() {
	
			return this.each(function() {
	
				var $file = $(this).addClass('custom-file-upload-hidden'), // the original file input
				$wrap = $('<div class="file-upload-wrapper">'),
				$input = $('<input type="text" class="file-upload-input" />'),
				// Button that will be used in non-IE browsers
				$button = $('<button type="button" class="file-upload-button">Browse</button>'),
				// Hack for IE
				$label = $('<label class="file-upload-button" for="'+ $file[0].id +'">Browse</label>');
	
				// Hide by shifting to the left so we
				// can still trigger events
				$file.css({
					position: 'absolute',
					left: '-9999px'
				});
	
				$wrap.insertAfter( $file )
				.append( $file, $input, ( isIE ? $label : $button ) );
	
				// Prevent focus
				$file.attr('tabIndex', -1);
				$button.attr('tabIndex', -1);
	
				$button.click(function () {
					$file.focus().click(); // Open dialog
				});
	
				$file.change(function() {
	
					var files = [], fileArr, filename;
	
					// If multiple is supported then extract
					// all filenames from the file array
					if ( multipleSupport ) {
						fileArr = $file[0].files;
						for ( var i = 0, len = fileArr.length; i < len; i++ ) {
							files.push( fileArr[i].name );
						}
						filename = files.join(', ');
	
						// If not supported then just take the value
						// and remove the path to just show the filename
					} else {
						filename = $file.val().split('\\').pop();
					}
	
					$input.val( filename ) // Set the value
					.attr('title', filename) // Show filename in title tootlip
					.focus(); // Regain focus
	
				});
	
				$input.on({
					blur: function() { $file.trigger('blur'); },
					keydown: function( e ) {
						if ( e.which === 13 ) { // Enter
							if ( !isIE ) { $file.trigger('click'); }
						} else if ( e.which === 8 || e.which === 46 ) { // Backspace & Del
							// On some browsers the value is read-only
							// with this trick we remove the old input and add
							// a clean clone with all the original events attached
							$file.replaceWith( $file = $file.clone( true ) );
							$file.trigger('change');
							$input.val('');
						} else if ( e.which === 9 ){ // TAB
							return;
						} else { // All other keys
							return false;
						}
					}
				});
	
			});
	
		};
	
		// Old browser fallback
		if ( !multipleSupport ) {
			$( document ).on('change', 'input.customfile', function() {
	
				var $this = $(this),
				// Create a unique ID so we
				// can attach the label to the input
				uniqId = 'customfile_'+ (new Date()).getTime(),
				$wrap = $this.parent(),
	
				// Filter empty input
				$inputs = $wrap.siblings().find('.file-upload-input')
				.filter(function(){ return !this.value }),
	
				$file = $('<input type="file" id="'+ uniqId +'" name="'+ $this.attr('name') +'"/>');
	
				// 1ms timeout so it runs after all other events
				// that modify the value have triggered
				setTimeout(function() {
					// Add a new input
					if ( $this.val() ) {
						// Check for empty fields to prevent
						// creating new inputs when changing files
						if ( !$inputs.length ) {
							$wrap.after( $file );
							$file.customFile();
						}
						// Remove and reorganize inputs
					} else {
						$inputs.parent().remove();
						// Move the input so it's always last on the list
						$wrap.appendTo( $wrap.parent() );
						$wrap.find('input').focus();
					}
				}, 1);
	
			});
		}
	
	}(jQuery));*/
	//$('input[type=file]').customFile();

	
	
			
			/*var parameter = 'ecode='+ecode;
			var response = makeAjaxCall('fetcheLearningStatus',parameter);
			if(response!=null && response!=""){
				alert("response"+JSON.stringfy(response));
			}*/
		 
	  
	  function getElearningCandidateReport()
	  {
		  $('#viewResult').html('');
		  $('#viewResult').hide();
		  var ecode = $.trim($('#eLearningCertificateEcode').val());
			var moduleId = $('#eLearningCertificateModule').val();
			var moduleValue = $("#eLearningCertificateModule option:selected").text();
		
			if(ecode !='')
			{
				$.ajax({
					url: "/AdminModule/fetchUserInformation",
					type: 'POST',
					//async:false,
					//dataType: 'JSON',
					data:{
						e_code:$('#eLearningCertificateEcode').val(),
						_csrf:$('#csrfToken').val()
						
					},
					success:function(response){
						if(response == null || response == ""){
							  modalAlertToShowCustomMessage('user does not exist', 'warning');
							  $('#myPager').unbind('page');
							  $('#myPager').hide();
						}

			
						
				
					else if( moduleId != '' && moduleValue!= '' && moduleValue != 'Select Module')
						  {
				  $.ajax({
					url: "/AdminModule/fetcheLearningStatus",
					type: 'POST',
					async:false,
					data:{
						  "ecode":ecode,
						 "moduleId":moduleId,
						 "startlimit":0,
						 "endlimit":10
					},
					success:function(response) {
						
						if(response == null || response == ""){
							  modalAlertToShowCustomMessage('Test is not attempted.', 'warning');
							  $('#myPager').unbind('page');
							  $('#myPager').hide();
							} else {
								var html="";
								$('#myPager').unbind('page');
								$('#myPager').show();
								$.each(response,function(index,item){
//									if($('#totalCounts').val() == undefined || $('#totalCounts').val() == '')
									$('#totalCounts').val(item.totalCounts);
									html+=' <div class="line"><div class="col-lg-2 col-sm-3"><div class="match-records-label">Module Name</div>';
									html+='<div class="match-records-result">'+item.modulename+'</div></div><div class="col-lg-2 col-sm-3">';
									if(item.visited==true && item.attemted==false)
									{
									html+='<div class="match-records-label">Status</div><div class="match-records-result">View</div></div>';
									}
									else
									{
										html+='<div class="match-records-label">Status</div><div class="match-records-result">Attempt</div></div>';
									}
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Date / Time</div><div class="match-records-result">'+item.createdOn+'</div></div>';
									if(item.score==null)
									{
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Score</div><div class="match-records-result">--</div></div>';
									}
									else
									{
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Score</div><div class="match-records-result">'+item.score+'/'+item.maxMarks+'</div></div>';
									}
									if(item.result=='Pass'){
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Result</div><div class="match-records-result green">'+item.result+'</div></div>';
									}
									else if(item.result=='Fail'){
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Result</div><div class="match-records-result red">'+item.result+'</div></div>';
									}
									else
									{
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Result</div><div class="match-records-result black">--</div></div>';
									}
									if(item.visited==true && item.attemted==false)
									{
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Certification</div><div class="match-records-result">--</div></div></div>';
									}
									else
									{
									html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Certification</div><div class="match-records-result"><a href="'+item.certificate_url+'" target="_blank"> '+item.certificate_url+' </a></div></div></div>';
									}
							});
								$('#viewResult').html(html);
								$('#viewResult').show();
								$('#myPager').bootpag({
									total:(parseInt(Math.ceil($('#totalCounts').val()/10))),
									page:1,
									maxVisible: 10,
									
								}).on("page", function(event, num){
									fetchElearningStatusPageWise(ecode,(num-1)*10,10,moduleId);
								});
							}
			          
						}
					
				});
				
			}
				
			else
			{
				modalAlertToShowCustomMessage('Invalid E_code or Module_id.', 'warning');
				$('#myPager').unbind('page');
				$('#myPager').hide();
			}
					
					}
					});			
		
	}				
			else
				{
				modalAlertToShowCustomMessage('Ecode cant not be blank', 'warning');
				}
			
	  }
	  
	function fetchElearningStatusPageWise(ecode,startLimit,endLimit,moduleId){
		$.ajax({
			url: "/AdminModule/fetcheLearningStatus",
			type: 'POST',
			async:false,
			data:{
				  "ecode":ecode,
				 "moduleId":moduleId,
				 "startlimit":startLimit,
				 "endlimit":endLimit
			},
			success:function(response) {
				
				if(response == null || response == ""){
					  modalAlertToShowCustomMessage('No user found. Please try again.', 'warning');
					  $('#myPager').unbind('page');
					  $('#myPager').hide();
					} else {
						var html="";
						
						$.each(response,function(index,item){
							html+=' <div class="line"><div class="col-lg-2 col-sm-3"><div class="match-records-label">Module Name</div>';
							html+='<div class="match-records-result">'+item.modulename+'</div></div><div class="col-lg-2 col-sm-3">';
							if(item.visited==true && item.attemted==false)
							{
							html+='<div class="match-records-label">Status</div><div class="match-records-result">View</div></div>';
							}
							else
							{
							html+='<div class="match-records-label">Status</div><div class="match-records-result">Attempt</div></div>';
							}
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Date / Time</div><div class="match-records-result">'+item.createdOn+'</div></div>';
							if(item.score==null)
							{
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Score</div><div class="match-records-result">--</div></div>';
							}
							else
							{
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Score</div><div class="match-records-result">'+item.score+'/'+item.maxMarks+'</div></div>';
							}
							if(item.result=='Pass'){
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Result</div><div class="match-records-result green">'+item.result+'</div></div>';
							}
							else if(item.result=='Fail'){
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Result</div><div class="match-records-result red">'+item.result+'</div></div>';
							}
							else{
								html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Result</div><div class="match-records-result black">--</div></div>';
							}
							if(item.visited==true && item.attemted==false)
							{
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Certification</div><div class="match-records-result">--</div></div></div>';
							}
							else
							{
							html+='<div class="col-lg-2 col-sm-3"><div class="match-records-label">Certification</div><div class="match-records-result"><a href="'+item.certificate_url+'" target="_blank">'+item.certificate_url+'</a></div></div></div>';
							}
						});
						$('#viewResult').html(html);
						$('#viewResult').show();
					}
	          
				}
			
		});
	}
	  
	function renderMomTemplate(){
		var columnsData = $('#produc-div .product-sec');
		if(undefined != columnsData){
			var headerNames =[];
			var columns=[];
			var readOnly=false;
			var allowUpdates=false;
			$.map(columnsData,function(item){
				if(undefined != item){
					var colName =$(item).find('.colName').val();
					var colType	 =$(item).find('.divselector option:selected').val();
					var columnName='text';
					if(colType == 2)
						columnName='dropdown';
					else if(colType == 3)
						columnName='checkbox';
					else if(colType == 4)
						columnName='calendar';
					else if(colType == 5)
						columnName='autocomplete';
					headerNames.push(colName);
					var ob={};
					if(colType == 2 || colType == 5){
						var source=[];
						var options = $(item).find('.tagings .addedTag');
						if(undefined != options){
							var i=0;
							$.map(options,function(option){
								var val=$(option).find('input[type="hidden"]').val();
								var dummy={'id':i+1,'name':val};
								source.push(dummy);
								i++;
							});
							
						}
						ob={ type: columnName,source:source,readOnly:readOnly};
					}
					else{
						ob={ type: columnName,readOnly:readOnly}
					}
					
					columns.push(ob);
					
				}
			});
			$('#my').jexcel({
			    colHeaders:  headerNames,
			    columns: columns,
			    minSpareRows:1,
			    allowInsertRow:allowUpdates,
			    editable:allowUpdates,allowInsertColumn:allowUpdates,allowDeleteRow:allowUpdates
			});
			$('#tableError').hide();
			$('.mom-table').show();
		}
<<<<<<< Updated upstream
	}

	function AESFileBlReportingEncryption(key, salt, iv, file, fileReaderObj, boundary, formDataName, date){
=======
		}
			function AESFileBlReportingEncryption(key, salt, iv, file, fileReaderObj, boundary, formDataName, date){
>>>>>>> Stashed changes
		
		var key128Bits100Iterations = CryptoJS.PBKDF2(key, salt, { keySize: 128/32, iterations: 100 });
		console.log( 'key128Bits100Iterations '+ key128Bits100Iterations);
		var encryptedData = CryptoJS.AES.encrypt(fileReaderObj.result.match(/,(.*)$/)[1], key128Bits100Iterations, { iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7 });

		// Store our body request in a string.
		var data = "";
	
		// Start a new part in our body's request
		data += "--" + boundary + "\r\n";
	
		// Describe it as form data
		data += 'content-disposition: form-data; '
			// Define the name of the form data
			+ 'name="' + formDataName + '"; '
			// Provide the real name of the file
			+ 'filename="'     + file.name + '"\r\n';
		// And the MIME type of the file
		data += 'Content-Type: ' + file.type + '\r\n';
	
		// There's a blank line between the metadata and the data
		data += '\r\n';
	
		// Append the binary data to our body's request
		data += encryptedData + '\r\n\n';
	
		// Once we are done, "close" the body's request
		//data += "--" + boundary + "--";
		
		
		// Start a new Date part in our body's request
		data += "--" + boundary + "\r\n";
		// Describe it as form data
		data += 'Content-Disposition: form-data; '
			// Define the name of the form data
			+ 'name="\date\"'+ '\r\n\n'
			data += date+ '\r\n';
		data += "--" + boundary + "--";
	
		return data;
	}
	
	function submitBlDailyImport(formParentDivID) {
		
		if($("#file-2")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You are uploading BL Daily Reporting datasheet.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
	    }).then(function(isConfirm) {
	        
	    	if (isConfirm) {   
			$('#wait').show();
	 
			var file = document.getElementById('file-2').files[0]
			var key = "vahangyan";
			// Uses different reader for all files
			var reader = new FileReader();
	
			reader.onload = function() {
				
				var salt = CryptoJS.lib.WordArray.random(128/8);
				var iv = CryptoJS.lib.WordArray.random(128/8);
				var boundary = "blob";
				var date = $("#ip-de-2").val();
				date = date.replace(/\ /g, '-');
				
				//alert('date:: '+date);
				//var data = AESFileBlReportingEncryption(key, salt, iv, file, reader, boundary, "blDailyFile", date);
				
				var formData = new FormData(); 
				formData.append("blDailyFile", file); 
				formData.append("date", date);
				
				$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
				$.ajax({
					//headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
					headers: {'Content-Type': undefined},
					url: "/AdminModule/blDailyUpload",
					type: 'POST',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					data:formData,
					success:function(response){
						$('#wait').hide();
						resetForm('submitBlDailyImport');
						if(response == null || response == ""){
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel2").html('Upload file - Daily Report (.xlsx)');
							modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
						}
						else if(response.indexOf('SUCCESS') != -1)
						{
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel2").html('Upload file - Daily Report (.xlsx)');
							modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
						}
						else if(response.indexOf('FAILURE') != -1)
						{
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel2").html('Upload file - Daily Report (.xlsx)');
							modalAlertToShowCustomMessage('Oops Some error occurred. Please do not enter blank excel file', 'warning');
						}
						else{
							var download = document.getElementById('pdd-error-excel-download-link');
							var arrayData= response.split("~");
							download.setAttribute('href', arrayData[3]);
							download.setAttribute('download', 'LogFile.xlsx');
							$('#submitPDDImportBtn').hide();
							$( "#pdd-excel-download-link" ).show();
							$("#fileLabel2").html('Upload file - Daily Report (.xlsx)');
							modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
									'. Please go through download link for more detail.', 'warning');
	
						}
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
	
					}
				});
			}
	
			reader.readAsDataURL(file);
	    	}
	    }
	    );
	}
	
	function submitBlTargetImport(formParentDivID) {
		
		if($("#file-1")[0].files.length < 1){
			modalAlertToShowCustomMessage("Please upload excel file", 'warning');
			return false;
		}
		
		swal({
	        title: "Are you sure?",
	        text: "You are uploading BL Target Reporting datasheet.",
	        type: "warning",
	        showCancelButton: true,
	        confirmButtonColor: '#DD6B55',
	        confirmButtonText: 'Yes, I am sure!',
	        cancelButtonText: "No, cancel it!",
	        closeOnConfirm: true,
	        closeOnCancel: false
	    }).then(function(isConfirm) {
	        
	    	if (isConfirm) {   
			$('#wait').show();
	 
			var file = document.getElementById('file-1').files[0]
			var key = "vahangyan";
			// Uses different reader for all files
			var reader = new FileReader();
			reader.onload = function() {
				
				var salt = CryptoJS.lib.WordArray.random(128/8);
				var iv = CryptoJS.lib.WordArray.random(128/8);
				var boundary = "blob";
				var date = $("#ip-de-1").val();
				date = date.replace(/\ /g, '-');
				
				//alert('date:: '+date);
				//var data = AESFileBlReportingEncryption(key, salt, iv, file, reader, boundary, "blTargetFile", date);
				
				var formData = new FormData(); 
				formData.append("blTargetFile", file); 
				formData.append("date", date);
				
				$.ajaxSetup({ headers: { 'X-CSRF-TOKEN':$('#csrfToken').val() } });
				$.ajax({
					//headers: {'Content-Type': 'multipart/form-data; boundary=' + boundary, 'saltKey': salt, 'ivKey': iv},
					headers: {'Content-Type': undefined},

					url: "/AdminModule/blTargetUpload",
					type: 'POST',
					processData: false,  // tell jQuery not to process the data
					contentType: false,  // tell jQuery not to process the data
					data:formData,
					success:function(response){
						$('#wait').hide();
						resetForm('submitBlTargetImport');
						if(response == null || response == ""){
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel1").html('Upload file - Target Report (.xlsx)');
							modalAlertToShowCustomMessage('Oops some error occurred. Please upload valid excel file. Use sample file for reference', 'warning');
						}
						else if(response.indexOf('SUCCESS') != -1)
						{
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel1").html('Upload file - Target Report (.xlsx)');
							modalAlertToShowCustomMessage('Excel file has been processed successfully', 'success');
						}
						else if(response.indexOf('FAILURE') != -1)
						{
							$( "#pdd-excel-download-link" ).hide();
							$("#fileLabel1").html('Upload file - Target Report (.xlsx)');
							modalAlertToShowCustomMessage('Oops Some error occurred. Please do not enter blank excel file', 'warning');
						}
						else{
							var download = document.getElementById('pdd-error-excel-download-link');
							var arrayData= response.split("~");
							download.setAttribute('href', arrayData[3]);
							download.setAttribute('download', 'LogFile.xlsx');
							$('#submitPDDImportBtn').hide();
							$( "#pdd-excel-download-link" ).show();
							$("#fileLabel1").html('Upload file - Target Report (.xlsx)');
							modalAlertToShowCustomMessage('Total Records: '+arrayData[1]+', Records processed successfully: '+arrayData[2]+
									'. Please go through download link for more detail.', 'warning');
	
						}
					}, 
					error: function(jqXHR, textStatus, errorThrown) {
						console.log('jqXHR:');
						console.log(jqXHR);
						console.log('textStatus:');
						console.log(textStatus);
						console.log('errorThrown:');
						console.log(errorThrown);
	
					}
				});
			}
			reader.readAsDataURL(file);
	    	}
	    }
	    );
	}
	
	function resetReportingForm(formId,fileLabel,type) {
		$('#' + formId).resetForm();
		$("#"+fileLabel).html("");
		$("#"+fileLabel).html("Upload file - "+type+" Report (.xlsx)");
		$("#pdd-excel-download-link").hide();
	}
	
	function setReportingFileLabel(fileId,fileLabel,aId,divId,submitButtonId){
		var fileName= $("#"+fileId).val().replace(/.*[\/\\]/, '');
		$("#"+fileLabel).html(fileName);
		$(submitButtonId).show();
		var download = document.getElementById(aId);
		if(undefined != download && download.length > 0){
			download.setAttribute('href', '#');
			$( divId ).hide();	
		}
	}

